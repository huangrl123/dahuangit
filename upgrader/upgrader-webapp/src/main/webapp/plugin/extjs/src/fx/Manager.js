Ext.define("Ext.fx.Manager",{singleton:true,requires:["Ext.util.MixedCollection","Ext.util.TaskRunner","Ext.fx.target.Element","Ext.fx.target.ElementCSS","Ext.fx.target.CompositeElement","Ext.fx.target.CompositeElementCSS","Ext.fx.target.Sprite","Ext.fx.target.CompositeSprite","Ext.fx.target.Component"],mixins:{queue:"Ext.fx.Queue"},constructor:function(){var A=this;A.items=new Ext.util.MixedCollection();A.targetArr={};A.mixins.queue.constructor.call(A);A.taskRunner=new Ext.util.TaskRunner()},interval:16,forceJS:true,createTarget:function(D){var B=this,A=!B.forceJS&&Ext.supports.Transitions,C;B.useCSS3=A;if(D){if(D.tagName||Ext.isString(D)||D.isFly){D=Ext.get(D);C=new Ext.fx.target["Element"+(A?"CSS":"")](D)}else{if(D.dom){C=new Ext.fx.target["Element"+(A?"CSS":"")](D)}else{if(D.isComposite){C=new Ext.fx.target["CompositeElement"+(A?"CSS":"")](D)}else{if(D.isSprite){C=new Ext.fx.target.Sprite(D)}else{if(D.isCompositeSprite){C=new Ext.fx.target.CompositeSprite(D)}else{if(D.isComponent){C=new Ext.fx.target.Component(D)}else{if(D.isAnimTarget){return D}else{return null}}}}}}}B.targets.add(C);return C}else{return null}},addAnim:function(A){var B=this,C=B.items,D=B.task;C.add(A.id,A);if(!D&&C.length){D=B.task={run:B.runner,interval:B.interval,scope:B};B.taskRunner.start(D)}},removeAnim:function(A){var B=this,C=B.items,D=B.task;C.removeAtKey(A.id);if(D&&!C.length){B.taskRunner.stop(D);delete B.task}},runner:function(){var C=this,E=C.items.getRange(),A=0,D=E.length,B;C.targetArr={};C.timestamp=new Date();for(;A<D;A++){B=E[A];if(B.isReady()){C.startAnim(B)}}for(A=0;A<D;A++){B=E[A];if(B.isRunning()){C.runAnim(B)}else{if(!C.useCSS3){}}}C.applyPendingAttrs()},startAnim:function(A){A.start(this.timestamp)},runAnim:function(F,B){if(!F){return}var A=this,G=A.useCSS3&&F.target.type=="element",C=A.timestamp-F.startTime,D=(C>=F.duration),H,E;if(B){C=F.duration;D=true}H=this.collectTargetData(F,C,G,D);if(G){F.target.setAttr(H.anims[F.id].attributes,true);A.collectTargetData(F,F.duration,G,D);F.paused=true;H=F.target.target;if(F.target.isComposite){H=F.target.target.last()}E={};E[Ext.supports.CSS3TransitionEnd]=F.lastFrame;E.scope=F;E.single=true;H.on(E)}return H},jumpToEnd:function(A){var B=this.runAnim(A,true);this.applyAnimAttrs(B,B.anims[A.id])},collectTargetData:function(B,F,A,D){var C=B.target.getId(),E=this.targetArr[C];if(!E){E=this.targetArr[C]={id:C,el:B.target,anims:{}}}E.anims[B.id]={id:B.id,anim:B,elapsed:F,isLastFrame:D,attributes:[{duration:B.duration,easing:(A&&B.reverse)?B.easingFn.reverse().toCSS3():B.easing,attrs:B.runAnim(F)}]};return E},applyAnimAttrs:function(C,A){var B=A.anim;if(A.attributes&&B.isRunning()){C.el.setAttr(A.attributes,false,A.isLastFrame);if(A.isLastFrame){B.lastFrame()}}},applyPendingAttrs:function(){var B=this.targetArr,E,C,A,F,D;for(C in B){if(B.hasOwnProperty(C)){E=B[C];for(D in E.anims){if(E.anims.hasOwnProperty(D)){A=E.anims[D];F=A.anim;if(A.attributes&&F.isRunning()){E.el.setAttr(A.attributes,false,A.isLastFrame);if(A.isLastFrame){F.lastFrame()}}}}}}}});
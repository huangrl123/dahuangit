Ext.define("Ext.layout.container.Accordion",{extend:"Ext.layout.container.VBox",alias:"layout.accordion",type:"accordion",alternateClassName:"Ext.layout.AccordionLayout",targetCls:Ext.baseCSSPrefix+"accordion-layout-ct",itemCls:[Ext.baseCSSPrefix+"box-item",Ext.baseCSSPrefix+"accordion-item"],align:"stretch",enableSplitters:false,fill:true,titleCollapse:true,hideCollapseTool:false,collapseFirst:undefined,animate:true,activeOnTop:false,multi:false,panelCollapseMode:"header",defaultAnimatePolicy:{y:true,height:true},constructor:function(){var A=this;A.callParent(arguments);if(A.animate){A.animatePolicy={};A.animatePolicy[A.names.x]=true;A.animatePolicy[A.names.width]=true}else{A.animatePolicy=null}},beforeRenderItems:function(J){var H=this,C=J.length,B=H.owner,D=H.collapseFirst,A=Ext.isDefined(D),G=H.getExpanded(true)[0],I=H.multi,E,F;for(F=0;F<C;F++){E=J[F];if(!E.rendered){if(!I||E.collapsible!==false){E.collapsible=true}if(E.collapsible){if(A){E.collapseFirst=D}if(H.hideCollapseTool){E.hideCollapseTool=H.hideCollapseTool;E.titleCollapse=true}else{if(H.titleCollapse&&E.titleCollapse===undefined){E.titleCollapse=H.titleCollapse}}}E.hideHeader=E.width=null;E.title=E.title||"&#160;";E.addBodyCls(Ext.baseCSSPrefix+"accordion-body");if(!I){if(G){E.collapsed=G!==E}else{if(E.hasOwnProperty("collapsed")&&E.collapsed===false){G=E}else{E.collapsed=true}}B.mon(E,"show",H.onComponentShow,H)}E.headerOverCls=Ext.baseCSSPrefix+"accordion-hd-over"}}if(!H.processing&&!I){if(!G){if(C){J[0].collapsed=false}}else{if(H.activeOnTop){G.collapsed=false;H.configureItem(G);if(B.items.indexOf(G)>0){B.insert(0,G)}}}}},getItemsRenderTree:function(A){this.beforeRenderItems(A);return this.callParent(arguments)},renderItems:function(A,B){this.beforeRenderItems(A);this.callParent(arguments)},configureItem:function(A){this.callParent(arguments);A.ignoreHeaderBorderManagement=true;A.animCollapse=false;if(this.fill){A.flex=1}},beginLayout:function(A){this.callParent(arguments);this.updatePanelClasses(A)},updatePanelClasses:function(E){var G=E.visibleItems,F=G.length,A=true,B,C,D;for(B=0;B<F;B++){C=G[B];D=C.header;D.addCls(Ext.baseCSSPrefix+"accordion-hd");if(A){D.removeCls(Ext.baseCSSPrefix+"accordion-hd-sibling-expanded")}else{D.addCls(Ext.baseCSSPrefix+"accordion-hd-sibling-expanded")}if(B+1==F&&C.collapsed){D.addCls(Ext.baseCSSPrefix+"accordion-hd-last-collapsed")}else{D.removeCls(Ext.baseCSSPrefix+"accordion-hd-last-collapsed")}A=C.collapsed}},onBeforeComponentExpand:function(G){var D=this,F=D.owner,E=D.multi,B=!E&&!D.animate&&D.activeOnTop,A,C;if(!D.processing){D.processing=true;C=F.deferLayouts;F.deferLayouts=true;if(!E){A=D.getExpanded()[0];if(A&&A!==G){A.collapse()}}if(B){Ext.suspendLayouts();F.insert(0,G);Ext.resumeLayouts()}F.deferLayouts=C;D.processing=false}},onBeforeComponentCollapse:function(F){var C=this,E=C.owner,D,A,B;if(C.owner.items.getCount()===1){return false}if(!C.processing){C.processing=true;B=E.deferLayouts;E.deferLayouts=true;D=F.next()||F.prev();if(C.multi){A=C.getExpanded();if(A.length===1){D.expand()}}else{if(D){D.expand()}}E.deferLayouts=B;C.processing=false}},onComponentShow:function(A){this.onBeforeComponentExpand(A)},onAdd:function(B){var A=this;A.callParent(arguments);if(B.collapseMode==="placeholder"){B.collapseMode=A.panelCollapseMode}B.collapseDirection=B.headerPosition;if(A.layoutCount&&!A.multi&&A.owner.items.getCount()>1){A.processing=true;B.collapse();A.processing=false}},onRemove:function(A,B){var D=this,C;D.callParent(arguments);if(!D.owner.destroying&&!D.multi&&!A.collapsed){C=D.owner.items.first();if(C){C.expand()}}},getExpanded:function(A){var F=this.owner.items.items,E=F.length,B=0,D=[],G,C;for(;B<E;++B){C=F[B];if(!C.hidden){if(A){G=C.hasOwnProperty("collapsed")&&C.collapsed===false}else{G=!C.collapsed}if(G){D.push(C)}}}return D}});
Ext.define("Ext.layout.container.Table",{alias:["layout.table"],extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.TableLayout",type:"table",createsInnerCt:true,targetCls:Ext.baseCSSPrefix+"table-layout-ct",tableCls:Ext.baseCSSPrefix+"table-layout",cellCls:Ext.baseCSSPrefix+"table-layout-cell",tableAttrs:null,getItemSizePolicy:function(A){return this.autoSizePolicy},initInheritedState:function(B,A){A.inShrinkWrapTable=true},getLayoutItems:function(){var D=this,B=[],F=D.callParent(),C,E=F.length,A;for(A=0;A<E;A++){C=F[A];if(!C.hidden){B.push(C)}}return B},getHiddenItems:function(){var B=[],E=this.owner.items.items,D=E.length,A=0,C;for(;A<D;++A){C=E[A];if(C.rendered&&C.hidden){B.push(C)}}return B},renderChildren:function(){var L=this,O=L.getLayoutItems(),N=L.owner.getTargetEl().child("table",true).tBodies[0],A=N.rows,H=0,M=O.length,C=L.getHiddenItems(),P,I,E,B,K,D,J,G,F;P=L.calculateCells(O);for(;H<M;H++){I=P[H];E=I.rowIdx;B=I.cellIdx;K=O[H];D=A[E];if(!D){D=N.insertRow(E);if(L.trAttrs){D.set(L.trAttrs)}}G=J=Ext.get(D.cells[B]||D.insertCell(B));if(L.needsDivWrap()){G=J.first()||J.createChild({tag:"div",role:"presentation"});G.setWidth(null)}if(!K.rendered){L.renderItem(K,G,0)}else{if(!L.isValidParent(K,G,E,B,N)){L.moveItem(K,G,0)}}if(L.tdAttrs){J.set(L.tdAttrs)}if(K.tdAttrs){J.set(K.tdAttrs)}J.set({colSpan:K.colspan||1,rowSpan:K.rowspan||1,id:K.cellId||"",cls:L.cellCls+" "+(K.cellCls||"")});if(!P[H+1]||P[H+1].rowIdx!==E){B++;while(D.cells[B]){D.deleteCell(B)}}}E++;while(N.rows[E]){N.deleteRow(E)}for(H=0,M=C.length;H<M;++H){L.ensureInDocument(C[H].getEl())}},ensureInDocument:function(A){var B=A.dom.parentNode;while(B){if(B.tagName.toUpperCase()=="BODY"){return}B=B.parentNode}Ext.getDetachedBody().appendChild(A)},calculate:function(F){if(!F.hasDomProp("containerChildrenSizeDone")){this.done=false}else{var A=F.targetContext,G=F.widthModel.shrinkWrap,D=F.heightModel.shrinkWrap,C=D||G,E=C&&A.el.child("table",true),B=C&&A.getPaddingInfo();if(G){F.setContentWidth(E.offsetWidth+B.width,true)}if(D){F.setContentHeight(E.offsetHeight+B.height,true)}}},finalizeLayout:function(){if(this.needsDivWrap()){var C=this.getLayoutItems(),A,D=C.length,B;for(A=0;A<D;A++){B=C[A];Ext.fly(B.el.dom.parentNode).setWidth(B.getWidth())}}},calculateCells:function(B){var I=[],J=0,D=0,A=0,F=this.columns||Infinity,G=[],E=0,C,H=B.length,K;for(;E<H;E++){K=B[E];while(D>=F||G[D]>0){if(D>=F){D=0;A=0;J++;for(C=0;C<F;C++){if(G[C]>0){G[C]--}}}else{D++}}I.push({rowIdx:J,cellIdx:A});for(C=K.colspan||1;C;--C){G[D]=K.rowspan||1;++D}++A}return I},getRenderTree:function(){var K=this,N=K.getLayoutItems(),M,A=[],B=Ext.apply({tag:"table",role:"presentation",cls:K.tableCls,cellspacing:0,cellpadding:0,cn:{tag:"tbody",role:"presentation",cn:A}},K.tableAttrs),H=K.tdAttrs,J=K.needsDivWrap(),L,F=N.length,O,I,D,E,G,C;M=K.calculateCells(N);for(L=0;L<F;L++){O=N[L];I=M[L];E=I.rowIdx;G=I.cellIdx;D=A[E];if(!D){D=A[E]={tag:"tr",role:"presentation",cn:[]};if(K.trAttrs){Ext.apply(D,K.trAttrs)}}C=D.cn[G]={tag:"td",role:"presentation"};if(H){Ext.apply(C,H)}Ext.apply(C,{colSpan:O.colspan||1,rowSpan:O.rowspan||1,id:O.cellId||"",cls:K.cellCls+" "+(O.cellCls||"")});if(J){C=C.cn={tag:"div",role:"presentation"}}K.configureItem(O);C.cn=O.getRenderTree()}return B},isValidParent:function(D,F,G,B){var A,C,E;if(arguments.length===3){E=D.el.up("table");return E&&E.dom.parentNode===F.dom}A=this.owner.getTargetEl().child("table",true).tBodies[0];C=A.rows[G].cells[B];return D.el.dom.parentNode===C},needsDivWrap:function(){return Ext.isOpera10_5}});
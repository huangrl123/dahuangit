Ext.define("Ext.layout.container.Box",{extend:"Ext.layout.container.Container",alias:"layout.box",alternateClassName:"Ext.layout.BoxLayout",requires:["Ext.layout.container.boxOverflow.None","Ext.layout.container.boxOverflow.Menu","Ext.layout.container.boxOverflow.Scroller","Ext.util.Format","Ext.dd.DragDropManager"],type:"box",config:{align:"begin",constrainAlign:false,enableSplitters:true,overflowHandler:{$value:null,merge:function(B,A){if(typeof B=="string"){B={type:B}}return Ext.merge(A?Ext.Object.chain(A):{},B)}},padding:0,pack:"start",stretchMaxPartner:undefined,vertical:false,alignRoundingMethod:"round"},scrollOffset:0,itemCls:Ext.baseCSSPrefix+"box-item",targetCls:Ext.baseCSSPrefix+"box-layout-ct",targetElCls:Ext.baseCSSPrefix+"box-target",innerCls:Ext.baseCSSPrefix+"box-inner",availableSpaceOffset:0,reserveOffset:true,manageMargins:true,createsInnerCt:true,childEls:["innerCt","targetEl"],renderTpl:['{%var oc,l=values.$comp.layout,oh=l.overflowHandler;if (oh && oh.getPrefixConfig!==Ext.emptyFn) {if(oc=oh.getPrefixConfig())dh.generateMarkup(oc, out)}%}<div id="{ownerId}-innerCt" data-ref="innerCt" role="presentation" class="{[l.innerCls]}{[oh ? (" " + oh.getOverflowCls(l.direction)) : ""]}"><div id="{ownerId}-targetEl" data-ref="targetEl" class="{targetElCls}" role="presentation">{%this.renderBody(out, values)%}</div></div>{%if (oh && oh.getSuffixConfig!==Ext.emptyFn) {if(oc=oh.getSuffixConfig())dh.generateMarkup(oc, out)}%}',{disableFormats:true,definitions:"var dh=Ext.DomHelper;"}],constructor:function(B){var C=this,A;C.callParent(arguments);C.setVertical(C.vertical);C.flexSortFn=C.flexSort.bind(C);A=typeof C.padding;if(A==="string"||A==="number"){C.padding=Ext.util.Format.parseBox(C.padding);C.padding.height=C.padding.top+C.padding.bottom;C.padding.width=C.padding.left+C.padding.right}},_beginRe:/^(?:begin|left|top)$/,_centerRe:/^(?:center|middle)$/,_endRe:/^(?:end|right|bottom)$/,_percentageRe:/^\s*(\d+(?:\.\d*)?)\s*[%]\s*$/,getItemSizePolicy:function(O,F){var K=this,C=K.sizePolicy,G=K.align,M=O.flex,L=G,D=K.names,J=O[D.width],I=O[D.height],B=K._percentageRe,A=B.test(J),H=(G==="stretch"),E=(G==="stretchmax"),N=K.constrainAlign;if(!F&&(H||M||A||(N&&!E))){F=K.owner.getSizeModel()}if(H){if(!B.test(I)&&F[D.height].shrinkWrap){L="stretchmax"}}else{if(!E){if(B.test(I)){L="stretch"}else{if(N&&!F[D.height].shrinkWrap){L="stretchmax"}else{L=""}}}}if(M||A){if(!F[D.width].shrinkWrap){C=C.flex}}return C[L]},flexSort:function(N,K){var A=this.names.maxWidth,L=this.names.minWidth,H=Infinity,M=N.target,J=K.target,B=M.flex,E=J.flex,C=0,P,O,F,G,I,D;F=M[A]||H;G=J[A]||H;P=M[L]||0;O=J[L]||0;I=isFinite(P)||isFinite(O);D=isFinite(F)||isFinite(G);if(I||D){if(D){C=F-G}if(C===0&&I){C=O-P}if(C===0){if(D){C=E-B}else{C=B-E}}}return C},isItemBoxParent:function(A){return true},isItemShrinkWrap:function(A){return true},roundFlex:function(A){return Math.ceil(A)},beginCollapse:function(A){var B=this;if(B.direction==="vertical"&&A.collapsedVertical()){A.collapseMemento.capture(["flex"]);delete A.flex}else{if(B.direction==="horizontal"&&A.collapsedHorizontal()){A.collapseMemento.capture(["flex"]);delete A.flex}}},beginExpand:function(A){A.collapseMemento.restore(["flex"])},beginLayout:function(E){var C=this,G=C.owner,D=G.stretchMaxPartner,F=C.innerCt.dom.style,B=C.names,A=C.overflowHandler;E.boxNames=B;if(A){A.beginLayout(E)}if(typeof D==="string"){D=Ext.getCmp(D)||G.query(D)[0]}E.stretchMaxPartner=D&&E.context.getCmp(D);C.callParent(arguments);E.innerCtContext=E.getEl("innerCt",C);E.targetElContext=E.getEl("targetEl",C);C.scrollParallel=G.scrollFlags[B.x];C.scrollPerpendicular=G.scrollFlags[B.y];if(C.scrollParallel){C.scrollPos=G.getTargetEl().dom[B.scrollLeft]}F.width="";F.height=""},beginLayoutCycle:function(A,I){var G=this,F=G.align,B=A.boxNames,H=G.pack,C=G._centerRe,E=B.heightModel,D=G.overflowHandler;if(D){D.beginLayoutCycle(A,I)}G.callParent(arguments);A.parallelSizeModel=A[B.widthModel];A.perpendicularSizeModel=A[E];A.boxOptions={align:F={stretch:F==="stretch",stretchmax:F==="stretchmax",center:C.test(F),bottom:G._endRe.test(F)},pack:H={center:C.test(H),end:H==="end"}};if(F.stretch&&A.perpendicularSizeModel.shrinkWrap){F.stretchmax=true;F.stretch=false}F.nostretch=!(F.stretch||F.stretchmax);if(A.parallelSizeModel.shrinkWrap){H.center=H.end=false}G.cacheFlexes(A);G.targetEl.setWidth(20000)},cacheFlexes:function(G){var J=this,D=G.boxNames,E=D.widthModel,R=D.heightModel,L=G.boxOptions.align.nostretch,S=0,P=G.childItems,I=P.length,N=[],Q=0,O=D.minWidth,K=J._percentageRe,M=0,A=0,H,B,C,F;while(I--){B=P[I];H=B.target;if(B[E].calculated){B.flex=C=H.flex;if(C){S+=C;N.push(B);Q+=H[O]||0}else{F=K.exec(H[D.width]);B.percentageParallel=parseFloat(F[1])/100;++M}}if(L&&B[R].calculated){F=K.exec(H[D.height]);B.percentagePerpendicular=parseFloat(F[1])/100;++A}}G.flexedItems=N;G.flexedMinSize=Q;G.totalFlex=S;G.percentageWidths=M;G.percentageHeights=A;Ext.Array.sort(N,J.flexSortFn)},calculate:function(B){var A=this,G=A.getContainerSize(B),C=B.boxNames,F=B.state,H=F.boxPlan||(F.boxPlan={}),D=B.targetContext,E=A.overflowHandler;H.targetSize=G;if(!F.parallelDone){F.parallelDone=A.calculateParallel(B,C,H)}if(!F.perpendicularDone){F.perpendicularDone=A.calculatePerpendicular(B,C,H)}if(F.parallelDone&&F.perpendicularDone){A.publishInnerCtSize(B,A.reserveOffset?A.availableSpaceOffset:0);if(A.done&&B.boxOptions.align.stretchmax&&!F.stretchMaxDone){A.calculateStretchMax(B,C,H);F.stretchMaxDone=true}if(E){E.calculate(B)}}else{A.done=false}},calculateParallel:function(U,L,H){var K=this,N=L.width,T=U.childItems,F=L.beforeX,c=L.afterX,P=L.setWidth,Y=T.length,R=U.flexedItems,O=R.length,G=U.boxOptions.pack,S=K.padding,X=H.targetSize,d=X[N],e=0,a=S[F],D=a+S[c]+K.scrollOffset+(K.reserveOffset?K.availableSpaceOffset:0),V=Ext.getScrollbarSize()[L.width],J,C,A,b,B,E,I,W,M,Q,Z;if(!U.parallelSizeModel.shrinkWrap&&!X[L.gotWidth]){return false}if(V&&K.scrollPerpendicular&&U.parallelSizeModel.shrinkWrap&&!U.boxOptions.align.stretch&&!U.perpendicularSizeModel.shrinkWrap){if(!U.state.perpendicularDone){return false}M=true}for(J=0;J<Y;++J){B=T[J];C=B.marginInfo||B.getMarginInfo();e+=C[N];if(!B[L.widthModel].calculated){Q=B.getProp(N);D+=Q;if(isNaN(D)){return false}}}D+=e;if(U.percentageWidths){Z=d-e;if(isNaN(Z)){return false}for(J=0;J<Y;++J){B=T[J];if(B.percentageParallel){Q=Math.ceil(Z*B.percentageParallel);Q=B.setWidth(Q);D+=Q}}}if(U.parallelSizeModel.shrinkWrap){H.availableSpace=0;H.tooNarrow=false}else{H.availableSpace=d-D;H.tooNarrow=H.availableSpace<U.flexedMinSize;if(H.tooNarrow&&Ext.getScrollbarSize()[L.height]&&K.scrollParallel&&U.state.perpendicularDone){U.state.perpendicularDone=false;for(J=0;J<Y;++J){T[J].invalidate()}}}W=D;A=H.availableSpace;b=U.totalFlex;for(J=0;J<O;J++){B=R[J];E=B.flex;I=K.roundFlex((E/b)*A);I=B[P](I);W+=I;A=Math.max(0,A-I);b-=E}if(G.center){a+=A/2;if(a<0){a=0}}else{if(G.end){a+=A}}for(J=0;J<Y;++J){B=T[J];C=B.marginInfo;a+=C[F];B.setProp(L.x,a);a+=C[c]+B.props[N]}W+=U.targetContext.getPaddingInfo()[N];U.state.contentWidth=W;if(M&&(U.peek(L.contentHeight)>H.targetSize[L.height])){W+=V;U[L.hasOverflowY]=true;U.target.componentLayout[L.setWidthInDom]=true;U[L.invalidateScrollY]=Ext.isIE8}U[L.setContentWidth](W);return true},calculatePerpendicular:function(I,Z,A){var D=this,T=I.perpendicularSizeModel.shrinkWrap,b=A.targetSize,X=I.childItems,c=X.length,B=Math.max,F=Z.height,C=Z.setHeight,H=Z.beforeY,L=Z.y,E=D.padding,R=E[H],U=b[F]-R-E[Z.afterY],j=I.boxOptions.align,P=j.stretch,W=j.stretchmax,J=j.center,f=j.bottom,K=D.constrainAlign,e=0,Y=0,h=D.onBeforeConstrainInvalidateChild,Q=D.onAfterConstrainInvalidateChild,l=Ext.getScrollbarSize().height,V,g,m,S,a,N,G,k,d,O,M;if(P||((J||f)&&!T)){if(isNaN(U)){return false}}if(!P&&!I.parallelSizeModel.shrinkWrap&&!I.state.parallelDone&&D.scrollParallel){return false}if(D.scrollParallel&&A.tooNarrow){if(T){O=true}else{U-=l;A.targetSize[F]-=l}}if(P){N=U}else{for(g=0;g<c;g++){G=X[g];S=(G.marginInfo||G.getMarginInfo())[F];if(!(M=G.percentagePerpendicular)){m=G.getProp(F)}else{++Y;if(T){continue}else{m=M*U-S;m=G[Z.setHeight](m)}}if(!T&&K&&G[Z.heightModel].shrinkWrap&&m>U){G.invalidate({before:h,after:Q,layout:D,childHeight:U,names:Z});I.state.parallelDone=false}if(isNaN(e=B(e,m+S,G.target[Z.minHeight]||0))){return false}}if(O){e+=l;I[Z.hasOverflowX]=true;I.target.componentLayout[Z.setHeightInDom]=true;I[Z.invalidateScrollX]=Ext.isIE8}k=I.stretchMaxPartner;if(k){I.setProp("maxChildHeight",e);d=k.childItems;if(d&&d.length){e=B(e,k.getProp("maxChildHeight"));if(isNaN(e)){return false}}}I[Z.setContentHeight](e+D.padding[F]+I.targetContext.getPaddingInfo()[F]);if(O){e-=l}A.maxSize=e;if(W){N=e}else{if(J||f||Y){if(K){N=T?e:U}else{N=T?e:B(U,e)}N-=I.innerCtContext.getBorderInfo()[F]}}}for(g=0;g<c;g++){G=X[g];S=G.marginInfo||G.getMarginInfo();V=R+S[H];if(P){G[C](N-S[F])}else{M=G.percentagePerpendicular;if(T&&M){S=G.marginInfo||G.getMarginInfo();m=M*N-S[F];m=G.setHeight(m)}if(J){a=N-G.props[F];if(a>0){V=R+Math[D.alignRoundingMethod](a/2)}}else{if(f){V=B(0,N-V-G.props[F])}}}G.setProp(L,V)}return true},onBeforeConstrainInvalidateChild:function(A,C){var B=C.names.heightModel;if(!A[B].constrainedMin){A[B]=Ext.layout.SizeModel.calculated}},onAfterConstrainInvalidateChild:function(A,B){var C=B.names;A.setProp(C.beforeY,0);if(A[C.heightModel].calculated){A[C.setHeight](B.childHeight)}},calculateStretchMax:function(A,C,I){var M=this,J=C.height,E=C.width,D=A.childItems,G=D.length,B=I.maxSize,F=M.onBeforeStretchMaxInvalidateChild,L=M.onAfterStretchMaxInvalidateChild,N,O,K,H;for(K=0;K<G;++K){N=D[K];O=N.props;H=B-N.getMarginInfo()[J];if(H!==O[J]||N[C.heightModel].constrained){N.invalidate({before:F,after:L,layout:M,childWidth:O[E],childHeight:H,childX:O.x,childY:O.y,names:C})}}},onBeforeStretchMaxInvalidateChild:function(A,C){var B=C.names.heightModel;if(!A[B].constrainedMax){A[B]=Ext.layout.SizeModel.calculated}},onAfterStretchMaxInvalidateChild:function(C,D){var E=D.names,A=D.childHeight,B=D.childWidth;C.setProp("x",D.childX);C.setProp("y",D.childY);if(C[E.heightModel].calculated){C[E.setHeight](A)}if(C[E.widthModel].calculated){C[E.setWidth](B)}},completeLayout:function(A){var I=this,C=A.boxNames,G=A.invalidateScrollX,H=A.invalidateScrollY,E=I.overflowHandler,D,F,K,J,B;if(E){E.completeLayout(A)}if(G||H){F=I.getTarget();D=F.dom;B=D.style;if(G){K=F.getStyle("overflowX");if(K==="auto"){K=B.overflowX;B.overflowX="scroll"}else{G=false}}if(H){J=F.getStyle("overflowY");if(J==="auto"){J=B.overflowY;B.overflowY="scroll"}else{H=false}}if(G||H){D.scrollWidth;if(G){B.overflowX=K}if(H){B.overflowY=J}}}if(I.scrollParallel){I.owner.getTargetEl().dom[C.scrollLeft]=I.scrollPos}},finishedLayout:function(B){var A=this.overflowHandler;if(A){A.finishedLayout(B)}this.callParent(arguments)},getLayoutItems:function(){var G=this.callParent(),E=G.length,F,C,D,I,B,H,A;for(D=0;D<E;++D){if((I=G[D]).isSplitter){continue}A=I.splitter;if(I.hidden){if(A){if(!A.hidden){A.hidden=true;if(A.el){A.el.hide()}}}continue}if(A){H=A.collapseTarget==="next"}else{H=false}C=null;if(F&&B){if(B.hidden){B.hidden=false;if(B.el){B.el.show()}}if(H){C=true}}else{if(H){C=!F}}if(C!==null&&A.hidden!==C){A.hidden=C;if(A.el){A.el.setVisible(!C)}}B=!H&&A;F=I}if(F&&B&&!B.hidden){B.hidden=true;if(B.el){B.el.hide()}}return G},getScrollerEl:function(){return this.innerCt},insertSplitter:function(B,D,F,A){var C={xtype:"splitter",id:B.id+"-splitter",hidden:F,splitterFor:B,synthetic:true},E=D+((A.collapseTarget==="prev")?1:0);C[this.names.height]="100%";if(A){Ext.apply(C,A)}B.splitter=this.owner.add(E,C)},publishInnerCtSize:function(A,H){var J=this,C=A.boxNames,I=C.height,E=C.width,G=A.boxOptions.align,L=J.owner.dock,B=J.padding,K=A.state.boxPlan,M=K.targetSize,O=M[I],F=A.innerCtContext,D=(A.parallelSizeModel.shrinkWrap||(K.tooNarrow&&J.scrollParallel)?A.state.contentWidth-A.targetContext.getPaddingInfo()[E]:M[E])-(H||0),N;J.owner.tooNarrow=K.tooNarrow;if(G.stretch){N=O}else{N=K.maxSize+B[C.beforeY]+B[C.afterY]+F.getBorderInfo()[I];if(!A.perpendicularSizeModel.shrinkWrap&&(G.center||G.bottom)){N=Math.max(O,N)}}F[C.setWidth](D);F[C.setHeight](N);A.targetElContext.setWidth(A.innerCtContext.props.width-(this.vertical?0:(H||0)));if(isNaN(D+N)){J.done=false}if(K.calculatedWidth&&(L==="left"||L==="right")){A.setWidth(K.calculatedWidth,true,true)}},onAdd:function(B,C){var A=this,D=A.enableSplitters&&B.split&&!B.isButton;A.callParent(arguments);if(D){if(D===true){D={collapseTarget:"next"}}else{if(Ext.isString(D)){D={collapseTarget:D==="before"?"next":"prev"}}else{D=Ext.apply({collapseTarget:D.side==="before"?"next":"prev"},D)}}A.insertSplitter(B,C,!!B.hidden,D)}},onRemove:function(G,A){var H=this,C=H.names,B=H.owner,F=G.splitter,D=H.overflowHandler,E;H.callParent(arguments);if(F&&B.contains(F)){B.doRemove(F,true);G.splitter=null}if(D){D.onRemove(G)}if(G.layoutMarginCap===H.id){delete G.layoutMarginCap}if(!B.destroying&&!A&&G.rendered){E=G.getEl();if(E){E.setStyle(C.beforeY,"");E.setStyle(C.beforeX,"");E.setStyle("margin","")}}},applyOverflowHandler:function(B,C){var A;if(typeof B==="string"){B={type:B}}A=B.type;if(C&&C.type===B.type){delete B.type;C.setConfig(B);return C}B.layout=this;return Ext.Factory.boxOverflow(B)},getRenderTarget:function(){return this.targetEl},getElementTarget:function(){return this.innerCt},calculateChildBox:Ext.deprecated(),calculateChildBoxes:Ext.deprecated(),updateChildBoxes:Ext.deprecated(),destroy:function(){var A=this;Ext.destroy(A.innerCt,A.overflowHandler);A.flexSortFn=A.innerCt=null;A.callParent(arguments)},getRenderData:function(){var A=this.callParent();A.targetElCls=this.targetElCls;return A},updateVertical:function(C){var A=(C&&"vbox")||"hbox",B=this.overflowHandler,D=this.owner;Ext.apply(this,this._props[A]);if(B&&D&&D.rendered){B.setVertical(C)}},_props:{"hbox":{direction:"horizontal",oppositeDirection:"vertical",horizontal:true,vertical:false,names:{beforeX:"left",beforeScrollX:"left",leftCap:"Left",afterX:"right",width:"width",contentWidth:"contentWidth",minWidth:"minWidth",maxWidth:"maxWidth",widthCap:"Width",widthModel:"widthModel",widthIndex:0,x:"x",scrollLeft:"scrollLeft",overflowX:"overflowX",hasOverflowX:"hasOverflowX",invalidateScrollX:"invalidateScrollX",parallelMargins:"lr",center:"middle",beforeY:"top",afterY:"bottom",height:"height",contentHeight:"contentHeight",minHeight:"minHeight",maxHeight:"maxHeight",heightCap:"Height",heightModel:"heightModel",heightIndex:1,y:"y",overflowY:"overflowY",hasOverflowY:"hasOverflowY",invalidateScrollY:"invalidateScrollY",perpendicularMargins:"tb",getWidth:"getWidth",getHeight:"getHeight",setWidth:"setWidth",setHeight:"setHeight",gotWidth:"gotWidth",gotHeight:"gotHeight",setContentWidth:"setContentWidth",setContentHeight:"setContentHeight",setWidthInDom:"setWidthInDom",setHeightInDom:"setHeightInDom",getScrollLeft:"getScrollLeft",setScrollLeft:"setScrollLeft",scrollTo:"scrollTo"},sizePolicy:{flex:{"":{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},stretch:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1},stretchmax:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:1}},"":{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},stretch:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},stretchmax:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:1}}},"vbox":{direction:"vertical",oppositeDirection:"horizontal",horizontal:false,vertical:true,names:{beforeX:"top",beforeScrollX:"top",leftCap:"Top",afterX:"bottom",width:"height",contentWidth:"contentHeight",minWidth:"minHeight",maxWidth:"maxHeight",widthCap:"Height",widthModel:"heightModel",widthIndex:1,x:"y",scrollLeft:"scrollTop",overflowX:"overflowY",hasOverflowX:"hasOverflowY",invalidateScrollX:"invalidateScrollY",parallelMargins:"tb",center:"center",beforeY:"left",afterY:"right",height:"width",contentHeight:"contentWidth",minHeight:"minWidth",maxHeight:"maxWidth",heightCap:"Width",heightModel:"widthModel",heightIndex:0,y:"x",overflowY:"overflowX",hasOverflowY:"hasOverflowX",invalidateScrollY:"invalidateScrollX",perpendicularMargins:"lr",getWidth:"getHeight",getHeight:"getWidth",setWidth:"setHeight",setHeight:"setWidth",gotWidth:"gotHeight",gotHeight:"gotWidth",setContentWidth:"setContentHeight",setContentHeight:"setContentWidth",setWidthInDom:"setHeightInDom",setHeightInDom:"setWidthInDom",getScrollLeft:"getScrollTop",setScrollLeft:"setScrollTop",scrollTo:"scrollTo"},sizePolicy:{flex:{"":{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},stretch:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1},stretchmax:{readsWidth:1,readsHeight:0,setsWidth:1,setsHeight:1}},"":{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},stretch:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},stretchmax:{readsWidth:1,readsHeight:1,setsWidth:1,setsHeight:0}}}}});
Ext.define("Ext.dashboard.DropZone",{extend:"Ext.dd.DropTarget",ddScrollConfig:{vthresh:50,hthresh:-1,animate:true,increment:200},overClass:"x-dashboard-dd-over",constructor:function(A,B){this.dashboard=A;Ext.dd.ScrollManager.register(A.body);this.callParent([A.body,B]);A.body.ddScrollConfig=this.ddScrollConfig},getOverEvent:function(S,L,P){var J=this.dashboard,O=J.items.items,A=J.body.getBox(),E=O.length,D=L.getXY(),Q=D[0]-A.x,R=D[1]-A.y,H={columnIndex:0,column:O[0],dashboard:J,above:null,extensible:((O.length+1)/2<(J.maxColumns||1)),beforeAfter:0,data:P,panel:P.panel,rawEvent:L,source:S,status:this.dropAllowed},C,T,G,F,B,I,K,M,N;if(Q<0&&H.extensible){H.beforeAfter=-1}else{if(Q>A.width){H.beforeAfter=H.extensible?1:0;H.columnIndex=E-1}else{for(G=0;G<E;G+=2){B=O[G];I=B.lastBox.width;if(O[G+1]){I+=O[G+1].lastBox.width}if(Q<I){H.columnIndex=G;H.column=B;M=B.items.items;C=Math.min(80,I*0.2);H.beforeAfter=C=(H.extensible&&((Q<C)?-1:((Q>I-C)?1:0)));if(!C||!H.extensible){for(F=0,K=M.length;F<K;++F){N=M[F];T=N.el.getHeight();if(R<T/2){H.above=N;break}R-=T}}break}Q-=I}}}return H},notifyOver:function(C,D,E){var A=this,G=A.dashboard,J=A.getOverEvent(C,D,E),L=J.column.el,K=C.proxy,B,F=J.above,H,I;E.lastOver=J;if(G.fireEvent("validatedrop",J)!==false&&G.fireEvent("beforedragover",J)!==false){B=C.panelProxy.getProxy();K.getProxy().setWidth("auto");if(J.beforeAfter){C.panelProxy.moveProxy(L.dom,L.dom.firstChild);H=L.getWidth();I=H/2;B.setWidth(I)}else{if(F){C.panelProxy.moveProxy(F.el.dom.parentNode,F.el.dom)}else{C.panelProxy.moveProxy(L.dom,null)}B.setWidth("auto")}if(J.beforeAfter>0){B.setStyle("margin-left",(H-I-L.getPadding("lr"))+"px")}else{B.setStyle("margin-left","")}this.scrollPos=G.body.getScroll();G.fireEvent("dragover",J)}return J.status},notifyDrop:function(B,A,D){this.callParent(arguments);var H=this.dashboard,L=D.lastOver,M=L.panel,C=L.beforeAfter,J=M.ownerCt,E=L.column,F=J.items.indexOf(M),K=L.above?E.items.indexOf(L.above):E.items.getCount(),I,G;if(J===E){if(J.items.getCount()===1){return}if(!C){if(F<K){--K}if(F===K){return}}}if(H.fireEvent("validatedrop",L)===false||H.fireEvent("beforedrop",L)===false){return}Ext.suspendLayouts();M.isMoving=true;if(C){I=H.items.indexOf(E);if(C>0){++I}G=H.createColumn();G.columnWidth=E.columnWidth=E.columnWidth/2;E=H.insert(I,G);K=0}M.el.dom.style.display="";E.insert(K,M);if(J.items.getCount()===0){E.columnWidth+=J.columnWidth}M.isMoving=false;M.updateLayout();Ext.resumeLayouts(true);H.fireEvent("drop",L)},unreg:function(){Ext.dd.ScrollManager.unregister(this.dashboard.body);this.callParent()}});
Ext.define("Ext.view.DragZone",{extend:"Ext.dd.DragZone",containerScroll:false,constructor:function(C){var D=this,E,A,B;Ext.apply(D,C);if(!D.ddGroup){D.ddGroup="view-dd-zone-"+D.view.id}E=D.view;A=E.ownerCt;if(A){B=A.getTargetEl().dom}else{B=E.el.dom.parentNode}D.callParent([B]);D.ddel=Ext.get(document.createElement("div"));D.ddel.addCls(Ext.baseCSSPrefix+"grid-dd-wrap")},init:function(F,D,C){var A=this,E=Ext.supports.touchScroll?"itemlongpress":"itemmousedown",B={scope:A};B[E]=A.onItemMouseDown;A.initTarget(F,D,C);A.view.mon(A.view,B)},onValidDrop:function(B,A,C){this.callParent();B.el.focus()},onItemMouseDown:function(C,E,B,D,A){if(!this.isPreventDrag(A,E,B,D)){if(C.focusRow){C.focusRow(E)}this.handleMouseDown(A)}},isPreventDrag:function(A,C,B,D){return false},getDragData:function(A){var C=this.view,B=A.getTarget(C.getItemSelector());if(B){return{copy:C.copy||(C.allowCopy&&A.ctrlKey),event:A,view:C,ddel:this.ddel,item:B,records:C.getSelectionModel().getSelection(),fromPosition:Ext.fly(B).getXY()}}},onInitDrag:function(D,E){var C=this,G=C.dragData,F=G.view,B=F.getSelectionModel(),A=F.getRecord(G.item);if(!B.isSelected(A)){B.selectWithEvent(A,C.DDMInstance.mousedownEvent)}G.records=B.getSelection();C.ddel.setHtml(C.getDragText());C.proxy.update(C.ddel.dom);C.onStartDrag(D,E);return true},getDragText:function(){var A=this.dragData.records.length;return Ext.String.format(this.dragText,A,A===1?"":"s")},getRepairXY:function(A,B){return B?B.fromPosition:false}});
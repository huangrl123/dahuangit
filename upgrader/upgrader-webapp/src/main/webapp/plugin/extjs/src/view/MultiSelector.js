Ext.define("Ext.view.MultiSelector",{extend:"Ext.grid.Panel",xtype:"multiselector",config:{search:{xtype:"multiselector-search",width:200,height:200,store:{autoLoad:true}}},fieldName:"name",fieldTitle:null,removeRowText:"&#10006",removeRowTip:"Remove this item",emptyText:"Nothing selected",addToolText:"Search for items to add",initComponent:function(){var D=this,G=D.emptyText,A=D.getStore(),B=D.getSearch(),C=D.fieldTitle,F,E;if(!B){Ext.Error.raise("The search configuration is required for the multi selector")}F=B.store;if(F.isStore){E=F.getModel()}else{E=F.model}if(!A){D.store={model:E}}if(G&&!D.viewConfig){D.viewConfig={deferEmptyText:false,emptyText:G}}if(!D.columns){D.hideHeaders=!C;D.columns=[{text:C,dataIndex:D.fieldName,flex:1},D.makeRemoveRowColumn()]}D.callParent()},addTools:function(){this.addTool({type:"plus",tooltip:this.addToolText,callback:"onShowSearch",scope:this})},convertSearchRecord:Ext.identityFn,convertSelectionRecord:Ext.identityFn,makeRemoveRowColumn:function(){var A=this;return{width:22,menuDisabled:true,processEvent:A.processRowEvent.bind(A),renderer:A.renderRemoveRow,updater:Ext.emptyFn,scope:A}},processRowEvent:function(D,A,H,E,C,B,G,F){if(B.type!=="click"){return}if(Ext.fly(B.getTarget()).hasCls(Ext.baseCSSPrefix+"multiselector-remove")){this.store.remove(G);if(this.searchPopup){this.searchPopup.deselectRecords(G)}}},renderRemoveRow:function(){return'<span class="'+Ext.baseCSSPrefix+'multiselector-remove" data-qtip="'+this.removeRowTip+'" role="button">'+this.removeRowText+"</span>"},beforeDestroy:function(){Ext.un({mousedown:"onDismissSearch",scope:this});this.callParent()},privates:{onDismissSearch:function(B){var A=this.searchPopup;if(A&&!(A.owns(B.getTarget())||this.owns(B.getTarget()))){Ext.un({mousedown:"onDismissSearch",scope:this});A.hide()}},onShowSearch:function(A,C){var D=this,B=D.searchPopup,E=D.getStore();if(!B){B=Ext.merge({owner:D,field:D.fieldName,floating:true},D.getSearch());D.searchPopup=B=D.add(B);if(E.getCount()){B.selectRecords(E.getRange())}}B.showBy(D,"tl-tr?");Ext.on({mousedown:"onDismissSearch",scope:D})}}});
Ext.define("Ext.panel.Table",{extend:"Ext.panel.Panel",alias:"widget.tablepanel",requires:["Ext.layout.container.Fit"],uses:["Ext.selection.RowModel","Ext.selection.CellModel","Ext.selection.CheckboxModel","Ext.grid.plugin.BufferedRenderer","Ext.grid.header.Container","Ext.grid.locking.Lockable"],extraBaseCls:Ext.baseCSSPrefix+"grid",extraBodyCls:Ext.baseCSSPrefix+"grid-body",defaultBindProperty:"store",layout:"fit",autoLoad:false,variableRowHeight:false,numFromEdge:2,trailingBufferZone:10,leadingBufferZone:20,hasView:false,viewType:null,selType:"rowmodel",scroll:true,deferRowRender:false,sortableColumns:true,multiColumnSort:false,enableLocking:false,scrollerOwner:true,enableColumnMove:true,sealedColumns:false,enableColumnResize:true,rowLines:true,bufferedRenderer:true,ownerGrid:null,colLinesCls:Ext.baseCSSPrefix+"grid-with-col-lines",rowLinesCls:Ext.baseCSSPrefix+"grid-with-row-lines",noRowLinesCls:Ext.baseCSSPrefix+"grid-no-row-lines",hiddenHeaderCtCls:Ext.baseCSSPrefix+"grid-header-ct-hidden",hiddenHeaderCls:Ext.baseCSSPrefix+"grid-header-hidden",resizeMarkerCls:Ext.baseCSSPrefix+"grid-resize-marker",emptyCls:Ext.baseCSSPrefix+"grid-empty",constructor:function(){var A;this.callParent(arguments);A=this.store;A.trackStateChanges=true;if(this.autoLoad){A.unblockLoad();A.load()}},initComponent:function(){if(this.verticalScroller){Ext.Error.raise("The verticalScroller config is not supported.")}if(!this.viewType){Ext.Error.raise("You must specify a viewType config.")}if(this.headers){Ext.Error.raise("The headers config is not supported. Please specify columns instead.")}var B=this,G=B.columns||B.colModel||[],A,D,F,C,E=B.store=Ext.data.StoreManager.lookup(B.store||"ext-empty-store"),H;B.enableLocking=B.enableLocking||B.hasLockedColumns(G);if(B.autoLoad){B.store.blockLoad()}if(B.plugins){B.plugins=B.constructPlugins()}if(B.columnLines){B.addBodyCls(B.colLinesCls)}B.addBodyCls(B.rowLines?B.rowLinesCls:B.noRowLinesCls);B.addBodyCls(B.extraBodyCls);if(B.enableLocking){B.self.mixin("lockable",Ext.grid.locking.Lockable);B.injectLockable()}else{if(G.isRootHeader){B.headerCt=G;B.headerCt.forceFit=!!B.forceFit;B.columnManager=G.columnManager;B.visibleColumnManager=G.visibleColumnManager}else{if(Ext.isArray(G)){G={items:G}}Ext.apply(G,{grid:B,forceFit:B.forceFit,sortable:B.sortableColumns,enableColumnMove:B.enableColumnMove,enableColumnResize:B.enableColumnResize,columnLines:B.columnLines,sealed:B.sealedColumns});if(Ext.isDefined(B.enableColumnHide)){G.enableColumnHide=B.enableColumnHide}B.headerCt=new Ext.grid.header.Container(G)}}B.columns=H=B.headerCt.getGridColumns();B.scrollTask=new Ext.util.DelayedTask(B.syncHorizontalScroll,B);B.cls=(B.cls||"")+(" "+B.extraBaseCls);delete B.autoScroll;C=B.plugins&&Ext.Array.findBy(B.plugins,function(I){return I.isBufferedRenderer});if(C){B.bufferedRenderer=C}if(!B.hasView){if(E.isBufferedStore&&!E.remoteSort){for(D=0,F=H.length;D<F;D++){H[D].sortable=false}}if(B.hideHeaders){B.headerCt.height=0;B.headerCt.hiddenHeaders=true;B.headerCt.addCls(B.hiddenHeaderCtCls);B.addCls(B.hiddenHeaderCls)}B.relayHeaderCtEvents(B.headerCt);B.features=B.features||[];if(!Ext.isArray(B.features)){B.features=[B.features]}B.dockedItems=[].concat(B.dockedItems||[]);B.dockedItems.unshift(B.headerCt);B.viewConfig=B.viewConfig||{};A=B.getView();B.items=[A];B.hasView=true;if(!B.hideHeaders){A.on({scroll:B.onHorizontalScroll,scope:B,onFrame:!!Ext.global.requestAnimationFrame})}B.bindStore(E,true);B.mon(A,{viewready:B.onViewReady,refresh:B.onRestoreHorzScroll,scope:B})}B.relayEvents(B.view,["beforeitemmousedown","beforeitemmouseup","beforeitemmouseenter","beforeitemmouseleave","beforeitemclick","beforeitemdblclick","beforeitemcontextmenu","itemmousedown","itemmouseup","itemmouseenter","itemmouseleave","itemclick","itemdblclick","itemcontextmenu","beforecellclick","cellclick","beforecelldblclick","celldblclick","beforecellcontextmenu","cellcontextmenu","beforecellmousedown","cellmousedown","beforecellmouseup","cellmouseup","beforecellkeydown","cellkeydown","rowclick","rowdblclick","rowcontextmenu","rowmousedown","rowmouseup","rowkeydown","beforeitemkeydown","itemkeydown","beforecontainermousedown","beforecontainermouseup","beforecontainermouseover","beforecontainermouseout","beforecontainerclick","beforecontainerdblclick","beforecontainercontextmenu","beforecontainerkeydown","containermouseup","containermousedown","containermouseover","containermouseout","containerclick","containerdblclick","containercontextmenu","containerkeydown","selectionchange","beforeselect","select","beforedeselect","deselect"]);B.callParent(arguments);B.addStateEvents(["columnresize","columnmove","columnhide","columnshow","sortchange","filterchange","groupchange"])},hasLockedColumns:function(D){var A,B,C;if(D.isRootHeader){D=D.items.items}else{if(Ext.isObject(D)){D=D.items}}for(A=0,B=D.length;A<B;A++){C=D[A];if(!C.processed&&C.locked){return true}}},relayHeaderCtEvents:function(A){this.relayEvents(A,["columnresize","columnmove","columnhide","columnshow","columnschanged","sortchange","headerclick","headercontextmenu","headertriggerclick"])},getState:function(){var A=this,C=A.callParent(),B=A.store.getState();C=A.addPropertyToState(C,"columns",A.headerCt.getColumnsState());if(B){C.storeState=B}return C},applyState:function(F){var C=this,A=F.sort,D=F.storeState,E=C.store,B=F.columns;delete F.columns;C.callParent(arguments);if(B){C.headerCt.applyColumnsState(B)}if(A){if(E.remoteSort){E.sort({property:A.property,direction:A.direction,root:A.root},null,false)}else{E.sort(A.property,A.direction)}}else{if(D){E.applyState(D)}}},getStore:function(){return this.store},getView:function(){var B=this,A,C;if(!B.view){A=B.getSelectionModel();C=Ext.apply({grid:B,ownerGrid:B.ownerGrid||B,deferInitialRefresh:B.deferRowRender,variableRowHeight:B.variableRowHeight,preserveScrollOnRefresh:true,trackOver:B.trackMouseOver!==false,throttledUpdate:B.throttledUpdate===true,scroll:B.scroll,xtype:B.viewType,store:B.store,headerCt:B.headerCt,columnLines:B.columnLines,rowLines:B.rowLines,selModel:A,features:B.features,panel:B,emptyText:B.emptyText||""},B.viewConfig);if(B.scroll&&B.viewConfig.scroll&&B.scroll!==B.viewConfig.scroll){C.scroll="both"}Ext.widget(C);if(B.view.emptyText){B.view.emptyText='<div class="'+B.emptyCls+'">'+B.view.emptyText+"</div>"}B.view.getComponentLayout().headerCt=B.headerCt;B.mon(B.view,{uievent:B.processEvent,scope:B});A.view=B.view;B.headerCt.view=B.view;if(B.hasListeners.viewcreated){B.fireEvent("viewcreated",B,B.view)}}return B.view},getColumnManager:function(){return this.columnManager},getVisibleColumnManager:function(){return this.visibleColumnManager},getTopLevelColumnManager:function(){var A=this.ownerLockable;return A?A.getColumnManager():this.getColumnManager()},getTopLevelVisibleColumnManager:function(){var A=this.ownerLockable;return A?A.getVisibleColumnManager():this.getVisibleColumnManager()},setAutoScroll:Ext.emptyFn,processEvent:function(D,A,J,E,C,B,H,F){var G=this,I;if(C!==-1){I=G.getColumnManager().getHeaderAtIndex(C);return I.processEvent.apply(I,arguments)}},scrollByDeltaY:function(B,A){this.getView().scrollBy(0,B,A)},scrollByDeltaX:function(B,A){this.getView().scrollBy(B,0,A)},afterCollapse:function(){this.saveScrollPos();this.callParent(arguments)},afterExpand:function(){this.callParent(arguments);this.restoreScrollPos()},saveScrollPos:Ext.emptyFn,restoreScrollPos:Ext.emptyFn,onHeaderResize:function(){if(this.view.scrollManager){this.view.scrollManager.refresh()}},onHeaderMove:function(E,D,F,C,A){var B=this;if(B.optimizedColumnMove===false){B.view.refreshView()}else{B.view.moveColumn(C,A,F)}B.delayScroll()},onHeaderHide:function(B,A){if(this.view.refreshCounter){this.view.refreshView()}},onHeaderShow:function(B,A){if(this.view.refreshCounter){this.view.refreshView()}},onHeadersChanged:function(C,B){var A=this;if(A.rendered&&!A.reconfiguring){A.view.refreshView();A.delayScroll()}},delayScroll:function(){var A=this.view;if(A){this.scrollTask.delay(10,null,null,[A])}},onViewReady:function(){this.fireEvent("viewready",this)},onRestoreHorzScroll:function(){var A=this,B=A.scrollXPos;if(B){A.syncHorizontalScroll(A,true)}},getScrollerOwner:function(){var A=this;if(!this.scrollerOwner){A=this.up("[scrollerOwner]")}return A},getLhsMarker:function(){var A=this;return A.lhsMarker||(A.lhsMarker=Ext.DomHelper.append(A.el,{role:"presentation",cls:A.resizeMarkerCls},true))},getRhsMarker:function(){var A=this;return A.rhsMarker||(A.rhsMarker=Ext.DomHelper.append(A.el,{role:"presentation",cls:A.resizeMarkerCls},true))},getSelection:function(){return this.getSelectionModel().getSelection()},setSelection:function(A){var B=this.getSelectionModel();B.select(A)},getSelectionModel:function(){var C=this,E=C.selModel,B,D,A;if(!E){E={};B=true}if(!E.events){A=E.selType||C.selType;B=!E.mode;E=C.selModel=Ext.create("selection."+A,E)}if(C.simpleSelect){D="SIMPLE"}else{if(C.multiSelect){D="MULTI"}}Ext.applyIf(E,{allowDeselect:C.allowDeselect});if(D&&B){E.setSelectionMode(D)}if(!E.hasRelaySetup){C.relayEvents(E,["selectionchange","beforeselect","beforedeselect","select","deselect"]);E.hasRelaySetup=true}if(C.disableSelection){E.locked=true}return E},getScrollTarget:function(){var B=this.getScrollerOwner(),A=B.query("tableview");return A[1]||A[0]},onHorizontalScroll:function(A){this.syncHorizontalScroll(A)},syncHorizontalScroll:function(D,C){var A=this,B=A.view.getScrollX(),E;C=C===true;if(A.rendered&&(C||B!==A.scrollXPos)){if(C){E=A.getScrollTarget();E.setScrollX(B)}A.headerCt.setScrollX(B);A.scrollXPos=B}},onStoreLoad:Ext.emptyFn,getEditorParent:function(){return this.body},bindStore:function(A,B){var C=this,E=C.getView(),D=C.bufferedRenderer;C.store=A;if(D){if(D.isBufferedRenderer){if(D.store){D.bindStore(A)}}else{if(C.bufferedRenderer){D={xclass:"Ext.grid.plugin.BufferedRenderer"};Ext.copyTo(D,C,"variableRowHeight,numFromEdge,trailingBufferZone,leadingBufferZone,scrollToLoadBuffer");C.bufferedRenderer=C.addPlugin(D)}}}if(E.store!==A){E.bindStore(A,false)}C.mon(A,{load:C.onStoreLoad,scope:C});C.storeRelayers=C.relayEvents(A,["filterchange","groupchange"])},unbindStore:function(){var B=this,A=B.store;if(A){B.store=null;B.mun(A,{load:B.onStoreLoad,scope:B});Ext.destroy(B.storeRelayers)}},setColumns:function(A){if(A.length||this.getColumnManager().getColumns().length){this.reconfigure(undefined,A)}},setStore:function(A){this.reconfigure(A)},reconfigure:function(A,F){var B=this,C=B.store,D=B.headerCt,E=D?D.items.getRange():B.columns;if(arguments.length===1&&Ext.isArray(A)){F=A;A=null}if(F){F=Ext.Array.slice(F)}B.reconfiguring=true;B.fireEvent("beforereconfigure",B,A,F,C,E);if(B.lockable){B.reconfigureLockable(A,F)}else{Ext.suspendLayouts();if(F){delete B.scrollXPos;D.removeAll();D.add(F)}if(A&&(A=Ext.StoreManager.lookup(A))!==C){if(B.store){B.unbindStore()}B.bindStore(A)}else{B.getView().refreshView()}D.setSortState();Ext.resumeLayouts(true)}B.fireEvent("reconfigure",B,A,F,C,E);delete B.reconfiguring},beforeDestroy:function(){var A=this.scrollTask;if(A){A.cancel();this.scrollTask=null}this.callParent()},onDestroy:function(){var A=this;if(A.lockable){A.destroyLockable()}A.callParent();A.columns=A.storeRelayers=A.columnManager=A.visibleColumnManager=null},destroy:function(){var A=this;A.callParent();if(A.isDestroyed){A.view=A.selModel=A.headerCt=null}}});
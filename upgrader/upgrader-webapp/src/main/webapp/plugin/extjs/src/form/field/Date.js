Ext.define("Ext.form.field.Date",{extend:"Ext.form.field.Picker",alias:"widget.datefield",requires:["Ext.picker.Date"],alternateClassName:["Ext.form.DateField","Ext.form.Date"],format:"m/d/Y",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j",disabledDaysText:"Disabled",disabledDatesText:"Disabled",minText:"The date in this field must be equal to or after {0}",maxText:"The date in this field must be equal to or before {0}",invalidText:"{0} is not a valid date - it must be in the format {1}",triggerCls:Ext.baseCSSPrefix+"form-date-trigger",showToday:true,useStrict:undefined,initTime:"12",initTimeFormat:"H",matchFieldWidth:false,startDay:0,initComponent:function(){var C=this,B=Ext.isString,A,D;A=C.minValue;D=C.maxValue;if(B(A)){C.minValue=C.parseDate(A)}if(B(D)){C.maxValue=C.parseDate(D)}C.disabledDatesRE=null;C.initDisabledDays();C.callParent()},initValue:function(){var A=this,B=A.value;if(Ext.isString(B)){A.value=A.rawToValue(B)}A.callParent()},initDisabledDays:function(){if(this.disabledDates){var F=this.disabledDates,D=F.length-1,A="(?:",B,C=F.length,E;for(B=0;B<C;B++){E=F[B];A+=Ext.isDate(E)?"^"+Ext.String.escapeRegex(E.dateFormat(this.format))+"$":E;if(B!==D){A+="|"}}this.disabledDatesRE=new RegExp(A+")")}},setDisabledDates:function(B){var A=this,C=A.picker;A.disabledDates=B;A.initDisabledDays();if(C){C.setDisabledDates(A.disabledDatesRE)}},setDisabledDays:function(A){var B=this.picker;this.disabledDays=A;if(B){B.setDisabledDays(A)}},setMinValue:function(C){var A=this,B=A.picker,D=(Ext.isString(C)?A.parseDate(C):C);A.minValue=D;if(B){B.minText=Ext.String.format(A.minText,A.formatDate(A.minValue));B.setMinDate(D)}},setMaxValue:function(C){var A=this,B=A.picker,D=(Ext.isString(C)?A.parseDate(C):C);A.maxValue=D;if(B){B.maxText=Ext.String.format(A.maxText,A.formatDate(A.maxValue));B.setMaxDate(D)}},getErrors:function(G){var K=this,B=Ext.String.format,I=Ext.Date.clearTime,N=K.callParent(arguments),O=K.disabledDays,H=K.disabledDatesRE,L=K.minValue,D=K.maxValue,A=O?O.length:0,J=0,E,M,F,C;G=K.formatDate(G||K.processRawValue(K.getRawValue()));if(G===null||G.length<1){return N}E=G;G=K.parseDate(G);if(!G){N.push(B(K.invalidText,E,Ext.Date.unescapeFormat(K.format)));return N}C=G.getTime();if(L&&C<I(L).getTime()){N.push(B(K.minText,K.formatDate(L)))}if(D&&C>I(D).getTime()){N.push(B(K.maxText,K.formatDate(D)))}if(O){F=G.getDay();for(;J<A;J++){if(F===O[J]){N.push(K.disabledDaysText);break}}}M=K.formatDate(G);if(H&&H.test(M)){N.push(B(K.disabledDatesText,M))}return N},rawToValue:function(A){return this.parseDate(A)||A||null},valueToRaw:function(A){return this.formatDate(this.parseDate(A))},safeParse:function(E,B){var D=this,A=Ext.Date,C=null,G=D.useStrict,F;if(A.formatContainsHourInfo(B)){C=A.parse(E,B,G)}else{F=A.parse(E+" "+D.initTime,B+" "+D.initTimeFormat,G);if(F){C=A.clearTime(F)}}return C},getSubmitValue:function(){var A=this.submitFormat||this.format,B=this.getValue();return B?Ext.Date.format(B,A):""},parseDate:function(F){if(!F||Ext.isDate(F)){return F}var D=this,G=D.safeParse(F,D.format),A=D.altFormats,B=D.altFormatsArray,C=0,E;if(!G&&A){B=B||A.split("|");E=B.length;for(;C<E&&!G;++C){G=D.safeParse(F,B[C])}}return G},formatDate:function(A){return Ext.isDate(A)?Ext.Date.dateFormat(A,this.format):A},createPicker:function(){var B=this,A=Ext.String.format;return new Ext.picker.Date({pickerField:B,renderTo:document.body,floating:true,hidden:true,focusOnShow:true,minDate:B.minValue,maxDate:B.maxValue,disabledDatesRE:B.disabledDatesRE,disabledDatesText:B.disabledDatesText,disabledDays:B.disabledDays,disabledDaysText:B.disabledDaysText,format:B.format,showToday:B.showToday,startDay:B.startDay,minText:A(B.minText,B.formatDate(B.minValue)),maxText:A(B.maxText,B.formatDate(B.maxValue)),listeners:{scope:B,select:B.onSelect},keyNavConfig:{esc:function(){B.collapse();B.focus()}}})},onDownArrow:function(A){this.callParent(arguments);if(this.isExpanded){this.getPicker().focus()}},onSelect:function(B,A){var C=this;C.setValue(A);C.fireEvent("select",C,A);C.collapse();C.focus(false,50)},onExpand:function(){var A=this.getValue();this.picker.setValue(Ext.isDate(A)?A:new Date())},beforeBlur:function(){var A=this,B=A.rawToValue(A.getRawValue());if(Ext.isDate(B)){A.setValue(B)}}});
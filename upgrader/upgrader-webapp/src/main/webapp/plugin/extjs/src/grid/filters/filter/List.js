Ext.define("Ext.grid.filters.filter.List",{extend:"Ext.grid.filters.filter.SingleFilter",alias:"grid.filter.list",type:"list",operator:"in",itemDefaults:{checked:false,hideOnClick:false},idField:"id",labelField:"text",loadingText:"Loading...",loadOnShow:true,single:false,plain:true,destroy:function(){var B=this,A=B.optionsStore;if(A){if(B.autoStore){A.destroyStore()}else{A.un("unload",B.onLoad,B)}}B.callParent()},createMenu:function(D){var E=this,B=E.grid.store,F=E.optionsStore,C=E.options,G,A;E.callParent(arguments);G=E.menu;if(F){A=F.getData();if(!A.length){G.add({text:E.loadingText,iconCls:"loading-indicator"});F.on("load",E.createMenuStore,E,{single:true})}else{E.createMenuItems(F)}}else{if(C){E.createMenuStore(C)}else{if(B.getData().length){E.createMenuStore()}else{B.on("load",E.createMenuStore,G,{single:true})}}}},createMenuItems:function(B){var A=this,G=A.menu,C=B.getData(),I=C.length,H={checkchange:A.setValue,scope:A},D=A.getItemDefaults(),E,K,J,F;if(I){E=C.items;G.removeAll(true);K=A.single?Ext.id():null;for(F=0;F<I;F++){C=E[F].data;J=C[A.idField];G.add(Ext.apply({text:C[A.labelField],group:K,value:J,listeners:H},D))}A.loaded=true}},createMenuStore:function(C){var A=this,G=[],B,D,E,F;C=C||A.grid.store.collect(A.column.dataIndex,false,true)||[];for(B=0,D=C.length;B<D;B++){E=C[B];switch(Ext.typeOf(E)){case"array":G.push(E);break;case"object":G.push([E[A.idField],E[A.labelField]]);break;default:if(E!=null){G.push([E,E])}}}F=A.menu.store=new Ext.data.ArrayStore({fields:[A.idField,A.labelField],data:G});A.createMenuItems(F);A.loaded=true;A.autoStore=true},setValue:function(){var C=this,E=C.menu.items,A=[],B,D,F;for(B=0,D=E.length;B<D;B++){F=E.getAt(B);if(F.checked){A.push(F.value)}}C.filter.setValue(A);D=A.length;if(D&&C.active){C.updateStoreFilter(C.filter)}else{C.setActive(!!D)}},show:function(){if(this.loadOnShow&&!this.loaded&&!this.optionsStore.loading){this.optionsStore.load()}this.callParent()},activateMenu:function(){var C=this,E=C.menu.items,A=C.filter.getValue(),B,D,F;for(B=0,D=E.length;B<D;B++){F=E.getAt(B);if(A.indexOf(F.value)>-1){F.setChecked(true,true)}}}});
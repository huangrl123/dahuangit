Ext.define("Ext.dd.DD",{extend:"Ext.dd.DragDrop",requires:["Ext.dd.DragDropManager"],constructor:function(C,B,A){if(C){this.init(C,B,A)}},scroll:true,autoOffset:function(B,A){var C=B-this.startPageX,D=A-this.startPageY;this.setDelta(C,D)},setDelta:function(A,B){this.deltaX=A;this.deltaY=B},setDragElPos:function(B,A){var C=this.getDragEl();this.alignElWithMouse(C,B,A)},alignElWithMouse:function(F,C,D){var E=this.getTargetCoord(C,D),A=F.dom?F:Ext.fly(F,"_dd"),G=A.getSize(),B=Ext.Element,J,I,H,K;if(!this.deltaSetXY){J=this.cachedViewportSize={width:B.getDocumentWidth(),height:B.getDocumentHeight()};I=[Math.max(0,Math.min(E.x,J.width-G.width)),Math.max(0,Math.min(E.y,J.height-G.height))];A.setXY(I);H=this.getLocalX(A);K=A.getLocalY();this.deltaSetXY=[H-E.x,K-E.y]}else{J=this.cachedViewportSize;this.setLocalXY(A,Math.max(0,Math.min(E.x+this.deltaSetXY[0],J.width-G.width)),Math.max(0,Math.min(E.y+this.deltaSetXY[1],J.height-G.height)))}this.cachePosition(E.x,E.y);this.autoScroll(E.x,E.y,F.offsetHeight,F.offsetWidth);return E},cachePosition:function(B,A){if(B){this.lastPageX=B;this.lastPageY=A}else{var C=Ext.fly(this.getEl()).getXY();this.lastPageX=C[0];this.lastPageY=C[1]}},autoScroll:function(L,M,G,D){if(this.scroll){var B=Ext.Element.getViewportHeight(),I=Ext.Element.getViewportWidth(),A=this.DDMInstance.getScrollTop(),H=this.DDMInstance.getScrollLeft(),N=G+M,C=D+L,E=(B+A-M-this.deltaY),J=(I+H-L-this.deltaX),K=40,F=(document.all)?80:30;if(N>B&&E<K){window.scrollTo(H,A+F)}if(M<A&&A>0&&M-A<K){window.scrollTo(H,A-F)}if(C>I&&J<K){window.scrollTo(H+F,A)}if(L<H&&H>0&&L-H<K){window.scrollTo(H-F,A)}}},getTargetCoord:function(B,A){var C=B-this.deltaX,D=A-this.deltaY;if(this.constrainX){if(C<this.minX){C=this.minX}if(C>this.maxX){C=this.maxX}}if(this.constrainY){if(D<this.minY){D=this.minY}if(D>this.maxY){D=this.maxY}}C=this.getTick(C,this.xTicks);D=this.getTick(D,this.yTicks);return{x:C,y:D}},applyConfig:function(){this.callParent();this.scroll=(this.config.scroll!==false)},b4MouseDown:function(B){var A=B.getXY();this.autoOffset(A[0],A[1])},b4Drag:function(B){var A=B.getXY();this.setDragElPos(A[0],A[1])},toString:function(){return("DD "+this.id)},getLocalX:function(A){return A.getLocalX()},setLocalXY:function(A,B,C){A.setLocalXY(B,C)}});
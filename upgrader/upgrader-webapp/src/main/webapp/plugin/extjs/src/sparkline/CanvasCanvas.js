Ext.define("Ext.sparkline.CanvasCanvas",{extend:"Ext.sparkline.CanvasBase",constructor:function(A){this.owner=A},setWidth:function(A){this.callParent(arguments);this.owner.element.dom.width=A},setHeight:function(A){this.callParent(arguments);this.owner.element.dom.height=A},onOwnerUpdate:function(){var A=this;A.el=A.owner.element;A.interact=!A.owner.initialConfig.disableInteraction;A.shapes={};A.shapeseq=[];A.currentTargetShapeId=A.lastShapeId=null},_getContext:function(B,D,C){var A=this.el.dom.getContext("2d");if(B!=null){A.strokeStyle=B}A.lineWidth=C||1;if(D!=null){A.fillStyle=D}return A},reset:function(){var A=this._getContext();A.clearRect(0,0,this.pixelWidth,this.pixelHeight);this.shapes={};this.shapeseq=[];this.currentTargetShapeId=this.lastShapeId=null},_drawShape:function(G,F,H,A,E){var C=this._getContext(H,A,E),D,B;C.beginPath();C.moveTo(F[0][0]+0.5,F[0][1]+0.5);for(D=1,B=F.length;D<B;D++){C.lineTo(F[D][0]+0.5,F[D][1]+0.5)}if(H!=null){C.stroke()}if(A!=null){C.fill()}if(this.targetX!=null&&this.targetY!=null&&C.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=G}},_drawCircle:function(H,F,G,D,C,A,E){var B=this._getContext(C,A,E);B.beginPath();B.arc(F,G,D,0,2*Math.PI,false);if(this.targetX!=null&&this.targetY!=null&&B.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=H}if(C!==undefined){B.stroke()}if(A!==undefined){B.fill()}},_drawPieSlice:function(H,F,G,E,I,A,D,C){var B=this._getContext(D,C);B.beginPath();B.moveTo(F,G);B.arc(F,G,E,I,A,false);B.lineTo(F,G);B.closePath();if(D!=null){B.stroke()}if(C){B.fill()}if(this.targetX!==undefined&&this.targetY!==undefined&&B.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=H}},_drawRect:function(B,C,D,E,A,F,G){return this._drawShape(B,[[C,D],[C+E,D],[C+E,D+A],[C,D+A],[C,D]],F,G)},appendShape:function(A){this.shapes[A.id]=A;this.shapeseq.push(A.id);this.lastShapeId=A.id;return A.id},replaceWithShape:function(C,D){var B=this.shapeseq,A;this.shapes[D.id]=D;for(A=B.length;A--;){if(B[A]==C){B[A]=D.id}}delete this.shapes[C]},replaceWithShapes:function(B,D){var C=this.shapeseq,G={},E,A,F;for(A=B.length;A--;){G[B[A]]=true}for(A=C.length;A--;){E=C[A];if(G[E]){C.splice(A,1);delete this.shapes[E];F=A}}for(A=D.length;A--;){C.splice(F,0,D[A].id);this.shapes[D[A].id]=D[A]}},insertAfterShape:function(C,D){var B=this.shapeseq,A;for(A=B.length;A--;){if(B[A]===C){B.splice(A+1,0,D.id);this.shapes[D.id]=D;return}}},removeShapeId:function(C){var B=this.shapeseq,A;for(A=B.length;A--;){if(B[A]===C){B.splice(A,1);break}}delete this.shapes[C]},getShapeAt:function(A,B){this.targetX=A;this.targetY=B;this.render();return this.currentTargetShapeId},render:function(){var D=this.shapeseq,F=this.shapes,B=D.length,A=this._getContext(),E,G,C;A.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(C=0;C<B;C++){E=D[C];G=F[E];this["_draw"+G.type].apply(this,G.args)}if(!this.interact){this.shapes={};this.shapeseq=[]}}});
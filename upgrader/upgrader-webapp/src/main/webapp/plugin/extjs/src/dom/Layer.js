Ext.define("Ext.dom.Layer",{extend:"Ext.Element",uses:["Ext.Shadow"],alternateClassName:"Ext.Layer",isLayer:true,localXYNames:{get:"getLocalXY",set:"setLocalXY"},constructor:function(B,J){B=B||{};var I=this,H=Ext.DomHelper,K=B.parentEl,E=K?Ext.getDom(K):document.body,A=B.hideMode,F=Ext.baseCSSPrefix+(B.fixed?"fixed-layer":"layer"),D,G,C;if(J){D=Ext.getDom(J);if(!D.parentNode){E.appendChild(D)}}if(!D){D=H.append(E,B.dh||{tag:"div",cls:F})}if(B.id){D.id=B.id}G=D.id;if(G){C=Ext.cache[G];if(C){delete Ext.cache[G];C.dom=null}}this.callParent([D]);if(J){I.addCls(F)}if(B.preventSync){I.preventSync=true}if(B.cls){I.addCls(B.cls)}I.constrain=B.constrain!==false;if(A){I.setVisibilityMode(Ext.Element[A.toUpperCase()])}else{if(B.useDisplay){I.setVisibilityMode(Ext.Element.DISPLAY)}else{I.setVisibilityMode(Ext.Element.VISIBILITY)}}if(B.shadow){I.shadowOffset=B.shadowOffset||4;I.shadow=new Ext.Shadow({offset:I.shadowOffset,mode:B.shadow,fixed:B.fixed});I.disableShadow()}else{I.shadowOffset=0}if(B.hidden===true){I.hide()}else{if(B.hidden===false){I.show()}}},getZIndex:function(){return parseInt(this.getStyle("z-index"),10)},disableShadow:function(){var A=this;if(A.shadow&&!A.shadowDisabled){A.shadowDisabled=true;A.shadow.hide();A.lastShadowOffset=A.shadowOffset;A.shadowOffset=0}},enableShadow:function(A){var B=this;if(B.shadow&&B.shadowDisabled){B.shadowDisabled=false;B.shadowOffset=B.lastShadowOffset;delete B.lastShadowOffset;if(A){B.sync(true)}}},sync:function(C){var F=this,D=F.shadow,B,G,H,A,E;if(F.preventSync){return}if(!F.updating&&F.isVisible()&&D){B=F[F.localXYNames.get]();G=B[0];H=B[1];A=F.dom.offsetWidth;E=F.dom.offsetHeight;if(D&&!F.shadowDisabled){if(C&&!D.isVisible()){D.show(F)}else{D.realign(G,H,A,E)}}}return F},destroy:function(){this.hideUnders();this.callParent()},beginUpdate:function(){this.updating=true},endUpdate:function(){this.updating=false;this.sync(true)},hideUnders:function(){if(this.shadow){this.shadow.hide()}},constrainXY:function(){if(this.constrain){var C=Ext.Element.getViewportWidth(),J=Ext.Element.getViewportHeight(),A=Ext.getDoc().getScroll(),E=this.getXY(),H=E[0],I=E[1],G=this.shadowOffset,B=this.dom.offsetWidth+G,F=this.dom.offsetHeight+G,D=false;if((H+B)>C+A.left){H=C-B-G;D=true}if((I+F)>J+A.top){I=J-F-G;D=true}if(H<A.left){H=A.left;D=true}if(I<A.top){I=A.top;D=true}if(D){Ext.Layer.superclass.setXY.call(this,[H,I]);this.sync()}}return this},getConstrainOffset:function(){return this.shadowOffset},setVisible:function(C,D,F,A,E){var B=this,G;G=function(){if(C){B.sync(true)}if(A){A()}};if(!C){B.hideUnders(true)}B.callParent([C,D,F,A,E]);if(!D){G()}return B},beforeFx:function(){this.beforeAction();return this.callParent(arguments)},afterFx:function(){this.callParent(arguments);this.sync(this.isVisible())},beforeAction:function(){if(!this.updating&&this.shadow){this.shadow.hide()}},setLeft:function(A){this.callParent(arguments);return this.sync()},setTop:function(A){this.callParent(arguments);return this.sync()},setLeftTop:function(A,B){this.callParent(arguments);return this.sync()},setLocalX:function(){this.callParent(arguments);return this.sync()},setLocalXY:function(){this.callParent(arguments);return this.sync()},setLocalY:function(){this.callParent(arguments);return this.sync()},setXY:function(A,B,E,F,C){var D=this;F=D.createCB(F);D.fixDisplay();D.beforeAction();D.callParent([A,B,E,F,C]);if(!B){F()}return D},createCB:function(A){var B=this,C=B.shadow&&B.shadow.isVisible();return function(){B.constrainXY();B.sync(C);if(A){A()}}},setX:function(D,B,E,A,C){this.setXY([D,this.getY()],B,E,A,C);return this},setY:function(E,B,D,A,C){this.setXY([this.getX(),E],B,D,A,C);return this},setSize:function(E,A,B,G,F,C){var D=this;F=D.createCB(F);D.beforeAction();D.callParent([E,A,B,G,F,C]);if(!B){F()}return D},setWidth:function(E,B,F,A,C){var D=this;A=D.createCB(A);D.beforeAction();D.callParent([E,B,F,A,C]);if(!B){A()}return D},setHeight:function(A,B,E,F,C){var D=this;F=D.createCB(F);D.beforeAction();D.callParent([A,B,E,F,C]);if(!B){F()}return D},setZIndex:function(A){var B=this;B.zindex=A;if(B.shadow){B.shadow.setZIndex(A)}return B.setStyle("z-index",A)},onOpacitySet:function(B){var A=this.shadow;if(A){A.setOpacity(B)}},deprecated:{"4.2":{setBounds:function(H,I,F,A,B,C,D,E){var G=this;D=G.createCB(D);G.beforeAction();if(!B){Ext.Layer.superclass.setXY.call(G,[H,I]);Ext.Layer.superclass.setSize.call(G,F,A);D()}else{G.callParent([H,I,F,A,B,C,D,E])}return G}}}});
Ext.define("Ext.dd.ScrollManager",{singleton:true,requires:["Ext.dd.DragDropManager"],dirTrans:{up:-1,left:-1,down:1,right:1},constructor:function(){var A=Ext.dd.DragDropManager;A.fireEvents=Ext.Function.createSequence(A.fireEvents,this.onFire,this);A.stopDrag=Ext.Function.createSequence(A.stopDrag,this.onStop,this);this.doScroll=this.doScroll.bind(this);this.ddmInstance=A;this.els={};this.dragEl=null;this.proc={}},onStop:function(A){var B=Ext.dd.ScrollManager;B.dragEl=null;B.clearProc()},triggerRefresh:function(){if(this.ddmInstance.dragCurrent){this.ddmInstance.refreshCache(this.ddmInstance.dragCurrent.groups)}},doScroll:function(){var G=this;if(G.ddmInstance.dragCurrent){var C=G.proc,H=C.el,A=C.component,E=C.el.ddScrollConfig,F=E&&E.increment?E.increment:G.increment,D=E&&"animate" in E?E.animate:G.animate,B=function(){G.triggerRefresh()};if(D){if(D===true){D={callback:B}}else{D.callback=D.callback?Ext.Function.createSequence(D.callback,B):B}}if(A){F=F*G.dirTrans[C.dir];if(C.dir==="up"||C.dir==="down"){A.scrollBy(0,F,D)}else{A.scrollBy(F,0,D)}}else{H.scroll(C.dir,F,D)}if(!D){B()}}},clearProc:function(){var A=this.proc;if(A.id){clearInterval(A.id)}if(A.scroller){A.scroller.setSnapToBoundary(true);A.scroller.snapToBoundary()}A.id=0;A.el=A.component=A.scroller=null;A.dir=""},startProc:function(A,G){var E=this,B,C,D,F=E.proc;E.clearProc();F.el=A;F.dir=G;if(Ext.supports.touchScroll===2&&(D=A.component)&&A===D.getOverflowEl()){F.component=D;F.scroller=D.scrollManager.scroller;F.scroller.setSnapToBoundary(false)}B=A.ddScrollConfig?A.ddScrollConfig.ddGroup:undefined;C=(A.ddScrollConfig&&A.ddScrollConfig.frequency)?A.ddScrollConfig.frequency:E.frequency;if(B===undefined||E.ddmInstance.dragCurrent.ddGroup===B){F.id=setInterval(E.doScroll,C)}},onFire:function(A,H){var J=this,B,D,F,I,G,E,C;if(H||!J.ddmInstance.dragCurrent){return}if(!J.dragEl||J.dragEl!==J.ddmInstance.dragCurrent){J.dragEl=J.ddmInstance.dragCurrent;J.refreshCache()}B=A.getPoint();D=J.proc;F=J.els;for(I in F){G=F[I];E=G._region;C=G.ddScrollConfig||J;if(E&&E.contains(B)&&G.isScrollable()){if(E.bottom-B.y<=C.vthresh){if(D.el!==G){J.startProc(G,"down")}return}else{if(E.right-B.x<=C.hthresh){if(D.el!==G){J.startProc(G,"right")}return}else{if(B.y-E.top<=C.vthresh){if(D.el!==G){J.startProc(G,"up")}return}else{if(B.x-E.left<=C.hthresh){if(D.el!==G){J.startProc(G,"left")}return}}}}}}J.clearProc()},register:function(A){if(Ext.isArray(A)){for(var B=0,C=A.length;B<C;B++){this.register(A[B])}}else{A=Ext.get(A);this.els[A.id]=A}},unregister:function(A){if(Ext.isArray(A)){for(var B=0,C=A.length;B<C;B++){this.unregister(A[B])}}else{A=Ext.get(A);delete this.els[A.id]}},vthresh:25*(window.devicePixelRatio||1),hthresh:25*(window.devicePixelRatio||1),increment:100,frequency:500,animate:true,animDuration:0.4,ddGroup:undefined,refreshCache:function(){var A=this.els,B;for(B in A){if(typeof A[B]=="object"){A[B]._region=A[B].getRegion()}}}});
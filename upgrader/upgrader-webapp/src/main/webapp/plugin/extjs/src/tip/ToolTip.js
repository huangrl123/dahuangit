Ext.define("Ext.tip.ToolTip",{extend:"Ext.tip.Tip",alias:"widget.tooltip",alternateClassName:"Ext.ToolTip",autoHide:true,showDelay:500,hideDelay:200,dismissDelay:5000,trackMouse:false,anchorToTarget:true,anchorOffset:0,targetCounter:0,quickShowInterval:250,hideAction:"hide",fadeOutDuration:1000,ariaRole:"tooltip",initComponent:function(){var A=this;A.callParent(arguments);A.lastActive=new Date();A.setTarget(A.target);A.origAnchor=A.anchor},onRender:function(C,B){var A=this;A.callParent(arguments);A.anchorCls=Ext.baseCSSPrefix+"tip-anchor-"+A.getAnchorPosition();if(A.sticky){A.el.dom.setAttribute("data-sticky",true)}A.anchorEl=A.el.createChild({role:"presentation",cls:Ext.baseCSSPrefix+"tip-anchor "+A.anchorCls})},setTarget:function(D){var B=this,C=Ext.get(D),A;if(B.target){A=Ext.get(B.target);if(Ext.supports.Touch){B.mun(A,"tap",B.onTargetOver,B)}else{B.mun(A,{mouseover:B.onTargetOver,mouseout:B.onTargetOut,mousemove:B.onMouseMove,scope:B})}}B.target=C;if(C){if(Ext.supports.Touch){B.mon(C,{tap:B.onTargetOver,scope:B})}else{B.mon(C,{mouseover:B.onTargetOver,mouseout:B.onTargetOut,mousemove:B.onMouseMove,scope:B})}}if(B.anchor){B.anchorTarget=B.target}},onMouseMove:function(B){var C=this,D,A;if(!C.target||C.target.contains(B.target)){D=C.delegate?B.getTarget(C.delegate):C.triggerElement=true;if(D){C.targetXY=B.getXY();if(D===C.triggerElement){if(!C.hidden&&C.trackMouse){A=C.getTargetXY();if(C.constrainPosition){A=C.el.adjustForConstraints(A,C.el.parent())}C.setPagePosition(A)}}else{C.hide();C.lastActive=new Date(0);C.onTargetOver(B)}}else{if((!C.closable&&C.isVisible())&&C.autoHide!==false){C.delayHide()}}}},getTargetXY:function(){var J=this,G,D,F,B,I,A,M,K,C,H,E,L;if(J.delegate){J.anchorTarget=J.triggerElement}if(J.anchor){J.targetCounter++;D=J.getOffsets();F=(J.anchorToTarget&&!J.trackMouse)?J.getAlignToXY(J.anchorTarget,J.getAnchorAlign()):J.targetXY;B=Ext.Element.getViewportWidth()-5;I=Ext.Element.getViewportHeight()-5;A=document.documentElement;M=document.body;K=(A.scrollLeft||M.scrollLeft||0)+5;C=(A.scrollTop||M.scrollTop||0)+5;H=[F[0]+D[0],F[1]+D[1]];E=J.getSize();L=J.constrainPosition;J.anchorEl.removeCls(J.anchorCls);if(J.targetCounter<2&&L){if(H[0]<K){if(J.anchorToTarget){J.defaultAlign="l-r";if(J.mouseOffset){J.mouseOffset[0]*=-1}}J.anchor="left";return J.getTargetXY()}if(H[0]+E.width>B){if(J.anchorToTarget){J.defaultAlign="r-l";if(J.mouseOffset){J.mouseOffset[0]*=-1}}J.anchor="right";return J.getTargetXY()}if(H[1]<C){if(J.anchorToTarget){J.defaultAlign="t-b";if(J.mouseOffset){J.mouseOffset[1]*=-1}}J.anchor="top";return J.getTargetXY()}if(H[1]+E.height>I){if(J.anchorToTarget){J.defaultAlign="b-t";if(J.mouseOffset){J.mouseOffset[1]*=-1}}J.anchor="bottom";return J.getTargetXY()}}J.anchorCls=Ext.baseCSSPrefix+"tip-anchor-"+J.getAnchorPosition();J.anchorEl.addCls(J.anchorCls);J.targetCounter=0;return H}else{G=J.getMouseOffset();return(J.targetXY)?[J.targetXY[0]+G[0],J.targetXY[1]+G[1]]:G}},getMouseOffset:function(){var B=this,A=B.anchor?[0,0]:[15,18];if(B.mouseOffset){A[0]+=B.mouseOffset[0];A[1]+=B.mouseOffset[1]}return A},fadeOut:function(){var A=this;A.el.fadeOut({duration:A.fadeOutDuration,callback:function(){A.hide();A.el.setOpacity("")}})},getAnchorPosition:function(){var A=this,B;if(A.anchor){A.tipAnchor=A.anchor.charAt(0)}else{B=A.defaultAlign.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!B){Ext.Error.raise('The AnchorTip.defaultAlign value "'+A.defaultAlign+'" is invalid.')}A.tipAnchor=B[1].charAt(0)}switch(A.tipAnchor){case"t":return"top";case"b":return"bottom";case"r":return"right"}return"left"},getAnchorAlign:function(){switch(this.anchor){case"top":return"tl-bl";case"left":return"tl-tr";case"right":return"tr-tl";default:return"bl-tl"}},getOffsets:function(){var B=this,C,A,D=B.getAnchorPosition().charAt(0);if(B.anchorToTarget&&!B.trackMouse){switch(D){case"t":A=[0,9];break;case"b":A=[0,-13];break;case"r":A=[-13,0];break;default:A=[9,0];break}}else{switch(D){case"t":A=[-15-B.anchorOffset,30];break;case"b":A=[-19-B.anchorOffset,-13-B.el.dom.offsetHeight];break;case"r":A=[-15-B.el.dom.offsetWidth,-13-B.anchorOffset];break;default:A=[25,-13-B.anchorOffset];break}}C=B.getMouseOffset();A[0]+=C[0];A[1]+=C[1];return A},onTargetOver:function(A){var B=this,D=B.delegate,C;if(B.disabled||A.within(B.target.dom,true)){return}C=D?A.getTarget(D):true;if(C){B.triggerElement=C;B.triggerEvent=A;B.clearTimer("hide");B.targetXY=A.getXY();B.delayShow()}},delayShow:function(C){var B=this,A=B.el&&(C===false||!B.trackMouse)&&B.getTargetXY();if(B.hidden&&!B.showTimer){if(Ext.Date.getElapsed(B.lastActive)<B.quickShowInterval){B.show()}else{B.showTimer=Ext.defer(B.showFromDelay,B.showDelay,B,[A])}}else{if(!B.hidden&&B.autoHide!==false){B.show(A)}}},showFromDelay:function(A){this.fromDelayShow=true;this.show(A);delete this.fromDelayShow},onShowVeto:function(){this.callParent();delete this.triggerElement;this.clearTimer("show")},onTargetOut:function(B){var C=this,A=C.triggerElement,D=A===true?C.target:A;if(C.disabled||!A||B.within(D,true)){return}if(C.showTimer){C.clearTimer("show");C.triggerElement=null}if(C.autoHide!==false){C.delayHide()}},delayHide:function(){var A=this;if(!A.hidden&&!A.hideTimer){A.hideTimer=Ext.defer(A[A.hideAction],A.hideDelay,A)}},hide:function(){var A=this;A.clearTimer("dismiss");A.lastActive=new Date();if(A.anchorEl){A.anchorEl.hide()}A.callParent(arguments);delete A.triggerElement},show:function(A){var B=this;this.callParent();if(this.hidden===false){if(B.anchor){B.anchor=B.origAnchor}if(!B.calledFromShowAt){B.showAt(A||B.getTargetXY())}if(B.anchor){B.syncAnchor();B.anchorEl.show()}else{B.anchorEl.hide()}}},showAt:function(A){var B=this;B.lastActive=new Date();B.clearTimers();B.calledFromShowAt=true;if(!B.isVisible()){this.callParent(arguments)}if(B.isVisible()){B.setPagePosition(A[0],A[1]);if(B.constrainPosition||B.constrain){B.doConstrain()}B.toFront(true);B.el.sync(true);if(B.dismissDelay&&B.autoHide!==false){B.dismissTimer=Ext.defer(B.hide,B.dismissDelay,B)}if(B.anchor){B.syncAnchor();if(!B.anchorEl.isVisible()){B.anchorEl.show()}}else{B.anchorEl.hide()}}delete B.calledFromShowAt},syncAnchor:function(){var B=this,D,C,A;switch(B.tipAnchor.charAt(0)){case"t":D="b";C="tl";A=[20+B.anchorOffset,1];break;case"r":D="l";C="tr";A=[-1,12+B.anchorOffset];break;case"b":D="t";C="bl";A=[20+B.anchorOffset,-1];break;default:D="r";C="tl";A=[1,12+B.anchorOffset];break}B.anchorEl.alignTo(B.el,D+"-"+C,A);B.anchorEl.setStyle("z-index",parseInt(B.el.getZIndex(),10)||0+1).setVisibilityMode(Ext.Element.DISPLAY)},setPagePosition:function(B,C){var A=this;A.callParent(arguments);if(A.anchor){A.syncAnchor()}},_timerNames:{},clearTimer:function(C){var A=this,D=A._timerNames,E=D[C]||(D[C]=C+"Timer"),B=A[E];if(B){clearTimeout(B);A[E]=null}},clearTimers:function(){var A=this;A.clearTimer("show");A.clearTimer("dismiss");A.clearTimer("hide")},onShow:function(){var A=this;A.callParent();A.mon(Ext.getDoc(),"mousedown",A.onDocMouseDown,A)},onHide:function(){var A=this;A.callParent();A.mun(Ext.getDoc(),"mousedown",A.onDocMouseDown,A)},onDocMouseDown:function(A){var B=this;if(!B.closable&&!A.within(B.el.dom)){B.disable();Ext.defer(B.doEnable,100,B)}},doEnable:function(){if(!this.isDestroyed){this.enable()}},onDisable:function(){this.callParent();this.clearTimers();this.hide()},beforeDestroy:function(){var A=this;A.clearTimers();Ext.destroy(A.anchorEl);delete A.anchorEl;delete A.target;delete A.anchorTarget;delete A.triggerElement;A.callParent()},onDestroy:function(){Ext.getDoc().un("mousedown",this.onDocMouseDown,this);this.callParent()}});
Ext.define("Ext.dd.DragSource",{extend:"Ext.dd.DDProxy",requires:["Ext.dd.StatusProxy","Ext.dd.DragDropManager"],dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",animRepair:true,repairHighlightColor:"c3daf9",constructor:function(A,B){this.el=Ext.get(A);if(!this.dragData){this.dragData={}}Ext.apply(this,B);if(!this.proxy){this.proxy=new Ext.dd.StatusProxy({id:this.el.id+"-drag-status-proxy",animRepair:this.animRepair})}this.callParent([this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:false,isTarget:false,scroll:this.scroll===true}]);this.dragging=false},getDragData:function(A){return this.dragData},onDragEnter:function(A,D){var C=Ext.dd.DragDropManager.getDDById(D),B;this.cachedTarget=C;if(this.beforeDragEnter(C,A,D)!==false){if(C.isNotifyTarget){B=C.notifyEnter(this,A,this.dragData);this.proxy.setStatus(B)}else{this.proxy.setStatus(this.dropAllowed)}if(this.afterDragEnter){this.afterDragEnter(C,A,D)}}},beforeDragEnter:function(B,A,C){return true},onDragOver:function(A,D){var C=this.cachedTarget||Ext.dd.DragDropManager.getDDById(D),B;if(this.beforeDragOver(C,A,D)!==false){if(C.isNotifyTarget){B=C.notifyOver(this,A,this.dragData);this.proxy.setStatus(B)}if(this.afterDragOver){this.afterDragOver(C,A,D)}}},beforeDragOver:function(B,A,C){return true},onDragOut:function(A,C){var B=this.cachedTarget||Ext.dd.DragDropManager.getDDById(C);if(this.beforeDragOut(B,A,C)!==false){if(B.isNotifyTarget){B.notifyOut(this,A,this.dragData)}this.proxy.reset();if(this.afterDragOut){this.afterDragOut(B,A,C)}}this.cachedTarget=null},beforeDragOut:function(B,A,C){return true},onDragDrop:function(A,C){var B=this.cachedTarget||Ext.dd.DragDropManager.getDDById(C);if(this.beforeDragDrop(B,A,C)!==false){if(B.isNotifyTarget){if(B.notifyDrop(this,A,this.dragData)!==false){this.onValidDrop(B,A,C)}else{this.onInvalidDrop(B,A,C)}}else{this.onValidDrop(B,A,C)}if(this.afterDragDrop){this.afterDragDrop(B,A,C)}}delete this.cachedTarget},beforeDragDrop:function(B,A,C){return true},onValidDrop:function(B,A,C){this.hideProxy();if(this.afterValidDrop){this.afterValidDrop(B,A,C)}},getRepairXY:function(A,B){return this.el.getXY()},onInvalidDrop:function(C,A,D){var B=this;if(!A){A=C;C=null;D=A.getTarget().id}if(B.beforeInvalidDrop(C,A,D)!==false){if(B.cachedTarget){if(B.cachedTarget.isNotifyTarget){B.cachedTarget.notifyOut(B,A,B.dragData)}B.cacheTarget=null}B.proxy.repair(B.getRepairXY(A,B.dragData),B.afterRepair,B);if(B.afterInvalidDrop){B.afterInvalidDrop(A,D)}}},afterRepair:function(){var A=this;if(Ext.enableFx){A.el.highlight(A.repairHighlightColor)}A.dragging=false},beforeInvalidDrop:function(B,A,C){return true},handleMouseDown:function(A){if(this.dragging){return}var B=this.getDragData(A);if(B&&this.onBeforeDrag(B,A)!==false){this.dragData=B;this.proxy.stop();this.callParent(arguments)}},onBeforeDrag:function(B,A){return true},onStartDrag:Ext.emptyFn,alignElWithMouse:function(){this.proxy.ensureAttachedToBody(true);return this.callParent(arguments)},startDrag:function(A,B){this.proxy.reset();this.proxy.hidden=false;this.dragging=true;this.proxy.update("");this.onInitDrag(A,B);this.proxy.show()},onInitDrag:function(B,C){var A=this.el.dom.cloneNode(true);A.id=Ext.id();this.proxy.update(A);this.onStartDrag(B,C);return true},getProxy:function(){return this.proxy},hideProxy:function(){this.proxy.hide();this.proxy.reset(true);this.dragging=false},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)},b4EndDrag:function(A){},endDrag:function(A){this.onEndDrag(this.dragData,A)},onEndDrag:function(B,A){},autoOffset:function(A,B){this.setDelta(-12,-20)},destroy:function(){this.callParent();Ext.destroy(this.proxy)}});
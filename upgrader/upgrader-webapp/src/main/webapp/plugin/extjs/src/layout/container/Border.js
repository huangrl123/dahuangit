Ext.define("Ext.layout.container.Border",{extend:"Ext.layout.container.Container",alias:"layout.border",alternateClassName:"Ext.layout.BorderLayout",requires:["Ext.resizer.BorderSplitter","Ext.fx.Anim","Ext.layout.container.border.Region"],targetCls:Ext.baseCSSPrefix+"border-layout-ct",itemCls:[Ext.baseCSSPrefix+"border-item",Ext.baseCSSPrefix+"box-item"],type:"border",isBorderLayout:true,padding:undefined,percentageRe:/(\d+)%/,horzPositionProp:"left",padOnContainerProp:"left",padNotOnContainerProp:"right",axisProps:{horz:{borderBegin:"west",borderEnd:"east",horizontal:true,posProp:"x",sizeProp:"width",sizePropCap:"Width"},vert:{borderBegin:"north",borderEnd:"south",horizontal:false,posProp:"y",sizeProp:"height",sizePropCap:"Height"}},centerRegion:null,manageMargins:true,panelCollapseAnimate:true,panelCollapseMode:"placeholder",regionWeights:{north:20,south:10,center:0,west:-10,east:-20},beginAxis:function(G,D,S){var J=this,C=J.axisProps[S],F=!C.horizontal,L=C.sizeProp,U=0,O=G.childItems,A=O.length,T,H,B,P,K,M,E,I,R,Q,N;for(H=0;H<A;++H){B=O[H];K=B.target;B.layoutPos={};if(K.region){B.region=M=K.region;B.isCenter=K.isCenter;B.isHorz=K.isHorz;B.isVert=K.isVert;B.weight=K.weight||J.regionWeights[M]||0;K.weight=B.weight;D[K.id]=B;if(K.isCenter){T=B;P=K.flex;G.centerRegion=T;continue}if(F!==B.isVert){continue}B.reverseWeighting=(M==C.borderEnd);I=K[L];R=typeof I;if(!K.collapsed){if(R=="string"&&(E=J.percentageRe.exec(I))){B.percentage=parseInt(E[1],10)}else{if(K.flex){U+=B.flex=K.flex}}}}}if(T){Q=T.target;if((N=Q.placeholderFor)){if(!P&&F===N.collapsedVertical()){P=0;T.collapseAxis=S}}else{if(Q.collapsed&&(F===Q.collapsedVertical())){P=0;T.collapseAxis=S}}}if(P==null){P=1}U+=P;return Ext.apply({before:F?"top":"left",totalFlex:U},C)},beginLayout:function(B){var J=this,M=J.getLayoutItems(),N=J.padding,E=typeof N,L=false,C,O,G,H,K,I,F,A,D;if(B.heightModel.shrinkWrap){Ext.Error.raise("Border layout does not currently support shrinkWrap height. Please specify a height on component: "+J.owner.id+", or use a container layout that sets the component's height.")}if(B.widthModel.shrinkWrap){Ext.Error.raise("Border layout does not currently support shrinkWrap width. Please specify a width on component: "+J.owner.id+", or use a container layout that sets the component's width.")}if(N){if(E=="string"||E=="number"){N=Ext.util.Format.parseBox(N)}}else{N=B.getEl("getTargetEl").getPaddingInfo();L=true}B.outerPad=N;B.padOnContainer=L;for(H=0,G=M.length;H<G;++H){O=M[H];I=J.getSplitterTarget(O);if(I){F=undefined;A=!!O.hidden;if(!I.split){if(I.isCollapsingOrExpanding){F=!!I.collapsed}}else{if(A!==I.hidden){F=!I.hidden}}if(F){O.show()}else{if(F===false){O.hide()}}}}J.callParent(arguments);M=B.childItems;G=M.length;K={};B.borderAxisHorz=J.beginAxis(B,K,"horz");B.borderAxisVert=J.beginAxis(B,K,"vert");for(H=0;H<G;++H){C=M[H];I=J.getSplitterTarget(C.target);if(I){D=K[I.id];if(!D){D=B.getEl(I.el,J);D.region=I.region}C.collapseTarget=I=D;C.weight=I.weight;C.reverseWeighting=I.reverseWeighting;I.splitter=C;C.isHorz=I.isHorz;C.isVert=I.isVert}}J.sortWeightedItems(M,"reverseWeighting");J.setupSplitterNeighbors(M)},calculate:function(B){var K=this,A=K.getContainerSize(B),D=B.childItems,F=D.length,M=B.borderAxisHorz,J=B.borderAxisVert,N=B.outerPad,E=B.padOnContainer,H,C,L,G,I,O;M.begin=N[K.padOnContainerProp];J.begin=N.top;I=M.end=M.flexSpace=A.width+(E?N[K.padOnContainerProp]:-N[K.padNotOnContainerProp]);O=J.end=J.flexSpace=A.height+(E?N.top:-N.bottom);for(H=0;H<F;++H){C=D[H];L=C.getMarginInfo();if(C.isHorz||C.isCenter){M.addUnflexed(L.width);I-=L.width}if(C.isVert||C.isCenter){J.addUnflexed(L.height);O-=L.height}if(!C.flex&&!C.percentage){if(C.isHorz||(C.isCenter&&C.collapseAxis==="horz")){G=C.getProp("width");M.addUnflexed(G);if(C.collapseTarget){I-=G}}else{if(C.isVert||(C.isCenter&&C.collapseAxis==="vert")){G=C.getProp("height");J.addUnflexed(G);if(C.collapseTarget){O-=G}}}}}for(H=0;H<F;++H){C=D[H];L=C.getMarginInfo();if(C.percentage){if(C.isHorz){G=Math.ceil(I*C.percentage/100);G=C.setWidth(G);M.addUnflexed(G)}else{if(C.isVert){G=Math.ceil(O*C.percentage/100);G=C.setHeight(G);J.addUnflexed(G)}}}}for(H=0;H<F;++H){C=D[H];if(!C.isCenter){K.calculateChildAxis(C,M);K.calculateChildAxis(C,J)}}if(K.finishAxis(B,J)+K.finishAxis(B,M)<2){K.done=false}else{K.finishPositions(D)}},calculateChildAxis:function(H,A){var I=H.collapseTarget,K="set"+A.sizePropCap,J=A.sizeProp,B=H.getMarginInfo()[J],C,G,E,F,D;if(I){C=I.region}else{C=H.region;E=H.flex}G=C==A.borderBegin;if(!G&&C!=A.borderEnd){H[K](A.end-A.begin-B);F=A.begin}else{if(E){D=Math.ceil(A.flexSpace*(E/A.totalFlex));D=H[K](D)}else{if(H.percentage){D=H.peek(J)}else{D=H.getProp(J)}}D+=B;if(G){F=A.begin;A.begin+=D}else{A.end=F=A.end-D}}H.layoutPos[A.posProp]=F},eachItem:function(G,D,F){var E=this,C=E.getLayoutItems(),A=0,B;if(Ext.isFunction(G)){D=G;F=D}for(A;A<C.length;A++){B=C[A];if(!G||B.region===G){if(D.call(F,B)===false){break}}}},finishAxis:function(C,D){var A=D.end-D.begin,B=C.centerRegion;if(B){B["set"+D.sizePropCap](A-B.getMarginInfo()[D.sizeProp]);B.layoutPos[D.posProp]=D.begin}return Ext.isNumber(A)?1:0},finishPositions:function(E){var B=E.length,D,C,A=this.horzPositionProp;for(D=0;D<B;++D){C=E[D];C.setProp("x",C.layoutPos.x+C.marginInfo[A]);C.setProp("y",C.layoutPos.y+C.marginInfo.top)}},getLayoutItems:function(){var G=this.owner,A=(G&&G.items&&G.items.items)||[],B=A.length,E=[],C=0,D,F;for(;C<B;C++){D=A[C];F=D.placeholderFor;if(D.hidden||((!D.floated||D.isCollapsingOrExpanding===2)&&!(F&&F.isCollapsingOrExpanding===2))){E.push(D)}}return E},getPlaceholder:function(A){return A.getPlaceholder&&A.getPlaceholder()},getMaxWeight:function(A){return this.getMinMaxWeight(A)},getMinWeight:function(A){return this.getMinMaxWeight(A,true)},getMinMaxWeight:function(D,A){var C=this,B=null;C.eachItem(D,function(E){if(E.hasOwnProperty("weight")){if(B===null){B=E.weight;return}if((A&&E.weight<B)||E.weight>B){B=E.weight}}},this);return B},getSplitterTarget:function(A){var B=A.collapseTarget;if(B&&B.collapsed){return B.placeholder||B}return B},isItemBoxParent:function(A){return true},isItemShrinkWrap:function(A){return true},insertSplitter:function(B,D,G,A){var E=B.region,C=Ext.apply({xtype:"bordersplitter",collapseTarget:B,id:B.id+"-splitter",hidden:G,canResize:B.splitterResize!==false,splitterFor:B,synthetic:true},A),F=D+((E==="south"||E==="east")?0:1);if(B.collapseMode==="mini"){C.collapsedCls=B.collapsedCls}B.splitter=this.owner.add(F,C)},getMoveAfterIndex:function(B){var A=this.callParent(arguments);if(B.splitter){A++}return A},moveItemBefore:function(A,B){var D=this.owner,C;if(B&&B.splitter){C=B.region;if(C==="south"||C==="east"){B=B.splitter}}this.callParent([A,B])},onAdd:function(E,C){var A=this,D=E.placeholderFor,I=E.region,B,F,H,G;A.callParent(arguments);if(I){Ext.apply(E,A.regionFlags[I]);if(E.initBorderRegion){E.initBorderRegion()}B=I==="center";if(B){if(A.centerRegion){Ext.Error.raise("Cannot have multiple center regions in a BorderLayout.")}A.centerRegion=E}else{F=E.split;H=!!E.hidden;if(typeof F==="object"){G=F;F=true}if((E.isHorz||E.isVert)&&(F||E.collapseMode=="mini")){A.insertSplitter(E,C,H||!F,G)}}if(!B&&!E.hasOwnProperty("collapseMode")){E.collapseMode=A.panelCollapseMode}if(!E.hasOwnProperty("animCollapse")){if(E.collapseMode!=="placeholder"){E.animCollapse=false}else{E.animCollapse=A.panelCollapseAnimate}}}else{if(D){Ext.apply(E,A.regionFlags[D.region]);E.region=D.region;E.weight=D.weight}}},onDestroy:function(){this.centerRegion=null;this.callParent()},onRemove:function(F,A){var G=this,H=F.region,E=F.splitter,B=G.owner,C=B.destroying,D;if(H){if(F.isCenter){G.centerRegion=null}delete F.isCenter;delete F.isHorz;delete F.isVert;if(E&&!B.destroying){B.doRemove(E,true)}delete F.splitter}G.callParent(arguments);if(!C&&!A&&F.rendered){D=F.getEl();if(D){D.setStyle("top","");D.setStyle(G.horzPositionProp,"")}}},regionMeta:{center:{splitterDelta:0},north:{splitterDelta:1},south:{splitterDelta:-1},west:{splitterDelta:1},east:{splitterDelta:-1}},regionFlags:{center:{isCenter:true,isHorz:false,isVert:false},north:{isCenter:false,isHorz:false,isVert:true,collapseDirection:"top"},south:{isCenter:false,isHorz:false,isVert:true,collapseDirection:"bottom"},west:{isCenter:false,isHorz:true,isVert:false,collapseDirection:"left"},east:{isCenter:false,isHorz:true,isVert:false,collapseDirection:"right"}},setupSplitterNeighbors:function(L){var I={},F=L.length,D=this.touchedRegions,G,E,A,B,K,C,M,H,J;for(G=0;G<F;++G){C=L[G].target;M=C.region;if(C.isCenter){A=C}else{if(M){J=D[M];for(E=0,B=J.length;E<B;++E){K=I[J[E]];if(K){K.neighbors.push(C)}}if(C.placeholderFor){H=C.placeholderFor.splitter}else{H=C.splitter}if(H){H.neighbors=[]}I[M]=H}}}if(A){J=D.center;for(E=0,B=J.length;E<B;++E){K=I[J[E]];if(K){K.neighbors.push(A)}}}},touchedRegions:{center:["north","south","east","west"],north:["north","east","west"],south:["south","east","west"],east:["east","north","south"],west:["west","north","south"]},sizePolicies:{vert:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},horz:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},flexAll:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1}},getItemSizePolicy:function(D){var B=this,E=this.sizePolicies,G,A,C,F;if(D.isCenter){F=D.placeholderFor;if(F){if(F.collapsedVertical()){return E.vert}return E.horz}if(D.collapsed){if(D.collapsedVertical()){return E.vert}return E.horz}return E.flexAll}G=D.collapseTarget;if(G){return G.isVert?E.vert:E.horz}if(D.region){if(D.isVert){A=D.height;C=E.vert}else{A=D.width;C=E.horz}if(D.flex||(typeof A=="string"&&B.percentageRe.test(A))){return E.flexAll}return C}return B.autoSizePolicy}},function(){var B={addUnflexed:function(C){this.flexSpace=Math.max(this.flexSpace-C,0)}},A=this.prototype.axisProps;Ext.apply(A.horz,B);Ext.apply(A.vert,B)});
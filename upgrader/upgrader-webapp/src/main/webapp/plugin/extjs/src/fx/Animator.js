Ext.define("Ext.fx.Animator",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.fx.Manager"],isAnimator:true,duration:250,delay:0,delayStart:0,dynamic:false,easing:"ease",running:false,paused:false,damper:1,iterations:1,currentIteration:0,keyframeStep:0,animKeyFramesRE:/^(from|to|\d+%?)$/,constructor:function(A){var B=this;A=Ext.apply(B,A||{});B.config=A;B.id=Ext.id(null,"ext-animator-");B.mixins.observable.constructor.call(B,A);B.timeline=[];B.createTimeline(B.keyframes);if(B.target){B.applyAnimator(B.target);Ext.fx.Manager.addAnim(B)}},sorter:function(B,A){return B.pct-A.pct},createTimeline:function(F){var I=this,B=[],K=I.to||{},E=I.duration,J,A,H,C,G,D;for(G in F){if(F.hasOwnProperty(G)&&I.animKeyFramesRE.test(G)){D={attrs:Ext.apply(F[G],K)};if(G=="from"){G=0}else{if(G=="to"){G=100}}D.pct=parseInt(G,10);B.push(D)}}Ext.Array.sort(B,I.sorter);C=B.length;for(H=0;H<C;H++){J=(B[H-1])?E*(B[H-1].pct/100):0;A=E*(B[H].pct/100);I.timeline.push({duration:A-J,attrs:B[H].attrs})}},applyAnimator:function(I){var A=this,E=[],D=A.timeline,F=D.length,J,H,C,B,G;if(A.fireEvent("beforeanimate",A)!==false){for(G=0;G<F;G++){J=D[G];B=J.attrs;H=B.easing||A.easing;C=B.damper||A.damper;delete B.easing;delete B.damper;J=new Ext.fx.Anim({target:I,easing:H,damper:C,duration:J.duration,paused:true,to:B});E.push(J)}A.animations=E;A.target=J.target;for(G=0;G<F-1;G++){J=E[G];J.nextAnim=E[G+1];J.on("afteranimate",function(){this.nextAnim.paused=false});J.on("afteranimate",function(){this.fireEvent("keyframe",this,++this.keyframeStep)},A)}E[F-1].on("afteranimate",function(){this.lastFrame()},A)}},start:function(D){var C=this,E=C.delay,B=C.delayStart,A;if(E){if(!B){C.delayStart=D;return}else{A=D-B;if(A<E){return}else{D=new Date(B.getTime()+E)}}}if(C.fireEvent("beforeanimate",C)!==false){C.startTime=D;C.running=true;C.animations[C.keyframeStep].paused=false}},lastFrame:function(){var B=this,A=B.iterations,C=B.currentIteration;C++;if(C<A){B.startTime=new Date();B.currentIteration=C;B.keyframeStep=0;B.applyAnimator(B.target);B.animations[B.keyframeStep].paused=false}else{B.currentIteration=0;B.end()}},end:function(){var A=this;A.fireEvent("afteranimate",A,A.startTime,new Date()-A.startTime)},isReady:function(){return this.paused===false&&this.running===false&&this.iterations>0},isRunning:function(){return false}});
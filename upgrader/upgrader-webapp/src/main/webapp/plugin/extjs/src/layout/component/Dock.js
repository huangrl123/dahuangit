Ext.define("Ext.layout.component.Dock",{extend:"Ext.layout.component.Component",alias:"layout.dock",alternateClassName:"Ext.layout.component.AbstractDock",type:"dock",horzAxisProps:{name:"horz",oppositeName:"vert",dockBegin:"left",dockEnd:"right",horizontal:true,marginBegin:"margin-left",maxSize:"maxWidth",minSize:"minWidth",pos:"x",setSize:"setWidth",shrinkWrapDock:"shrinkWrapDockWidth",size:"width",sizeModel:"widthModel"},vertAxisProps:{name:"vert",oppositeName:"horz",dockBegin:"top",dockEnd:"bottom",horizontal:false,marginBegin:"margin-top",maxSize:"maxHeight",minSize:"minHeight",pos:"y",setSize:"setHeight",shrinkWrapDock:"shrinkWrapDockHeight",size:"height",sizeModel:"heightModel"},initializedBorders:-1,horizontalCollapsePolicy:{width:true,x:true},verticalCollapsePolicy:{height:true,y:true},finishRender:function(){var A=this,C,B;A.callParent();C=A.getRenderTarget();B=A.getDockedItems();A.finishRenderItems(C,B)},isItemBoxParent:function(A){return true},isItemShrinkWrap:function(A){return true},noBorderClasses:[Ext.baseCSSPrefix+"docked-noborder-top",Ext.baseCSSPrefix+"docked-noborder-right",Ext.baseCSSPrefix+"docked-noborder-bottom",Ext.baseCSSPrefix+"docked-noborder-left"],noBorderClassesSides:{top:Ext.baseCSSPrefix+"docked-noborder-top",right:Ext.baseCSSPrefix+"docked-noborder-right",bottom:Ext.baseCSSPrefix+"docked-noborder-bottom",left:Ext.baseCSSPrefix+"docked-noborder-left"},borderWidthProps:{top:"border-top-width",right:"border-right-width",bottom:"border-bottom-width",left:"border-left-width"},_itemCls:Ext.baseCSSPrefix+"docked",handleItemBorders:function(){var K=this,A=K.owner,G,H,B=K.lastDockedItems,F=K.borders,I=A.dockedItems.generation,D=K.noBorderClassesSides,M=K.borderWidthProps,J,E,O,L,C,N=K.collapsed;if(K.initializedBorders==I||(A.border&&!A.manageBodyBorders)){return}K.initializedBorders=I;K.collapsed=false;K.lastDockedItems=H=K.getLayoutItems();K.collapsed=N;G={top:[],right:[],bottom:[],left:[]};for(J=0,E=H.length;J<E;J++){O=H[J];L=O.dock;if(O.ignoreBorderManagement){continue}if(!G[L].satisfied){G[L].push(O);G[L].satisfied=true}if(!G.top.satisfied&&L!=="bottom"){G.top.push(O)}if(!G.right.satisfied&&L!=="left"){G.right.push(O)}if(!G.bottom.satisfied&&L!=="top"){G.bottom.push(O)}if(!G.left.satisfied&&L!=="right"){G.left.push(O)}}if(B){for(J=0,E=B.length;J<E;J++){O=B[J];if(!O.isDestroyed&&!O.ignoreBorderManagement&&!A.manageBodyBorders){O.removeCls(K.noBorderClasses)}}}if(F){for(C in F){if(A.manageBodyBorders&&F[C].satisfied){A.setBodyStyle(M[C],"")}}}for(C in G){E=G[C].length;if(!A.manageBodyBorders){for(J=0;J<E;J++){G[C][J].addCls(D[C])}if((!G[C].satisfied&&!A.bodyBorder)||A.bodyBorder===false){A.addBodyCls(D[C])}else{A.removeBodyCls(D[C])}}else{if(G[C].satisfied){A.setBodyStyle(M[C],"1px")}}}K.borders=G},beforeLayoutCycle:function(E){var D=this,F=D.owner,A=D.sizeModels.shrinkWrap,B=F.shrinkWrapDock,G,C;if(F.collapsed){if(F.collapsedVertical()){C=true;E.measureDimensions=1}else{G=true;E.measureDimensions=2}}E.collapsedVert=C;E.collapsedHorz=G;if(C){E.heightModel=A}else{if(G){E.widthModel=A}}B=B===true?3:(B||0);E.shrinkWrapDockHeight=(B&1)&&E.heightModel.shrinkWrap;E.shrinkWrapDockWidth=(B&2)&&E.widthModel.shrinkWrap},beginLayout:function(A){var J=this,B=J.owner,F=J.getLayoutItems(),H=A.context,C=F.length,K=J.lastCollapsedState,E,I,N,D,G,M,L;J.callParent(arguments);M=B.getCollapsed();if(M!==K&&K!==undefined){if(J.owner.collapsed){A.isCollapsingOrExpanding=1;B.addClsWithUI(B.collapsedCls)}else{A.isCollapsingOrExpanding=2;B.removeClsWithUI(B.collapsedCls);A.lastCollapsedState=J.lastCollapsedState}}J.lastCollapsedState=M;A.dockedItems=E=[];for(I=0;I<C;I++){N=F[I];if(N.rendered){L=N.dock;D=H.getCmp(N);D.dockedAt={x:0,y:0};D.offsets=G=Ext.Element.parseBox(N.offsets||0);D.horizontal=L=="top"||L=="bottom";G.width=G.left+G.right;G.height=G.top+G.bottom;E.push(D)}}A.bodyContext=A.getEl("body")},beginLayoutCycle:function(A){var F=this,D=A.dockedItems,G=D.length,B=F.owner,I=B.frameBody,C=F.lastHeightModel,E,J,H;F.callParent(arguments);if(F.owner.manageHeight){if(F.lastBodyDisplay){B.body.dom.style.display=F.lastBodyDisplay=""}}else{if(F.lastBodyDisplay!=="inline-block"){B.body.dom.style.display=F.lastBodyDisplay="inline-block"}if(C&&C.shrinkWrap&&!A.heightModel.shrinkWrap){B.body.dom.style.marginBottom=""}}if(A.widthModel.auto){if(A.widthModel.shrinkWrap){B.el.setWidth(null)}B.body.setWidth(null);if(I){I.setWidth(null)}}if(A.heightModel.auto){B.body.setHeight(null);if(I){I.setHeight(null)}}if(A.collapsedVert){A.setContentHeight(0)}else{if(A.collapsedHorz){A.setContentWidth(0)}}for(E=0;E<G;E++){J=D[E].target;H=J.dock;if(H=="right"){J.setLocalX(0)}else{if(H!="left"){continue}}}},calculate:function(B){var J=this,E=J.measureAutoDimensions(B,B.measureDimensions),G=B.state,F=G.horzDone,L=G.vertDone,H=B.bodyContext,A,K,I,C,D;B.borderInfo||B.getBorderInfo();B.paddingInfo||B.getPaddingInfo();B.frameInfo||B.getFrameInfo();H.borderInfo||H.getBorderInfo();H.paddingInfo||H.getPaddingInfo();if(!B.frameBorder){if(!(A=B.framing)){B.frameBorder=B.borderInfo;B.framePadding=B.paddingInfo}else{B.frameBorder=A.border;B.framePadding=A.padding}}K=!F&&J.createAxis(B,E.contentWidth,B.widthModel,J.horzAxisProps,B.collapsedHorz);I=!L&&J.createAxis(B,E.contentHeight,B.heightModel,J.vertAxisProps,B.collapsedVert);for(C=0,D=B.dockedItems.length;D--;++C){if(K){J.dockChild(B,K,D,C)}if(I){J.dockChild(B,I,D,C)}}if(K&&J.finishAxis(B,K)){G.horzDone=F=K}if(I&&J.finishAxis(B,I)){G.vertDone=L=I}if(F&&L&&J.finishConstraints(B,F,L)){J.finishPositions(B,F,L)}else{J.done=false}},createAxis:function(O,N,D,Q,F){var H=this,T=0,P=H.owner,R=P[Q.maxSize],J=P[Q.minSize]||0,I=Q.dockBegin,M=Q.dockEnd,B=Q.pos,K=Q.size,A=R!=null,G=D.shrinkWrap,E,C,L,S;if(G){if(F){S=0}else{E=O.bodyContext;S=N+E.borderInfo[K]}}else{C=O.frameBorder;L=O.framePadding;T=C[I]+L[I];S=O.getProp(K)-(C[M]+L[M])}return{shrinkWrap:D.shrinkWrap,sizeModel:D,initialBegin:T,begin:T,end:S,collapsed:F,horizontal:Q.horizontal,ignoreFrameBegin:null,ignoreFrameEnd:null,initialSize:S-T,maxChildSize:0,hasMinMaxConstraints:(J||A)&&D.shrinkWrap,minSize:J,maxSize:A?R:1000000000,bodyPosProp:H.owner.manageHeight?B:Q.marginBegin,dockBegin:I,dockEnd:M,posProp:B,sizeProp:K,setSize:Q.setSize,shrinkWrapDock:O[Q.shrinkWrapDock],sizeModelName:Q.sizeModel,dockedPixelsEnd:0}},dockChild:function(A,B,D,F){var H=this,C=A.dockedItems[B.shrinkWrap?D:F],K=C.target,I=K.dock,J=B.sizeProp,G,E;if(K.ignoreParentFrame&&A.isCollapsingOrExpanding){C.clearMarginCache()}C.marginInfo||C.getMarginInfo();if(I==B.dockBegin){if(B.shrinkWrap){G=H.dockOutwardBegin(A,C,K,B)}else{G=H.dockInwardBegin(A,C,K,B)}}else{if(I==B.dockEnd){if(B.shrinkWrap){G=H.dockOutwardEnd(A,C,K,B)}else{G=H.dockInwardEnd(A,C,K,B)}}else{if(B.shrinkWrapDock){E=C.getProp(J)+C.marginInfo[J];B.maxChildSize=Math.max(B.maxChildSize,E);G=0}else{G=H.dockStretch(A,C,K,B)}}}C.dockedAt[B.posProp]=G},dockInwardBegin:function(A,C,J,B){var F=B.begin,I=B.sizeProp,E=J.ignoreParentFrame,G,D,H;if(E){B.ignoreFrameBegin=C;H=J.dock;G=A.frameBorder[H];F-=G+A.framePadding[H]}if(!J.overlay){D=C.getProp(I)+C.marginInfo[I];B.begin+=D;if(E){B.begin-=G}}return F},dockInwardEnd:function(A,C,H,B){var G=B.sizeProp,E=C.getProp(G)+C.marginInfo[G],F=B.end-E,D;if(!H.overlay){B.end=F}if(H.ignoreParentFrame){B.ignoreFrameEnd=C;D=A.frameBorder[H.dock];F+=D+A.framePadding[H.dock];B.end+=D}return F},dockOutwardBegin:function(E,B,D,G){var C=G.begin,F=G.sizeProp,A;if(G.collapsed){G.ignoreFrameBegin=G.ignoreFrameEnd=B}else{if(D.ignoreParentFrame){G.ignoreFrameBegin=B}}if(!D.overlay){A=B.getProp(F)+B.marginInfo[F];C-=A;G.begin=C}return C},dockOutwardEnd:function(E,B,D,G){var C=G.end,F=G.sizeProp,A;A=B.getProp(F)+B.marginInfo[F];if(G.collapsed){G.ignoreFrameBegin=G.ignoreFrameEnd=B}else{if(D.ignoreParentFrame){G.ignoreFrameEnd=B}}if(!D.overlay){G.end=C+A;G.dockedPixelsEnd+=A}return C},dockStretch:function(B,D,O,C){var L=O.dock,N=C.sizeProp,K=L=="top"||L=="bottom",M=B.frameBorder,G=D.offsets,J=B.framePadding,E=K?"right":"bottom",I=K?"left":"top",H=C.begin+G[I],A,F;if(O.stretch!==false){F=C.end-H-G[E];if(O.ignoreParentFrame){H-=J[I]+M[I];F+=J[N]+M[N]}A=D.marginInfo;F-=A[N];D[C.setSize](F)}return H},finishAxis:function(S,T){if(isNaN(T.maxChildSize)){return false}var U=T.begin,F=T.end-U,D=T.collapsed,B=T.setSize,W=T.dockBegin,G=T.dockEnd,O=S.framePadding,I=S.frameBorder,M=I[W],A=S.framing,R=A&&A[W],N=D?0:O[W],K=T.sizeProp,J=T.ignoreFrameBegin,H=T.ignoreFrameEnd,E=S.bodyContext,P=Math.max(M+N-R,0),C,V,L,Q;if(T.shrinkWrap){V=T.initialSize;if(A){L=-U+M+N;C=L-R-P}else{C=-U;L=C+N}if(!D){F+=O[K]}if(J){L-=M;C-=M;J.dockedAt[T.posProp]-=N}else{F+=M}if(D){}else{if(H){H.dockedAt[T.posProp]+=O[G]}else{F+=I[G]}}T.size=F;if(!T.horizontal&&!this.owner.manageHeight){Q=false}}else{if(A){L=0;C=U-R-P}else{L=-M;C=U-N-M}V=F}T.delta=L;E[B](V,Q);E.setProp(T.bodyPosProp,C);return !isNaN(F)},beforeInvalidateShrinkWrapDock:function(B,C){var A=C.axis.sizeModelName;if(!B[A].constrainedMin){B[A]=Ext.layout.SizeModel.calculated}},afterInvalidateShrinkWrapDock:function(A,C){var E=C.axis,D=C.layout,B;if(A[E.sizeModelName].calculated){B=D.dockStretch(C.ownerContext,A,A.target,E);A.setProp(E.posProp,E.delta+B)}},finishConstraints:function(M,F,J){var A=this,B=A.sizeModels,R=F.shrinkWrap,G=J.shrinkWrap,N=A.owner,K,Q,L,I,E,D,H,P,C,O;if(R){D=F.size;H=F.collapsed?0:F.minSize;P=F.maxSize;C=F.maxChildSize;O=Math.max(D,C);if(O>P){E=B.constrainedMax;L=P}else{if(O<H){E=B.constrainedMin;L=H}else{if(D<C){E=B.constrainedDock;N.dockConstrainedWidth=L=C}else{L=D}}}}if(G){D=J.size;H=J.collapsed?0:J.minSize;P=J.maxSize;C=J.maxChildSize;O=Math.max(D,C+D-J.initialSize);if(O>P){I=B.constrainedMax;Q=P}else{if(O<H){I=B.constrainedMin;Q=H}else{if(D<C){I=B.constrainedDock;N.dockConstrainedHeight=Q=C}else{if(!M.collapsedVert&&!N.manageHeight){K=false;M.bodyContext.setProp("margin-bottom",J.dockedPixelsEnd)}Q=D}}}}if(E||I){if(E&&I&&E.constrainedMax&&I.constrainedByMin){M.invalidate({widthModel:E});return false}if(!M.widthModel.calculatedFromShrinkWrap&&!M.heightModel.calculatedFromShrinkWrap){M.invalidate({widthModel:E,heightModel:I});return false}}else{A.invalidateAxes(M,F,J)}if(R){M.setWidth(L);if(E){M.widthModel=E}}if(G){M.setHeight(Q,K);if(I){M.heightModel=I}}return true},invalidateAxes:function(L,J,Q){var F=this.beforeInvalidateShrinkWrapDock,B=this.afterInvalidateShrinkWrapDock,P=J.end-J.begin,G=Q.initialSize,N=J.shrinkWrapDock&&J.maxChildSize<=P,D=Q.shrinkWrapDock&&Q.maxChildSize<=G,C,A,E,I,H,M,K,O;if(N||D){if(D){Q.begin=Q.initialBegin;Q.end=Q.begin+Q.initialSize}C=L.dockedItems;for(E=0,A=C.length;E<A;++E){I=C[E];M=I.horizontal;K=null;if(N&&M){O=J.sizeProp;H=P;K=J}else{if(D&&!M){O=Q.sizeProp;H=G;K=Q}}if(K){H-=I.getMarginInfo()[O];if(H!==I.props[O]){I.invalidate({before:F,after:B,axis:K,ownerContext:L,layout:this})}}}}},finishPositions:function(A,H,F){var D=A.dockedItems,E=D.length,I=H.delta,G=F.delta,C,B;for(C=0;C<E;++C){B=D[C];B.setProp("x",I+B.dockedAt.x);B.setProp("y",G+B.dockedAt.y)}},finishedLayout:function(B){var A=this,C=B.target;A.callParent(arguments);if(!B.animatePolicy){if(B.isCollapsingOrExpanding===1){C.afterCollapse(false)}else{if(B.isCollapsingOrExpanding===2){C.afterExpand(false)}}}},getAnimatePolicy:function(C){var B=this,D,A;if(C.isCollapsingOrExpanding==1){D=B.lastCollapsedState}else{if(C.isCollapsingOrExpanding==2){D=C.lastCollapsedState}}if(D=="left"||D=="right"){A=B.horizontalCollapsePolicy}else{if(D=="top"||D=="bottom"){A=B.verticalCollapsePolicy}}return A},getDockedItems:function(H,L){var A=this,I=(H==="visual"),C=I?Ext.ComponentQuery.query("[rendered]",A.owner.dockedItems.items):A.owner.dockedItems.items,K=C&&C.length&&H!==false,G,J,D,F,B,E;if(L==null){D=K&&!I?C.slice():C}else{D=[];for(F=0,E=C.length;F<E;++F){J=C[F].dock;B=(J=="top"||J=="left");if(L?B:!B){D.push(C[F])}}K=K&&D.length}if(K){G=(H=H||"render")=="render";Ext.Array.sort(D,function(P,N){var O,M;if(G&&((O=A.owner.dockOrder[P.dock])!==(M=A.owner.dockOrder[N.dock]))){if(!(O+M)){return O-M}}O=A.getItemWeight(P,H);M=A.getItemWeight(N,H);if((O!==undefined)&&(M!==undefined)){return O-M}return 0})}return D||[]},getItemWeight:function(B,C){var A=B.weight||this.owner.defaultDockWeights[B.dock];return A[C]||A},getLayoutItems:function(){var E=this,F,A,D,B,C;if(E.owner.collapsed){C=E.owner.getCollapsedDockedItems()}else{F=E.getDockedItems("visual");A=F.length;C=[];for(B=0;B<A;B++){D=F[B];if(!D.hidden){C.push(D)}}}return C},measureContentWidth:function(A){var B=A.bodyContext;return B.el.getWidth()-B.getBorderInfo().width},measureContentHeight:function(A){var B=A.bodyContext;return B.el.getHeight()-B.getBorderInfo().height},redoLayout:function(B){var A=this,C=A.owner;if(B.isCollapsingOrExpanding==1){if(C.reExpander){C.reExpander.el.show()}C.addClsWithUI(C.collapsedCls);B.redo(true)}else{if(B.isCollapsingOrExpanding==2){C.removeClsWithUI(C.collapsedCls);B.bodyContext.redo()}}},renderChildren:function(){var A=this,B=A.getDockedItems(),C=A.getRenderTarget();A.handleItemBorders();A.renderItems(B,C)},renderItems:function(L,K){var A=this,C=L.length,G=0,J=0,F=0,B=A.getRenderTarget().dom.childNodes,I=B.length,H,E,D,M;for(H=0,E=0;H<I;H++){D=B[H];if(D.nodeType===1&&Ext.fly(D).hasCls(Ext.baseCSSPrefix+"resizable-handle")){break}for(E=0;E<C;E++){M=L[E];if(M.rendered&&M.el.dom===D){break}}if(E===C){F++}}for(;G<C;G++,J++){M=L[G];if(G===J&&(M.dock==="right"||M.dock==="bottom")){J+=F}if(M&&!M.rendered){A.renderItem(M,K,J)}else{if(!A.isValidParent(M,K,J)){A.moveItem(M,K,J)}}}},undoLayout:function(B){var A=this,C=A.owner;if(B.isCollapsingOrExpanding==1){if(C.reExpander){C.reExpander.el.hide()}C.removeClsWithUI(C.collapsedCls);B.undo(true)}else{if(B.isCollapsingOrExpanding==2){C.addClsWithUI(C.collapsedCls);B.bodyContext.undo()}}},sizePolicy:{nostretch:{setsWidth:0,setsHeight:0},horz:{shrinkWrap:{setsWidth:1,setsHeight:0,readsWidth:1},stretch:{setsWidth:1,setsHeight:0}},vert:{shrinkWrap:{setsWidth:0,setsHeight:1,readsHeight:1},stretch:{setsWidth:0,setsHeight:1}},stretchV:{setsWidth:0,setsHeight:1},autoStretchH:{readsWidth:1,setsWidth:1,setsHeight:0},autoStretchV:{readsHeight:1,setsWidth:0,setsHeight:1}},getItemSizePolicy:function(E,C){var A=this,D=A.sizePolicy,B=A.owner.shrinkWrapDock,F,G;if(E.stretch===false){return D.nostretch}F=E.dock;G=(F=="left"||F=="right");B=B===true?3:(B||0);if(G){D=D.vert;B=B&1}else{D=D.horz;B=B&2}if(B){if(!C){C=A.owner.getSizeModel()}if(C[G?"height":"width"].shrinkWrap){return D.shrinkWrap}}return D.stretch},configureItem:function(B,A){this.callParent(arguments);B.addCls(this._itemCls);if(!B.ignoreBorderManagement){B.addClsWithUI(this.getDockCls(B.dock))}},getDockCls:function(A){return"docked-"+A},afterRemove:function(B){var A;this.callParent(arguments);B.removeCls(this._itemCls);if(!B.ignoreBorderManagement){B.removeClsWithUI(this.getDockCls(B.dock))}A=B.el.dom;if(!B.destroying&&A){A.parentNode.removeChild(A)}this.childrenChanged=true},borderCollapseMap:{},getBorderCollapseTable:function(){var C=this,B=C.borderCollapseMap,E=C.owner,A=E.baseCls,F=E.ui,D;B=B[A]||(B[A]={});D=B[F];if(!D){A+="-"+F+"-outer-border-";B[F]=D=[0,A+"l",A+"b",A+"bl",A+"r",A+"rl",A+"rb",A+"rbl",A+"t",A+"tl",A+"tb",A+"tbl",A+"tr",A+"trl",A+"trb",A+"trbl"]}return D}});
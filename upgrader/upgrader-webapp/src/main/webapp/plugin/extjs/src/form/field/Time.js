Ext.define("Ext.form.field.Time",{extend:"Ext.form.field.ComboBox",alias:"widget.timefield",requires:["Ext.form.field.Date","Ext.picker.Time","Ext.view.BoundListKeyNav","Ext.Date"],alternateClassName:["Ext.form.TimeField","Ext.form.Time"],triggerCls:Ext.baseCSSPrefix+"form-time-trigger",minText:"The time in this field must be equal to or after {0}",maxText:"The time in this field must be equal to or before {0}",invalidText:"{0} is not a valid time",format:"g:i A",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|gi a|hi a|giA|hiA|gi A|hi A",increment:15,pickerMaxHeight:300,selectOnTab:true,snapToIncrement:false,initDate:"1/1/2008",initDateParts:[2008,0,1],initDateFormat:"j/n/Y",ignoreSelection:0,queryMode:"local",displayField:"disp",valueField:"date",initComponent:function(){var B=this,A=B.minValue,C=B.maxValue;if(A){B.setMinValue(A)}if(C){B.setMaxValue(C)}B.store=B.getPicker().store;B.displayTpl=new Ext.XTemplate('<tpl for=".">{[typeof values === "string" ? values : this.formatDate(values["'+B.displayField+'"])]}<tpl if="xindex < xcount">'+B.delimiter+"</tpl></tpl>",{formatDate:B.formatDate.bind(B)});B.callParent()},isEqual:function(E,F){var C=Ext.Array.from,B=Ext.Date.isEqual,A,D;E=C(E);F=C(F);D=E.length;if(D!==F.length){return false}for(A=0;A<D;A++){if(!B(F[A],E[A])){return false}}return true},setMinValue:function(C){var A=this,B=A.picker;A.setLimit(C,true);if(B){B.setMinValue(A.minValue)}},setMaxValue:function(C){var A=this,B=A.picker;A.setLimit(C,false);if(B){B.setMaxValue(A.maxValue)}},setLimit:function(D,A){var C=this,B,E;if(Ext.isString(D)){B=C.parseDate(D)}else{if(Ext.isDate(D)){B=D}}if(B){E=C.getInitDate();E.setHours(B.getHours(),B.getMinutes(),B.getSeconds(),B.getMilliseconds())}else{E=null}C[A?"minValue":"maxValue"]=E},getInitDate:function(B,C,D){var A=this.initDateParts;return new Date(A[0],A[1],A[2],B||0,C||0,D||0,0)},valueToRaw:function(A){return this.formatDate(this.parseDate(A))},getErrors:function(D){var H=this,J=Ext.String.format,K=H.callParent(arguments),F=H.minValue,C=H.maxValue,A=H.displayTplData,B=H.getRawValue(),E,I,L,G;if(A&&A.length>0){for(E=0,I=A.length;E<I;E++){G=A[E];G=G.date||G.disp;L=H.parseDate(G);if(!L){K.push(J(H.invalidText,G,Ext.Date.unescapeFormat(H.format)));continue}if(F&&L<F){K.push(J(H.minText,H.formatDate(F)))}if(C&&L>C){K.push(J(H.maxText,H.formatDate(C)))}}}else{if(B.length&&!H.parseDate(B)){K.push(J(H.invalidText,B,Ext.Date.unescapeFormat(H.format)))}}return K},formatDate:function(D){var A=[],B,C;D=Ext.Array.from(D);for(B=0,C=D.length;B<C;B++){A.push(Ext.form.field.Date.prototype.formatDate.call(this,D[B]))}return A.join(this.delimiter)},parseDate:function(F){var D=this,G=F,A=D.altFormats,B=D.altFormatsArray,C=0,E;if(F&&!Ext.isDate(F)){G=D.safeParse(F,D.format);if(!G&&A){B=B||A.split("|");E=B.length;for(;C<E&&!G;++C){G=D.safeParse(F,B[C])}}}if(G&&D.snapToIncrement){G=new Date(Ext.Number.snap(G.getTime(),D.increment*60*1000))}return G},safeParse:function(E,B){var D=this,A=Ext.Date,F,C=null;if(A.formatContainsDateInfo(B)){C=A.parse(E,B)}else{F=A.parse(D.initDate+" "+E,D.initDateFormat+" "+B);if(F){C=F}}return C},getSubmitValue:function(){var B=this,A=B.submitFormat||B.format,C=B.getValue();return C?Ext.Date.format(C,A):null},createPicker:function(){var A=this,B;A.listConfig=Ext.apply({xtype:"timepicker",selModel:{mode:A.multiSelect?"SIMPLE":"SINGLE"},cls:undefined,minValue:A.minValue,maxValue:A.maxValue,increment:A.increment,format:A.format,maxHeight:A.pickerMaxHeight},A.listConfig);B=A.callParent();return B},onItemClick:function(C,B){var A=this,D=C.getSelectionModel().getSelection();if(!A.multiSelect&&D.length){if(D.length>0){D=D[0];if(D&&Ext.Date.isEqual(B.get("date"),D.get("date"))){A.collapse()}}}},syncSelection:function(){var L=this,C=L.picker,B=Ext.Date.isEqual,G=[],A,H,J,I,M,N,E,F,D,K;if(C){C.clearHighlight();H=L.getValue();A=C.getSelectionModel();L.ignoreSelection++;if(H===null){A.deselectAll()}else{J=Ext.Array.from(H);E=C.store.data.items;D=E.length;for(I=0,M=J.length;I<M;I++){N=J[I];if(Ext.isDate(N)){for(F=0;F<D;F++){K=E[F];if(B(K.get("date"),N)){G.push(K);if(!L.multiSelect){break}}}if(G.length){A.select(G)}}}}L.ignoreSelection--}},postBlur:function(){var A=this,B=A.getValue();A.callParent(arguments);if(A.validateValue(B)){A.setValue(B)}},findRecordByValue:function(A){if(typeof A==="string"){A=this.parseDate(A)}return this.callParent([A])},rawToValue:function(C){var A=this,E,F,B,D;if(A.multiSelect){F=[];E=Ext.Array.from(C);for(B=0,D=E.length;B<D;B++){F.push(A.parseDate(E[B]))}return F}return A.parseDate(C)},setValue:function(A){this.getPicker();if(Ext.isDate(A)){A=this.getInitDate(A.getHours(),A.getMinutes(),A.getSeconds())}return this.callParent([A])},getValue:function(){return this.rawToValue(this.callParent(arguments))}});
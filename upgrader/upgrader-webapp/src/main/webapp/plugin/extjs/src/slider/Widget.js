Ext.define("Ext.slider.Widget",{extend:"Ext.Widget",alias:"widget.sliderwidget",requires:["Ext.slider.Multi"],cachedConfig:{vertical:false},config:{clickToChange:true,ui:"widget",value:0,minValue:0,maxValue:100,publishOnComplete:true,twoWayBindable:{value:1}},decimalPrecision:0,defaultBindProperty:"value",element:{reference:"element",cls:Ext.baseCSSPrefix+"slider",listeners:{mousedown:"onMouseDown",dragstart:"cancelDrag",drag:"cancelDrag",dragend:"cancelDrag"},children:[{reference:"endEl",cls:Ext.baseCSSPrefix+"slider-end",children:[{reference:"innerEl",cls:Ext.baseCSSPrefix+"slider-inner"}]}]},thumbCls:Ext.baseCSSPrefix+"slider-thumb",horizontalProp:"left",animateOnSetValue:undefined,applyValue:function(E){var C=this,B=C.animateOnSetValue,A,D;if(Ext.isArray(E)){E=Ext.Array.from(E);for(A=0,D=E.length;A<D;++A){C.setThumbValue(A,E[A]=C.normalizeValue(E[A]),B,true)}}else{E=C.normalizeValue(E);C.setThumbValue(0,E,B,true)}return E},updateVertical:function(B,A){this.element.removeCls(Ext.baseCSSPrefix+"slider-"+(A?"vert":"horz"));this.element.addCls(Ext.baseCSSPrefix+"slider-"+(B?"vert":"horz"))},doSetHeight:function(A){this.callParent(arguments);this.endEl.dom.style.height=this.innerEl.dom.style.height="100%"},cancelDrag:function(A){A.stopPropagation()},getThumb:function(C){var B=this,D,A=(B.thumbs||(B.thumbs=[]))[C];if(!A){D={cls:B.thumbCls,style:{}};D["data-thumbIndex"]=C;A=B.thumbs[C]=B.innerEl.createChild(D)}return A},getThumbPositionStyle:function(){return this.getVertical()?"bottom":(this.rtl&&Ext.rtl?"right":"left")},update:function(){var B=this,D=B.getValue(),C=D.length,A;for(A=0;A<C;A++){this.thumbs[A].dom.style[B.getThumbPositionStyle()]=B.calculateThumbPosition(D[A])+"%"}},onMouseDown:function(B){var D=this,C,E=B.getXY(),A;if(!D.disabled&&B.button===0){C=B.getTarget("."+D.thumbCls,null,true);if(C){D.animateOnSetValue=false;D.promoteThumb(C);D.captureMouse(D.onMouseMove,D.onMouseUp,[C],1);A=D.pointerOffset=C.getXY();A[0]+=Math.floor(C.getWidth()/2)-E[0];A[1]+=Math.floor(C.getHeight()/2)-E[1]}else{if(D.getClickToChange()){E=D.getTrackpoint(E);if(E!=null){D.onClickChange(E)}}}}},onClickChange:function(E){var C=this,B,D,A;B=C.getNearest(E);D=parseInt(B.getAttribute("data-thumbIndex"),10);A=Ext.util.Format.round(C.reversePixelValue(E),C.decimalPrecision);if(D){C.setThumbValue(D,A,undefined,true)}else{C.setValue(A)}},getNearest:function(B){var I=this,C=I.reversePixelValue(B),G=I.getRange()+5,D=null,A=I.thumbs,F=0,J=A.length,K,E,H;for(;F<J;F++){K=A[F];E=I.reversePercentageValue(parseInt(K.dom.style[I.getThumbPositionStyle()],10));H=Math.abs(E-C);if(Math.abs(H)<=G){D=K;G=H}}return D},promoteThumb:function(C){var D=this.thumbStack||(this.thumbStack=Ext.Array.slice(this.thumbs)),E=D.length,B=10000,A;if(D[0]!==C){Ext.Array.remove(D,C);D.unshift(C)}for(A=0;A<E;A++){D[A].el.setStyle("zIndex",B);B-=1000}},doMouseMove:function(C,H,E){var A=this,F=C.getXY(),D,G,B;F[0]+=A.pointerOffset[0];F[1]+=A.pointerOffset[1];B=A.getTrackpoint(F);if(B){D=A.reversePixelValue(B);G=parseInt(H.getAttribute("data-thumbIndex"),10);if(G||(!E&&A.getPublishOnComplete())){A.setThumbValue(G,D,false,E)}else{A.setValue(D)}}},onMouseMove:function(A,B){this.doMouseMove(A,B,false)},onMouseUp:function(A,B){this.doMouseMove(A,B,true);delete this.animateOnSetValue},setThumbValue:function(A,D,B,G){var H=this,J,C,I,E,F;if(Ext.isArray(A)){F=A;B=D;for(E=0,I=F.length;E<I;++E){H.setThumbValue(E,F[E],B,G)}return H}J=H.getThumb(A);C=H.reversePercentageValue(parseInt(J.dom.style[H.getThumbPositionStyle()],10));D=H.normalizeValue(D);if(D!==C&&H.fireEvent("beforechange",H,D,C,J)!==false){if(H.element.dom){H.element.set({"aria-valuenow":D,"aria-valuetext":D});H.moveThumb(J,H.calculateThumbPosition(D),Ext.isDefined(B)?B!==false:H.animate);H.fireEvent("change",H,D,J)}}return H},getValue:function(C){var B=this,A;if(Ext.isNumber(C)){A=B.thumbs[C].dom.style[B.getThumbPositionStyle()];A=B.reversePercentageValue(parseInt(A,10))}else{A=B.getValues();if(A.length===1){A=A[0]}}return A},getValues:function(){var B=this,E=[],A=0,D=B.thumbs,C=D.length;for(;A<C;A++){E.push(B.reversePercentageValue(parseInt(B.thumbs[A].dom.style[B.getThumbPositionStyle()],10)))}return E},moveThumb:function(D,E,C){var A=this,G=A.getThumbPositionStyle(),F,B;E+="%";if(!C){D.dom.style[G]=E}else{F={};F[G]=E;if(!Ext.supports.GetPositionPercentage){B={};B[G]=D.dom.style[G]}new Ext.fx.Anim({target:D,duration:350,from:B,to:F})}},normalizeValue:function(B){var A=this,C=A.zeroBasedSnapping?"snap":"snapInRange";B=Ext.Number[C](B,A.increment,A.minValue,A.maxValue);B=Ext.util.Format.round(B,A.decimalPrecision);B=Ext.Number.constrain(B,A.minValue,A.maxValue);return B},getTrackpoint:function(A){var D=this,E=D.getVertical(),G=D.innerEl,F,B,C;if(E){C="top";F=G.getHeight()}else{C="left";F=G.getWidth()}A=D.transformTrackPoints(G.translatePoints(A));B=Ext.Number.constrain(A[C],0,F);return E?F-B:B},transformTrackPoints:Ext.identityFn,calculateThumbPosition:function(C){var A=this,B=(C-A.getMinValue())/A.getRange()*100;if(isNaN(B)){B=0}return B},getRatio:function(){var A=this,D=A.innerEl,B=A.getVertical()?D.getHeight():D.getWidth(),C=A.getRange();return C===0?B:(B/C)},getRange:function(){return this.getMaxValue()-this.getMinValue()},reversePixelValue:function(A){return this.getMinValue()+(A/this.getRatio())},reversePercentageValue:function(A){return this.getMinValue()+this.getRange()*(A/100)},captureMouse:function(F,B,G,C){var E=this,D,A;F=F&&Ext.Function.bind(F,E,G,C);B=B&&Ext.Function.bind(B,E,G,C);D=function(){Ext.getDoc().un(A);if(B){B.apply(E,arguments)}};A={mousemove:F,mouseup:D};Ext.getDoc().on(A)}});
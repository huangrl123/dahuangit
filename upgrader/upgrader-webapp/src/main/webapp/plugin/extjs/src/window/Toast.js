Ext.define("Ext.window.Toast",{extend:"Ext.window.Window",xtype:"toast",cls:Ext.baseCSSPrefix+"toast",bodyPadding:10,autoClose:true,plain:false,draggable:false,resizable:false,shadow:false,focus:Ext.emptyFn,anchor:null,useXAxis:false,align:"br",spacing:6,paddingX:30,paddingY:10,slideInAnimation:"easeIn",slideBackAnimation:"bounceOut",slideInDuration:1500,slideBackDuration:1000,hideDuration:500,autoCloseDelay:3000,stickOnClick:true,stickWhileHover:true,closeOnMouseDown:false,isHiding:false,isFading:false,destroyAfterHide:false,closeOnMouseOut:false,xPos:0,yPos:0,initComponent:function(){var A=this;A.updateAlignment(A.align);A.setAnchor(A.anchor);A.callParent(arguments)},onRender:function(){var A=this;A.callParent(arguments);A.el.hover(A.onMouseEnter,A.onMouseLeave,A);if(A.closeOnMouseDown){A.mon(Ext,"mousedown",A.onDocumentMousedown,A)}},alignmentProps:{br:{paddingFactorX:-1,paddingFactorY:-1,siblingAlignment:"br-br",anchorAlign:"tr-br"},bl:{paddingFactorX:1,paddingFactorY:-1,siblingAlignment:"bl-bl",anchorAlign:"tl-bl"},tr:{paddingFactorX:-1,paddingFactorY:1,siblingAlignment:"tr-tr",anchorAlign:"br-tr"},tl:{paddingFactorX:1,paddingFactorY:1,siblingAlignment:"tl-tl",anchorAlign:"bl-tl"},b:{paddingFactorX:0,paddingFactorY:-1,siblingAlignment:"b-b",useXAxis:0,anchorAlign:"t-b"},t:{paddingFactorX:0,paddingFactorY:1,siblingAlignment:"t-t",useXAxis:0,anchorAlign:"b-t"},l:{paddingFactorX:1,paddingFactorY:0,siblingAlignment:"l-l",useXAxis:1,anchorAlign:"r-l"},r:{paddingFactorX:-1,paddingFactorY:0,siblingAlignment:"r-r",useXAxis:1,anchorAlign:"l-r"},x:{br:{anchorAlign:"bl-br"},bl:{anchorAlign:"br-bl"},tr:{anchorAlign:"tl-tr"},tl:{anchorAlign:"tr-tl"}}},updateAlignment:function(B){var A=this,C=A.alignmentProps,D=C[B],E=C.x[B];if(E&&A.useXAxis){Ext.applyIf(A,E)}Ext.applyIf(A,D)},getXposAlignedToAnchor:function(){var C=this,E=C.align,B=C.anchor,F=B&&B.el,A=C.el,D=0;if(F&&F.dom){if(!C.useXAxis){D=A.getLeft()}else{if(E==="br"||E==="tr"||E==="r"){D+=F.getAnchorXY("r")[0];D-=(A.getWidth()+C.paddingX)}else{D+=F.getAnchorXY("l")[0];D+=C.paddingX}}}return D},getYposAlignedToAnchor:function(){var C=this,E=C.align,B=C.anchor,F=B&&B.el,A=C.el,D=0;if(F&&F.dom){if(C.useXAxis){D=A.getTop()}else{if(E==="br"||E==="bl"||E==="b"){D+=F.getAnchorXY("b")[1];D-=(A.getHeight()+C.paddingY)}else{D+=F.getAnchorXY("t")[1];D+=C.paddingY}}}return D},getXposAlignedToSibling:function(C){var D=this,E=D.align,A=D.el,B;if(!D.useXAxis){B=A.getLeft()}else{if(E==="tl"||E==="bl"||E==="l"){B=(C.xPos+C.el.getWidth()+C.spacing)}else{B=(C.xPos-A.getWidth()-D.spacing)}}return B},getYposAlignedToSibling:function(C){var D=this,E=D.align,A=D.el,B;if(D.useXAxis){B=A.getTop()}else{if(E==="tr"||E==="tl"||E==="t"){B=(C.yPos+C.el.getHeight()+C.spacing)}else{B=(C.yPos-A.getHeight()-C.spacing)}}return B},getToasts:function(){var C=this.anchor,A=this.anchorAlign,B=C.activeToasts||(C.activeToasts={});return B[A]||(B[A]=[])},setAnchor:function(C){var B=this,A;B.anchor=C=((typeof C==="string")?Ext.getCmp(C):C);if(!C){A=Ext.window.Toast;B.anchor=A.bodyAnchor||(A.bodyAnchor={el:Ext.getBody()})}},beforeShow:function(){var A=this;if(A.stickOnClick){A.body.on("click",function(){A.cancelAutoClose()})}if(A.autoClose){if(!A.closeTask){A.closeTask=new Ext.util.DelayedTask(A.doAutoClose,A)}A.closeTask.delay(A.autoCloseDelay)}A.el.setX(-10000);A.el.setOpacity(1)},afterShow:function(){var E=this,A=E.el,F,D,B,C;E.callParent(arguments);F=E.getToasts();B=F.length;D=B&&F[B-1];if(D){A.alignTo(D.el,E.siblingAlignment,[0,0]);E.xPos=E.getXposAlignedToSibling(D);E.yPos=E.getYposAlignedToSibling(D)}else{A.alignTo(E.anchor.el,E.anchorAlign,[(E.paddingX*E.paddingFactorX),(E.paddingY*E.paddingFactorY)],false);E.xPos=E.getXposAlignedToAnchor();E.yPos=E.getYposAlignedToAnchor()}Ext.Array.include(F,E);C=A.getXY();A.animate({from:{x:C[0],y:C[1]},to:{x:E.xPos,y:E.yPos,opacity:1},easing:E.slideInAnimation,duration:E.slideInDuration,dynamic:true})},onDocumentMousedown:function(A){if(this.isVisible()&&!this.owns(A.getTarget())){this.hide()}},slideBack:function(){var B=this,E=B.anchor,F=E&&E.el,A=B.el,D=B.getToasts(),C=Ext.Array.indexOf(D,B);if(!B.isHiding&&A&&A.dom&&F&&F.isVisible()){if(C){B.xPos=B.getXposAlignedToSibling(D[C-1]);B.yPos=B.getYposAlignedToSibling(D[C-1])}else{B.xPos=B.getXposAlignedToAnchor();B.yPos=B.getYposAlignedToAnchor()}B.stopAnimation();A.animate({to:{x:B.xPos,y:B.yPos},easing:B.slideBackAnimation,duration:B.slideBackDuration,dynamic:true})}},update:function(){var A=this;if(A.isVisible()){A.isHiding=true;A.hide()}A.callParent(arguments);A.show()},cancelAutoClose:function(){var A=this.closeTask;if(A){A.cancel()}},doAutoClose:function(){var A=this;if(!(A.stickWhileHover&&A.mouseIsOver)){A.close()}else{A.closeOnMouseOut=true}},onMouseEnter:function(){this.mouseIsOver=true},onMouseLeave:function(){var A=this;A.mouseIsOver=false;if(A.closeOnMouseOut){A.closeOnMouseOut=false;A.close()}},removeFromAnchor:function(){var A=this,C,B;if(A.anchor){C=A.getToasts();B=Ext.Array.indexOf(C,A);if(B!==-1){Ext.Array.erase(C,B,1);for(;B<C.length;B++){C[B].slideBack()}}}},hide:function(){var B=this,A=B.el;B.cancelAutoClose();if(B.isHiding){if(!B.isFading){B.callParent(arguments);B.removeFromAnchor();B.isHiding=false}}else{B.isHiding=true;B.isFading=true;B.cancelAutoClose();if(A){A.fadeOut({opacity:0,easing:"easeIn",duration:B.hideDuration,listeners:{afteranimate:function(){B.isFading=false;B.hide(B.animateTarget,B.doClose,B)}}})}}return B}},function(A){Ext.toast=function(G,E,D,B){var C=G,F;if(Ext.isString(G)){C={title:E,html:G,iconCls:B};if(D){C.align=D}}F=new A(C);F.show();return F}});
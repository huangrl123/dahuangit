Ext.define("Ext.selection.CheckboxModel",{alias:"selection.checkboxmodel",extend:"Ext.selection.RowModel",mode:"MULTI",injectCheckbox:0,checkOnly:false,showHeaderCheckbox:undefined,checkSelector:"."+Ext.baseCSSPrefix+"grid-row-checker",headerWidth:24,checkerOnCls:Ext.baseCSSPrefix+"grid-hd-checker-on",tdCls:Ext.baseCSSPrefix+"grid-cell-special "+Ext.baseCSSPrefix+"grid-cell-row-checker",constructor:function(){var A=this;A.callParent(arguments);if(A.mode==="SINGLE"&&A.showHeaderCheckbox!==true){A.showHeaderCheckbox=false}},beforeViewRender:function(B){var A=this,C;A.callParent(arguments);if(!A.hasLockedHeader()||B.headerCt.lockedCt){if(A.showHeaderCheckbox!==false){B.headerCt.on("headerclick",A.onHeaderClick,A)}A.addCheckbox(B,true);C=B.ownerCt;if(B.headerCt.lockedCt){C=C.ownerCt}A.mon(C,"reconfigure",A.onReconfigure,A)}},bindComponent:function(B){var A=this;A.sortable=false;A.callParent(arguments)},hasLockedHeader:function(){var A=this.views,C=A.length,B;for(B=0;B<C;B++){if(A[B].headerCt.lockedCt){return true}}return false},addCheckbox:function(C,B){var A=this,E=A.injectCheckbox,D=C.headerCt;if(E!==false){if(E==="first"){E=0}else{if(E==="last"){E=D.getColumnCount()}}Ext.suspendLayouts();if(C.getStore().isBufferedStore){A.showHeaderCheckbox=false}D.add(E,A.getHeaderConfig());Ext.resumeLayouts()}if(B!==true){C.refresh()}},onReconfigure:function(C,A,B){if(B){this.addCheckbox(this.views[0])}},toggleUiHeader:function(C){var E=this.views[0],D=E.headerCt,A=D.child("gridcolumn[isCheckerHd]"),B=this.checkerOnCls;if(A){if(C){A.addCls(B)}else{A.removeCls(B)}}},onHeaderClick:function(D,C,B){if(C.isCheckerHd){B.stopEvent();var A=this,E=C.el.hasCls(Ext.baseCSSPrefix+"grid-hd-checker-on");A.preventFocus=true;if(E){A.deselectAll()}else{A.selectAll()}delete A.preventFocus}},getHeaderConfig:function(){var B=this,A=B.showHeaderCheckbox!==false;return{isCheckerHd:A,text:"&#160;",clickTargetName:"el",width:B.headerWidth,sortable:false,draggable:false,resizable:false,hideable:false,menuDisabled:true,dataIndex:"",tdCls:B.tdCls,cls:A?Ext.baseCSSPrefix+"column-header-checkbox ":"",defaultRenderer:B.renderer.bind(B),editRenderer:B.editRenderer||B.renderEmpty,locked:B.hasLockedHeader()}},renderEmpty:function(){return"&#160;"},refresh:function(){this.callParent(arguments);this.updateHeaderState()},renderer:function(F,G,D,C,E,B,A){return'<div class="'+Ext.baseCSSPrefix+'grid-row-checker" role="presentation">&#160;</div>'},processSelection:function(A,G,H,B,D){var F=this,C=D.getTarget(F.checkSelector),E;if(F.checkOnly&&!C){return}if(C){E=F.getSelectionMode();if(E!=="SINGLE"){F.setSelectionMode("SIMPLE")}F.selectWithEvent(G,D);F.setSelectionMode(E)}else{F.selectWithEvent(G,D)}},onSelectChange:function(){this.callParent(arguments);if(!this.suspendChange){this.updateHeaderState()}},onStoreLoad:function(){this.callParent(arguments);this.updateHeaderState()},onStoreAdd:function(){this.callParent(arguments);this.updateHeaderState()},onStoreRemove:function(){this.callParent(arguments);this.updateHeaderState()},onStoreRefresh:function(){this.callParent(arguments);this.updateHeaderState()},maybeFireSelectionChange:function(A){if(A&&!this.suspendChange){this.updateHeaderState()}this.callParent(arguments)},resumeChanges:function(){this.callParent();if(!this.suspendChange){this.updateHeaderState()}},updateHeaderState:function(){var F=this,B=F.store,I=B.getCount(),A=F.views,C=false,H=0,E,G,D;if(!B.isBufferedStore&&I>0){E=F.selected;C=true;for(D=0,G=E.getCount();D<G;++D){if(B.indexOfId(E.getAt(D).id)===-1){break}++H}C=I===H}if(A&&A.length){F.toggleUiHeader(C)}}});
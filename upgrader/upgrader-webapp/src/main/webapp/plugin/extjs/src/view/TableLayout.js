Ext.define("Ext.view.TableLayout",{extend:"Ext.layout.component.Auto",requires:["Ext.util.CSS"],alias:["layout.tableview"],type:"tableview",beginLayout:function(C){var B=this,A=B.owner.lockingPartner;B.callParent(arguments);if(A){B.lockedGrid=B.owner.up("[lockable]");B.lockedGrid.needsRowHeightSync=true;if(!C.lockingPartner){C.lockingPartner=C.context.getItem(A,A.el);if(C.lockingPartner&&!C.lockingPartner.lockingPartner){C.lockingPartner.lockingPartner=C}}}C.headerContext=C.context.getCmp(B.headerCt);if(B.owner.body.dom){C.bodyContext=C.getEl(B.owner.body)}},calculate:function(D){var B=this,F=B.lockingPartner,E=B.owner,C=0,A;if(!E.store.getCount()){D.state.columnWidthsSynced=true;if(D.bodyContext){D.bodyContext.setHeight(C,false)}D.setProp("contentHeight",C);B.callParent(arguments);return}if(D.headerContext.hasProp("columnsChanged")){if(D.headerContext.getProp("columnsChanged")&&!B.setColumnWidths(D)){B.done=false;return}D.state.columnWidthsSynced=true;if(D.bodyContext){A=B.owner.el.down("."+E.ownerCt.emptyCls,true);if(!A){C=D.bodyContext.el.dom.offsetHeight;D.bodyContext.setHeight(C,false)}else{C=A.offsetHeight}if(D.headerContext.state.boxPlan.tooNarrow&&D.ownerCtContext.sizeModel.height.shrinkWrap){C+=Ext.getScrollbarSize().height}D.setProp("contentHeight",C)}if(F&&!F.state.columnWidthsSynced){B.done=false}else{B.callParent(arguments)}}else{B.done=false}},measureContentHeight:function(A){var B=A.lockingPartner;if(!A.bodyContext||(A.state.columnWidthsSynced&&(!B||B.state.columnWidthsSynced))){return this.callParent(arguments)}},setColumnWidths:function(A){if(!this.owner.body.dom){return true}var I=this,B=I.owner,D=A.context,F=A.headerContext.getProp("columnsChanged"),E=I.headerCt.getVisibleGridColumns(),C,G=0,J=F.length,K,H;if(D){D.currentLayout=I}for(G=0;G<J;G++){C=E[F[G]];K=D.getCmp(C);H=K.props.width;if(isNaN(H)){K.getProp("width");return false}B.body.select(B.getColumnSizerSelector(C)).setWidth(H)}return true},finishedLayout:function(D){var B=this,C=D.headerContext.props.contentWidth,A=Ext.fly(B.owner.getNodeContainer());B.callParent(arguments);A&&A.setWidth(C);if(B.owner.refreshCounter&&B.lockedGrid&&B.lockedGrid.syncRowHeight&&B.lockedGrid.needsRowHeightSync){B.lockedGrid.syncRowHeights();B.lockedGrid.needsRowHeightSync=false}}});
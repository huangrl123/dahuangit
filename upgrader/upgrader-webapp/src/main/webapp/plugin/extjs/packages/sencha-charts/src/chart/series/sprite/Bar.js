Ext.define("Ext.chart.series.sprite.Bar",{alias:"sprite.barSeries",extend:"Ext.chart.series.sprite.StackedCartesian",inheritableStatics:{def:{processors:{minBarWidth:"number",maxBarWidth:"number",minGapWidth:"number",radius:"number",inGroupGapWidth:"number"},defaults:{minBarWidth:2,maxBarWidth:100,minGapWidth:5,inGroupGapWidth:3,radius:0}}},drawLabel:function(L,R,M,A,J){var H=this,F=H.attr,Q=H.getBoundMarker("labels")[0],G=Q.getTemplate(),D=H.labelCfg||(H.labelCfg={}),E=H.surfaceMatrix,N=F.labelOverflowPadding,B=G.attr.display,O=G.attr.orientation,I,P,C,K;C=H.getMarkerBBox("labels",J,true);D.text=L;if(!C){H.putMarker("labels",D,J);C=H.getMarkerBBox("labels",J,true)}if(!F.flipXY){D.rotationRads=-Math.PI*0.5}else{D.rotationRads=0}D.calloutVertical=!F.flipXY;switch(O){case"horizontal":D.rotationRads=0;break;case"vertical":D.rotationRads=-Math.PI*0.5;break}P=(C.width/2+N);if(M>A){P=-P}if((O==="horizontal"&&F.flipXY)||(O==="vertical"&&!F.flipXY)||!O){I=(B==="insideStart")?M+P:A-P}else{I=(B==="insideStart")?M+N*2:A-N*2}D.x=E.x(R,I);D.y=E.y(R,I);I=(B==="insideStart")?M-P:A+P;D.calloutPlaceX=E.x(R,I);D.calloutPlaceY=E.y(R,I);I=(B==="insideStart")?M:A;D.calloutStartX=E.x(R,I);D.calloutStartY=E.y(R,I);if(M>A){P=-P}if(Math.abs(A-M)<=P*2||B==="outside"){D.callout=1}else{D.callout=0}if(G.attr.renderer){K=G.attr.renderer.call(this,L,Q,D,{store:this.getStore()},J);if(typeof K==="string"){D.text=K}else{Ext.apply(D,K)}}H.putMarker("labels",D,J)},drawBar:function(G,E,J,F,B,A,H,I){var C=this.itemCfg||(this.itemCfg={}),D;C.x=F;C.y=B;C.width=A-F;C.height=H-B;C.radius=this.attr.radius;if(this.attr.renderer){D=this.attr.renderer.call(this,this,C,{store:this.getStore()},I);Ext.apply(C,D)}this.putMarker("items",C,I,!this.attr.renderer)},renderClipped:function(l,G,K,M){if(this.cleanRedraw){return}var C=this,T=C.attr,U=T.dataX,V=T.dataY,B=T.labels,a=T.dataStartY,E=T.groupCount,X=T.groupOffset-(E-1)*0.5,b=T.inGroupGapWidth,k=G.lineWidth,Q=T.matrix,R=Q.elements[0],J=Q.elements[3],c=Q.elements[4],W=l.roundPixel(Q.elements[5])-1,H=(R<0?-1:1)*R-T.minGapWidth,O=(Math.min(H,T.maxBarWidth)-b*(E-1))/E,N=l.roundPixel(Math.max(T.minBarWidth,O)),Y=this.surfaceMatrix,f,F,e,L,h,P,I=0.5*T.lineWidth,Z=Math.min(K[0],K[2]),j=Math.max(K[0],K[2]),S=Math.max(0,Math.floor(Z)),A=Math.min(U.length-1,Math.ceil(j)),D=B&&this.getBoundMarker("labels"),d,g;for(h=S;h<=A;h++){d=a?a[h]:0;g=V[h];P=U[h]*R+c+X*(N+b);f=l.roundPixel(P-N/2)+I;L=l.roundPixel(g*J+W+k);F=l.roundPixel(P+N/2)-I;e=l.roundPixel(d*J+W+k);C.drawBar(G,l,K,f,L-I,F,e-I,h);if(D&&B[h]){C.drawLabel(B[h],P,e,L,h)}C.putMarker("markers",{translationX:Y.x(P,L),translationY:Y.y(P,L)},h,true)}},getIndexNearPoint:function(J,K){var A=this,D=A.attr,B=D.dataX,E=A.getSurface(),M=E.getRect()||[0,0,0,0],H=M[3],F,I,G,L,C=-1;if(D.flipXY){F=H-K;if(E.getInherited().rtl){I=M[2]-J}else{I=J}}else{F=J;I=H-K}for(G=0;G<B.length;G++){L=A.getMarkerBBox("items",G);if(L&&F>=L.x&&F<=(L.x+L.width)&&I>=L.y&&I<=(L.y+L.height)){C=G}}return C}});
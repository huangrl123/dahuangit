Ext.define("Ext.data.writer.Writer",{mixins:["Ext.mixin.Factoryable"],alias:"writer.base",factoryConfig:{defaultType:null},alternateClassName:["Ext.data.DataWriter","Ext.data.Writer"],config:{clientIdProperty:null,allDataOptions:{persist:true},partialDataOptions:{changes:true,critical:true},writeAllFields:false,dateFormat:null,nameProperty:"name",writeRecordId:true,transform:null},isWriter:true,constructor:function(A){this.initConfig(A)},applyTransform:function(A){if(A){if(Ext.isFunction(A)){A={fn:A}}return A.fn.bind(A.scope||this)}return A},write:function(C){var E=C.getOperation(),B=E.getRecords()||[],D=B.length,F=[],A;for(A=0;A<D;A++){F.push(this.getRecordData(B[A],E))}return this.writeRecords(C,F)},writeRecords:Ext.emptyFn,getRecordData:function(F,Q){var E=this,J=E.getNameProperty(),C=J!=="name",I=F.self.idField,D=I.name,O=F.id,L=E.getWriteAllFields(),P;if(I.serialize){O=I.serialize(O)}if(!L&&Q&&Q.isDestroyOperation){P={};P[J?I[J]:D]=O}else{var G=E.getDateFormat(),A=F.phantom,M=(A||L)?E.getAllDataOptions():E.getPartialDataOptions(),H=A&&E.getClientIdProperty(),B=F.getFieldsMap(),N,K;M.serialize=false;N=F.getData(M);P=C?{}:N;if(H){P[H]=O;delete N[D]}else{if(!E.getWriteRecordId()){delete N[D]}}for(D in N){O=N[D];if(!(K=B[D])){if(C){P[D]=O}}else{if(K.isDateField&&G&&Ext.isDate(O)){O=Ext.Date.format(O,G)}else{if(K.serialize){O=K.serialize(O,F)}}if(C){D=K[J]||D}P[D]=O}}}return P}});
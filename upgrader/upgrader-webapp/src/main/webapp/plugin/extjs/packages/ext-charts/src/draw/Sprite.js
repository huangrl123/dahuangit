Ext.define("Ext.draw.Sprite",{mixins:{observable:"Ext.util.Observable",animate:"Ext.util.Animate"},requires:["Ext.draw.SpriteDD"],dirty:false,dirtyHidden:false,dirtyTransform:false,dirtyPath:true,dirtyFont:true,zIndexDirty:true,isSprite:true,zIndex:0,fontProperties:["font","font-size","font-weight","font-style","font-family","text-anchor","text"],pathProperties:["x","y","d","path","height","width","radius","r","rx","ry","cx","cy"],constructor:function(A){var B=this;A=Ext.merge({},A||{});B.id=Ext.id(null,"ext-sprite-");B.transformations=[];Ext.copyTo(this,A,"surface,group,type,draggable");B.bbox={};B.attr={zIndex:0,translation:{x:null,y:null},rotation:{degrees:null,x:null,y:null},scaling:{x:null,y:null,cx:null,cy:null}};delete A.surface;delete A.group;delete A.type;delete A.draggable;B.setAttributes(A);B.mixins.observable.constructor.apply(this,arguments)},initDraggable:function(){var A=this;if(!A.el){A.surface.createSpriteElement(A)}A.dd=new Ext.draw.SpriteDD(A,Ext.isBoolean(A.draggable)?null:A.draggable);A.on("beforedestroy",A.dd.destroy,A.dd)},setAttributes:function(D,M){var I=this,J=I.fontProperties,R=J.length,B=I.pathProperties,N=B.length,O=!!I.surface,F=O&&I.surface.customAttributes||{},S=I.attr,G=false,Q,H,C,A,E,K,L,P;D=Ext.apply({},D);for(Q in F){if(D.hasOwnProperty(Q)&&typeof F[Q]=="function"){Ext.apply(D,F[Q].apply(I,[].concat(D[Q])))}}if(!!D.hidden!==!!S.hidden){I.dirtyHidden=true}for(H=0;H<N;H++){Q=B[H];if(Q in D&&D[Q]!==S[Q]){I.dirtyPath=true;G=true;break}}if("zIndex" in D){I.zIndexDirty=true}if("text" in D){I.dirtyFont=true;G=true;D.text=I.transformText(D.text)}for(H=0;H<R;H++){Q=J[H];if(Q in D&&D[Q]!==S[Q]){I.dirtyFont=true;G=true;break}}C=D.translation||D.translate;delete D.translate;delete D.translation;A=S.translation;if(C){if(("x" in C&&C.x!==A.x)||("y" in C&&C.y!==A.y)){I.dirtyTransform=true;A.x=C.x;A.y=C.y}}E=D.rotation||D.rotate;K=S.rotation;delete D.rotate;delete D.rotation;if(E){if(("x" in E&&E.x!==K.x)||("y" in E&&E.y!==K.y)||("degrees" in E&&E.degrees!==K.degrees)){I.dirtyTransform=true;K.x=E.x;K.y=E.y;K.degrees=E.degrees}}L=D.scaling||D.scale;P=S.scaling;delete D.scale;delete D.scaling;if(L){if(("x" in L&&L.x!==P.x)||("y" in L&&L.y!==P.y)||("cx" in L&&L.cx!==P.cx)||("cy" in L&&L.cy!==P.cy)){I.dirtyTransform=true;P.x=L.x;P.y=L.y;P.cx=L.cx;P.cy=L.cy}}if(!I.dirtyTransform&&G){if(S.scaling.x===null||S.scaling.y===null||S.rotation.y===null||S.rotation.y===null){I.dirtyTransform=true}}Ext.apply(S,D);I.dirty=true;if(M===true&&O){I.redraw()}return this},transformText:Ext.identityFn,getBBox:function(){return this.surface.getBBox(this)},setText:function(A){this.attr.text=A;this.surface.applyAttrs(this);return this},hide:function(A){this.setAttributes({hidden:true},A);return this},show:function(A){this.setAttributes({hidden:false},A);return this},remove:function(){if(this.surface){this.surface.remove(this);return true}return false},onRemove:function(){this.surface.onRemove(this)},destroy:function(){var A=this;if(A.fireEvent("beforedestroy",A)!==false){A.remove();A.surface.onDestroy(A);A.clearListeners();A.fireEvent("destroy")}},redraw:function(){var A=this,D=!A.el||A.dirty,B=A.surface,C;B.renderItem(A);if(D){C=B.owner;if(!A.isBackground&&C&&(C.viewBox||C.autoSize)){C.configureSurfaceSize()}}return this},setStyle:function(){this.el.setStyle.apply(this.el,arguments);return this},addCls:function(A){this.surface.addCls(this,A);return this},removeCls:function(A){this.surface.removeCls(this,A);return this}});
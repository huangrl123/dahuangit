Ext.define("Ext.chart.LegendItem",{extend:"Ext.draw.CompositeSprite",requires:["Ext.chart.Shape"],hiddenSeries:false,label:undefined,x:0,y:0,zIndex:500,boldRe:/bold\s\d{1,}.*/i,constructor:function(A){this.callParent(arguments);this.createLegend(A)},createLegend:function(B){var C=this,D=C.series,A=B.yFieldIndex;C.label=C.createLabel(B);C.createSeriesMarkers(B);C.setAttributes({hidden:false},true);C.yFieldIndex=A;C.on("mouseover",C.onMouseOver,C);C.on("mouseout",C.onMouseOut,C);C.on("mousedown",C.onMouseDown,C);if(!D.visibleInLegend(A)){C.hiddenSeries=true;C.label.setAttributes({opacity:0.5},true)}C.updatePosition({x:0,y:0})},getLabelText:function(){var C=this,D=C.series,B=C.yFieldIndex;function A(E){var F=D[E];return(Ext.isArray(F)?F[B]:F)}return A("title")||A("yField")},createLabel:function(B){var C=this,A=C.legend;return C.add("label",C.surface.add({type:"text",x:20,y:0,zIndex:(C.zIndex||0)+2,fill:A.labelColor,font:A.labelFont,text:C.getLabelText(),style:{cursor:"pointer"}}))},createSeriesMarkers:function(B){var A=this,C=B.yFieldIndex,I=A.series,H=I.type,F=A.surface,G=A.zIndex;if(H==="line"||H==="scatter"){if(H==="line"){var E=Ext.apply(I.seriesStyle,I.style);A.drawLine(0.5,0.5,16.5,0.5,G,E,C)}if(I.showMarkers||H==="scatter"){var D=Ext.apply(I.markerStyle,I.markerConfig||{},{fill:I.getLegendColor(C)});A.drawMarker(8.5,0.5,G,D)}}else{A.drawFilledBox(12,12,G,C)}},drawLine:function(I,H,G,E,J,A,B){var C=this,D=C.surface,F=C.series;return C.add("line",D.add({type:"path",path:"M"+I+","+H+"L"+G+","+E,zIndex:(J||0)+2,"stroke-width":F.lineWidth,"stroke-linejoin":"round","stroke-dasharray":F.dash,stroke:A.stroke||F.getLegendColor(B)||"#000",style:{cursor:"pointer"}}))},drawMarker:function(E,F,C,A){var D=this,G=D.surface,B=D.series;return D.add("marker",Ext.chart.Shape[A.type](G,{fill:A.fill,x:E,y:F,zIndex:(C||0)+2,radius:A.radius||A.size,style:{cursor:"pointer"}}))},drawFilledBox:function(E,A,B,D){var C=this,G=C.surface,F=C.series;return C.add("box",G.add({type:"rect",zIndex:(B||0)+2,x:0,y:0,width:E,height:A,fill:F.getLegendColor(D),style:{cursor:"pointer"}}))},onMouseOver:function(){var A=this;A.label.setStyle({"font-weight":"bold"});A.series._index=A.yFieldIndex;A.series.highlightItem()},onMouseOut:function(){var B=this,A=B.legend,C=B.boldRe;B.label.setStyle({"font-weight":A.labelFont&&C.test(A.labelFont)?"bold":"normal"});B.series._index=B.yFieldIndex;B.series.unHighlightItem()},onMouseDown:function(){var A=this,B=A.yFieldIndex;if(!A.hiddenSeries){A.series.hideAll(B);A.label.setAttributes({opacity:0.5},true)}else{A.series.showAll(B);A.label.setAttributes({opacity:1},true)}A.hiddenSeries=!A.hiddenSeries;A.legend.chart.redraw()},updatePosition:function(H){var I=this,L=I.items,D=L.length,F=I.x,B=I.y,N,E,J,K,A,G,M,C;if(!H){H=I.legend}M=H.x;C=H.y;for(E=0;E<D;E++){A=true;N=L[E];switch(N.type){case"text":J=20+M+F;K=C+B;A=false;break;case"rect":J=M+F;K=C+B-6;break;default:J=M+F;K=C+B}G={x:J,y:K};N.setAttributes(A?{translate:G}:G,true)}}});
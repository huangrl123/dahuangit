Ext.define("Ext.draw.engine.SvgExporter",function(){var B=/,/g,M=/(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)\s('*.*'*)/,D=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,K=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,([\d\.]+)\)/g,F,L,J,C,E=function(N){F=N;L=F.length;J=F.width;C=F.height},A={path:function(S){var T=S.attr,O=T.path,Q="",R,P,N;if(Ext.isArray(O[0])){N=O.length;for(P=0;P<N;P++){Q+=O[P].join(" ")}}else{if(Ext.isArray(O)){Q=O.join(" ")}else{Q=O.replace(B," ")}}R=H({d:Q,fill:T.fill||"none",stroke:T.stroke,"fill-opacity":T.opacity,"stroke-width":T["stroke-width"],"stroke-opacity":T["stroke-opacity"],"z-index":T.zIndex,transform:S.matrix.toSvg()});return"<path "+R+"/>"},text:function(N){var P=N.attr,O=M.exec(P.font),R=(O&&O[1])||"12",U=(O&&O[3])||"Arial",T=P.text,S=(Ext.isFF3_0||Ext.isFF3_5)?2:4,V="",Q;N.getBBox();V+='<tspan x="'+(P.x||"")+'" dy="';V+=(R/S)+'">';V+=Ext.htmlEncode(T)+"</tspan>";Q=H({x:P.x,y:P.y,"font-size":R,"font-family":U,"font-weight":P["font-weight"],"text-anchor":P["text-anchor"],fill:P.fill||"#000","fill-opacity":P.opacity,transform:N.matrix.toSvg()});return"<text "+Q+">"+V+"</text>"},rect:function(O){var P=O.attr,N=H({x:P.x,y:P.y,rx:P.rx,ry:P.ry,width:P.width,height:P.height,fill:P.fill||"none","fill-opacity":P.opacity,stroke:P.stroke,"stroke-opacity":P["stroke-opacity"],"stroke-width":P["stroke-width"],transform:O.matrix&&O.matrix.toSvg()});return"<rect "+N+"/>"},circle:function(O){var P=O.attr,N=H({cx:P.x,cy:P.y,r:P.radius,fill:P.translation.fill||P.fill||"none","fill-opacity":P.opacity,stroke:P.stroke,"stroke-opacity":P["stroke-opacity"],"stroke-width":P["stroke-width"],transform:O.matrix.toSvg()});return"<circle "+N+" />"},image:function(O){var P=O.attr,N=H({x:P.x-(P.width/2>>0),y:P.y-(P.height/2>>0),width:P.width,height:P.height,"xlink:href":P.src,transform:O.matrix.toSvg()});return"<image "+N+" />"}},I=function(){var N='<?xml version="1.0" standalone="yes"?>';N+='<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">';return N},G=function(){var e='<svg width="'+J+'px" height="'+C+'px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',h="",Q,a,d,P,Z,l,N,W,b,c,S,m,T,V,g,R,Y,f,X,O;d=F.items.items;a=d.length;Z=function(q){var u=q.childNodes,t=u.length,p=0,k,n,w="",s,o,v,r;for(;p<t;p++){s=u[p];o=s.attributes;v=s.tagName;w+="<"+v;for(n=0,k=o.length;n<k;n++){r=o.item(n);w+=" "+r.name+'="'+r.value+'"'}w+=">";if(s.childNodes.length>0){w+=Z(s)}w+="</"+v+">"}return w};if(F.getDefs){h=Z(F.getDefs())}else{W=F.gradientsColl;if(W){b=W.keys;c=W.items;S=0;m=b.length}for(;S<m;S++){T=b[S];V=c[S];P=F.gradientsColl.getByKey(T);h+='<linearGradient id="'+T+'" x1="0" y1="0" x2="1" y2="1">';var U=P.colors.replace(D,"rgb($1|$2|$3)");U=U.replace(K,"rgba($1|$2|$3|$4)");l=U.split(",");for(g=0,Y=l.length;g<Y;g++){N=l[g].split(" ");U=Ext.draw.Color.fromString(N[1].replace(/\|/g,","));h+='<stop offset="'+N[0]+'" stop-color="'+U.toString()+'" stop-opacity="1"></stop>'}h+="</linearGradient>"}}e+="<defs>"+h+"</defs>";e+=A.rect({attr:{width:"100%",height:"100%",fill:"#fff",stroke:"none",opacity:"0"}});f=new Array(a);for(g=0;g<a;g++){f[g]=g}f.sort(function(j,i){X=d[j].attr.zIndex||0;O=d[i].attr.zIndex||0;if(X==O){return j-i}return X-O});for(g=0;g<a;g++){Q=d[f[g]];if(!Q.attr.hidden){e+=A[Q.type](Q)}}e+="</svg>";return e},H=function(O){var P="",N;for(N in O){if(O.hasOwnProperty(N)&&O[N]!=null){P+=N+'="'+O[N]+'" '}}return P};return{singleton:true,generate:function(O,N){N=N||{};E(O);return I()+G()}}});
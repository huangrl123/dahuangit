Ext.define("Ext.app.bind.Stub",{extend:"Ext.app.bind.AbstractStub",requires:["Ext.app.bind.Binding"],isStub:true,dirty:true,formula:null,validationKey:"validation",statics:{populateValues:function(E,F,G,C){var A=C&&C.children,D,B;F.hadValue[G]=true;if(C){C.hadValue=true}if(E&&E.constructor===Object){for(B in E){Ext.app.bind.Stub.populateValues(E[B],F,G+"."+B,A&&A[B])}}}},constructor:function(D,B,C){var A=this,E=B;A.callParent([D,B]);A.boundValue=null;if(C){C.add(A);if(!C.isRootStub){E=C.path+"."+B}}A.hadValue=D.hadValue[E];A.path=B},destroy:function(){var A=this,D=A.formula,C=A.parent,B=A.storeBinding;if(D){D.destroy()}if(B){B.destroy()}A.detachBound();A.parentValue=A.formula=A.storeBinding=null;A.callParent()},collect:function(){var B=this,A=B.callParent(),C=B.storeBinding?1:0;return A+C},bindValidation:function(A,B){var C=this.parent;return C&&C.descend([this.validationKey,this.name]).bind(A,B)},descend:function(G,E){var C=this,A=C.children||(C.children={}),B=E||0,D=G[B++],F;if(!(F=A[D])){F=new Ext.app.bind.Stub(C.owner,D,C)}if(B<G.length){F=F.descend(G,B)}return F},getChildValue:function(A){var B=this,C=B.name,D;if(!A&&!Ext.isString(A)){D=B.hadValue?null:undefined}else{D=B.inspectValue(A);if(!D){if(A.isEntity){D=A.data[C]}else{D=A[C]}}}return D},getDataObject:function(){var B=this,A=B.parent.getDataObject(),C=B.name,D=A?A[C]:null;if(!D||!(D.$className||Ext.isObject(D))){if(D){}A[C]=D={};B.hadValue=B.owner.hadValue[B.path]=true}return D},getRawValue:function(){return this.getChildValue(this.getParentValue())},graft:function(E){var C=this,F=C.parent,A=C.children,D=C.name,B;E.parent=F;E.children=A;if(F){F.children[D]=E}if(A){for(B in A){A[B].parent=E}}C.children=null;return C.callParent([E])},isLoading:function(){var A=this,D=A.parent,B=false,C;if(D&&!(B=D.isLoading())){C=A.inspectValue(A.getParentValue());if(C){B=C.isLoading()}else{B=!A.hadValue&&A.getRawValue()===undefined}}return B},invalidate:function(A){var B=this,D=B.children,C;B.dirty=true;if(!B.isLoading()){if(!B.scheduled){B.schedule()}}if(A&&D){for(C in D){D[C].invalidate(A)}}},set:function(E){var C=this,F=C.parent,D=C.name,A=F.getDataObject(),B;if(A.isEntity){B=A.associations;if(B&&(D in B)){}else{A.set(D,E)}}else{if((E&&E.constructor===Object)||E!==A[D]){if(!C.setByLink(E)){if(E===undefined){delete A[D]}else{A[D]=E;Ext.app.bind.Stub.populateValues(E,C.owner,C.path,C)}C.inspectValue(A);C.invalidate(true)}}}},onStoreLoad:function(){this.invalidate(true)},afterLoad:function(A){this.invalidate(true)},afterEdit:function(I,F){var A=this.children,H=F&&F.length,C=I.associations,E,D,G,B;if(A){if(H){for(D=0;D<H;++D){G=A[F[D]];if(G){G.invalidate()}}}else{for(E in A){if(!(C&&E in C)){A[E].invalidate()}}}}this.invalidate()},afterReject:function(A){this.afterEdit(A,null)},setByLink:function(E){var D=this,B=0,A,C,G,F;for(F=D;F;F=F.parent){if(F.isLinkStub){C=F;if(B){for(G=[],A=0,F=D;F!==C;F=F.parent){++A;G[B-A]=F.name}}break}++B}if(!C||!(F=C.getTargetStub())){return false}if(G){F=F.descend(G)}F.set(E);return true},setFormula:function(C){var A=this,B=A.formula;if(B){B.destroy()}A.formula=new Ext.app.bind.Formula(A,C)},react:function(){var B=this,A=this.boundValue,D=B.children,C;if(A){if(A.isValidation){A.refresh();C=A.generation;if(B.lastValidationGeneration===C){return}B.lastValidationGeneration=C}else{if(A.isModel){if(D&&D[B.validationKey]){A.isValid()}}else{if(A.isStore){if(A.isLoading()&&!A.loadCount){return}}}}}this.callParent()},privates:{getParentValue:function(){var A=this;if(A.dirty){A.parentValue=A.parent.getValue();A.dirty=false}return A.parentValue},setStore:function(A){this.storeBinding=A},inspectValue:function(B){var I=this,A=I.name,C=I.boundValue,F=null,E,H,D,G;if(B&&B.isEntity){E=B.associations;if(E&&(A in E)){H=E[A];F=B[H.getterName]();if(F&&F.isStore){F.$associatedStore=true}}else{if(A===I.validationKey){F=B.getValidation(true);I.lastValidationGeneration=null}}}else{if(B){D=B[A];if(D&&(D.isModel||D.isStore)){F=D}}}G=C!==F;if(G){if(C){I.detachBound()}if(F){if(F.isModel){F.join(I)}else{if(F.$associatedStore&&!F.getCount()&&!F.loadCount&&!F.hasPendingLoad()){F.load()}F.on("load",I.onStoreLoad,I,{single:true})}}I.boundValue=F}return F},detachBound:function(){var A=this,B=A.boundValue;if(B){if(B.isModel){B.unjoin(A)}else{B.un("load",A.onStoreLoad,A)}}},sort:function(){var B=this,D=B.formula,A=B.scheduler,C=B.storeBinding;B.callParent();if(C){A.sortItem(C)}if(D){A.sortItem(D)}}}});
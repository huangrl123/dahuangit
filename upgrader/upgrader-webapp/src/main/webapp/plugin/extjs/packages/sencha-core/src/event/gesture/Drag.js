Ext.define("Ext.event.gesture.Drag",{extend:"Ext.event.gesture.SingleTouch",isStarted:false,startPoint:null,previousPoint:null,lastPoint:null,handledEvents:["dragstart","drag","dragend","dragcancel"],config:{minDistance:8},constructor:function(){this.callSuper(arguments);this.info={touch:null,previous:{x:0,y:0},x:0,y:0,delta:{x:0,y:0},absDelta:{x:0,y:0},flick:{velocity:{x:0,y:0}},direction:{x:0,y:0},time:0,previousTime:{x:0,y:0}}},onTouchStart:function(A){if(this.callSuper(arguments)===false){if(this.isStarted&&this.lastMoveEvent!==null){this.lastMoveEvent.isStopped=false;this.onTouchEnd(this.lastMoveEvent)}return false}this.startTime=A.time;this.startPoint=A.changedTouches[0].point},tryDragStart:function(A){var F=this.startPoint,C=A.changedTouches[0],B=C.point,E=this.getMinDistance(),D=this.info;if(Math.abs(B.getDistanceTo(F))>=E){this.isStarted=true;this.previousPoint=this.lastPoint=B;this.resetInfo("x",A,C);this.resetInfo("y",A,C);D.time=A.time;this.fire("dragstart",A,D)}},onTouchMove:function(A){if(!this.isStarted){this.tryDragStart(A)}if(!this.isStarted){return}var C=A.changedTouches[0],B=C.point;if(this.lastPoint){this.previousPoint=this.lastPoint}this.lastPoint=B;this.lastMoveEvent=A;this.updateInfo("x",A,C);this.updateInfo("y",A,C);this.info.time=A.time;this.fire("drag",A,this.info)},onAxisDragEnd:function(C,B){var A=B.time-B.previousTime[C];if(A>0){B.flick.velocity[C]=(B[C]-B.previous[C])/A}},resetInfo:function(B,C,A){var D=this.lastPoint[B],F=this.startPoint[B],H=D-F,E=B.toUpperCase(),G=this.info;G.touch=A;G.delta[B]=H;G.absDelta[B]=Math.abs(H);G.previousTime[B]=this.startTime;G.previous[B]=F;G[B]=D;G.direction[B]=0;G["start"+E]=this.startPoint[B];G["previous"+E]=G.previous[B];G["page"+E]=G[B];G["delta"+E]=G.delta[B];G["absDelta"+E]=G.absDelta[B];G["previousDelta"+E]=0;G.startTime=this.startTime},updateInfo:function(C,D,A){var I=this,F=I.lastPoint[C],E=I.previousPoint[C],G=I.startPoint[C],J=F-G,L=I.info,B=L.direction,H=C.toUpperCase(),K=L.previous[C];L.touch=A;L.delta[C]=J;L.absDelta[C]=Math.abs(J);if(F!==K&&F!==L[C]){L.previous[C]=L[C];L.previousTime[C]=L.time}L[C]=F;if(F>E){B[C]=1}else{if(F<E){B[C]=-1}}L["start"+H]=G;L["previous"+H]=L.previous[C];L["page"+H]=L[C];L["delta"+H]=L.delta[C];L["absDelta"+H]=L.absDelta[C];L["previousDelta"+H]=L.previous[C]-G;L.startTime=I.startTime},onTouchEnd:function(A){this.doEnd(A)},onTouchCancel:function(A){this.doEnd(A,true);return false},doEnd:function(A,C){if(!this.isStarted){this.tryDragStart(A)}if(this.isStarted){var D=A.changedTouches[0],B=D.point,E=this.info;this.isStarted=false;this.lastPoint=B;this.updateInfo("x",A,D);this.updateInfo("y",A,D);E.time=A.time;this.onAxisDragEnd("x",E);this.onAxisDragEnd("y",E);this.fire(C?"dragcancel":"dragend",A,E);this.startPoint=null;this.previousPoint=null;this.lastPoint=null;this.lastMoveEvent=null}}});
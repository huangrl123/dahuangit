Ext.define("Ext.data.PageMap",{extend:"Ext.util.LruCache",config:{pageSize:0,rootProperty:""},clear:function(A){var B=this;B.pageMapGeneration=(B.pageMapGeneration||0)+1;B.callParent(arguments)},forEach:function(G,B){var I=this,J=Ext.Object.getKeys(I.map),F=J.length,H=I.getPageSize(),E,D,K,C,A;for(E=0;E<F;E++){J[E]=Number(J[E])}Ext.Array.sort(J);B=B||I;for(E=0;E<F;E++){K=J[E];C=I.getPage(K);A=C.length;for(D=0;D<A;D++){if(G.call(B,C[D],(K-1)*H+D)===false){return}}}},findBy:function(B,D){var C=this,A=null;D=D||C;C.forEach(function(E,F){if(B.call(D,E,F)){A=E;return false}});return A},findIndexBy:function(B,D){var C=this,A=-1;D=D||C;C.forEach(function(E,F){if(B.call(D,E)){A=F;return false}});return A},find:function(E,D,B,H,F,A){if(Ext.isEmpty(D,false)){return null}var G=Ext.String.createRegex(D,H,F,A),C=this.getRootProperty();return this.findBy(function(I){return I&&G.test((C?I[C]:I)[E])},null,B)},findIndex:function(E,D,B,H,F,A){if(Ext.isEmpty(D,false)){return null}var G=Ext.String.createRegex(D,H,F,A),C=this.getRootProperty();return this.findIndexBy(function(I){return I&&G.test((C?I[C]:I)[E])},null,B)},getPageFromRecordIndex:function(A){return Math.floor(A/this.getPageSize())+1},addAll:function(A){if(this.getCount()){Ext.Error.raise("Cannot addAll to a non-empty PageMap")}this.addPage(1,A)},addPage:function(B,A){var C=this,D=C.getPageSize(),G=B+Math.floor((A.length-1)/D),E,F;for(E=0;B<=G;B++,E+=D){F=Ext.Array.slice(A,E,E+D);C.add(B,F);C.fireEvent("pageadded",B,F)}},getCount:function(){var A=this.callParent();if(A){A=(A-1)*this.getPageSize()+this.last.value.length}return A},indexOf:function(A){return A?A.index:-1},insert:function(){Ext.Error.raise("insert operation not suppported into buffered Store")},remove:function(){Ext.Error.raise("remove operation not suppported from buffered Store")},removeAt:function(){Ext.Error.raise("removeAt operation not suppported from buffered Store")},removeAtKey:function(B){var A=this.getPage(B);if(A&&A.value){A.value.length=0}return this.callParent(arguments)},getPage:function(A){return this.get(A)},hasRange:function(D,C){var A=this.getPageFromRecordIndex(D),B=this.getPageFromRecordIndex(C);for(;A<=B;A++){if(!this.hasPage(A)){return false}}return true},hasPage:function(A){return !!this.get(A)},getAt:function(A){return this.getRange(A,A+1)[0]},getRange:function(C,D){D--;if(!this.hasRange(C,D)){Ext.Error.raise("PageMap asked for range which it does not have")}var J=this,I=J.getPageSize(),K=J.getPageFromRecordIndex(C),G=J.getPageFromRecordIndex(D),O=(K-1)*I,N=(G*I)-1,L=K,B=[],M,H,E,F=0,A;for(;L<=G;L++){if(L===K){M=C-O;E=true}else{M=0;E=false}if(L===G){H=I-(N-D);E=true}if(E){Ext.Array.push(B,Ext.Array.slice(J.getPage(L),M,H))}else{Ext.Array.push(B,J.getPage(L))}}for(A=B.length;F<A;F++){B[F].index=C++}return B}});
Ext.define("Ext.util.Positionable",{mixinId:"positionable",_positionTopLeft:["position","top","left"],_alignRe:/^([a-z]+)-([a-z]+)(\?)?$/,afterSetPosition:Ext.emptyFn,getAnchorToXY:function(){Ext.Error.raise("getAnchorToXY is not implemented in "+this.$className)},getBorderPadding:function(){Ext.Error.raise("getBorderPadding is not implemented in "+this.$className)},getLocalX:function(){Ext.Error.raise("getLocalX is not implemented in "+this.$className)},getLocalXY:function(){Ext.Error.raise("getLocalXY is not implemented in "+this.$className)},getLocalY:function(){Ext.Error.raise("getLocalY is not implemented in "+this.$className)},getX:function(){Ext.Error.raise("getX is not implemented in "+this.$className)},getXY:function(){Ext.Error.raise("getXY is not implemented in "+this.$className)},getY:function(){Ext.Error.raise("getY is not implemented in "+this.$className)},setLocalX:function(){Ext.Error.raise("setLocalX is not implemented in "+this.$className)},setLocalXY:function(){Ext.Error.raise("setLocalXY is not implemented in "+this.$className)},setLocalY:function(){Ext.Error.raise("setLocalY is not implemented in "+this.$className)},setX:function(){Ext.Error.raise("setX is not implemented in "+this.$className)},setXY:function(){Ext.Error.raise("setXY is not implemented in "+this.$className)},setY:function(){Ext.Error.raise("setY is not implemented in "+this.$className)},adjustForConstraints:function(A,C){var B=this.getConstrainVector(C,A);if(B){A[0]+=B[0];A[1]+=B[1]}return A},alignTo:function(F,E,C,D){var B=this,A=B.el;return B.setXY(B.getAlignToXY(F,E,C),A.anim&&!!D?A.anim(D):false)},calculateAnchorXY:function(A,I,G,L){var J=this,F=J.el,H=document,E=(F.dom===H.body||F.dom===H),C=Math.round,D,K,B;A=(A||"tl").toLowerCase();L=L||{};K=L.width||(E?Ext.Element.getViewportWidth():J.getWidth());B=L.height||(E?Ext.Element.getViewportHeight():J.getHeight());switch(A){case"tl":D=[0,0];break;case"bl":D=[0,B];break;case"tr":D=[K,0];break;case"c":D=[C(K*0.5),C(B*0.5)];break;case"t":D=[C(K*0.5),0];break;case"l":D=[0,C(B*0.5)];break;case"r":D=[K,C(B*0.5)];break;case"b":D=[C(K*0.5),B];break;case"tc":D=[C(K*0.5),0];break;case"bc":D=[C(K*0.5),B];break;case"br":D=[K,B]}return[D[0]+I,D[1]+G]},convertPositionSpec:Ext.identityFn,getAlignToXY:function(L,A,H){var E=this,G,J,N,T,S,D,O,M,R,Q,K,F,C,U,P,W,V,B,I;L=Ext.get(L.el||L);if(!L||!L.dom){Ext.Error.raise({sourceClass:"Ext.util.Positionable",sourceMethod:"getAlignToXY",msg:"Attempted to align an element that doesn't exist"})}H=H||[0,0];A=(!A||A=="?"?"tl-bl?":(!(/-/).test(A)&&A!==""?"tl-"+A:A||"tl-bl")).toLowerCase();A=E.convertPositionSpec(A);N=A.match(E._alignRe);if(!N){Ext.Error.raise({sourceClass:"Ext.util.Positionable",sourceMethod:"getAlignToXY",el:L,position:A,offset:H,msg:'Attemmpted to align an element with an invalid position: "'+A+'"'})}F=N[1];C=N[2];K=!!N[3];T=E.getAnchorXY(F,true);S=E.getAnchorToXY(L,C,false);B=S[0]-T[0]+H[0];I=S[1]-T[1]+H[1];if(K){G=E.constrainTo||E.container||E.el.parent();G=Ext.get(G.el||G);J=G.getViewRegion();J.right=J.left+G.el.dom.clientWidth;D=E.getWidth();O=E.getHeight();M=L.getRegion();U=F.charAt(0);P=F.charAt(F.length-1);W=C.charAt(0);V=C.charAt(C.length-1);R=(B<M.right&&B+D>=M.left)&&((U=="t"&&W=="b")||(U=="b"&&W=="t"));Q=(I<M.bottom&&I+O>=M.top)&&((P=="r"&&V=="l")||(P=="l"&&V=="r"));if(B+D>J.right){if(Q){B=M.left-D;Q=false}else{B=J.right-D}}if(B<J.left){B=Q?M.right:J.left}if(I+O>J.bottom){if(R){I=M.top-O;R=false}else{I=J.bottom-O}}if(I<J.top){I=R?M.bottom:J.top}}return[B,I]},getAnchorXY:function(A,J,K){var H=this,E=H.getXY(),C=H.el,F=document,B=C.dom==F.body||C.dom==F,G=C.getScroll(),I=B?G.left:J?0:E[0],D=B?G.top:J?0:E[1];return H.calculateAnchorXY(A,I,D,K)},getBox:function(A,K){var H=this,D=K?H.getLocalXY():H.getXY(),I=D[0],J=D[1],B=H.getWidth(),E=H.getHeight(),F,C,G;if(A){F=H.getBorderPadding();C=F.beforeX;G=F.beforeY;I+=C;J+=G;B-=(C+F.afterX);E-=(G+F.afterY)}return{x:I,left:I,0:I,y:J,top:J,1:J,width:B,height:E,right:I+B,bottom:J+E}},calculateConstrainedPosition:function(G,K,L,C){var J=this,E,B=J.floatParent,H=B?B.getTargetEl():null,I,A,D,F=false;if(L&&B){I=H.getXY();A=H.getBorderPadding();I[0]+=A.beforeX;I[1]+=A.beforeY;if(K){D=[K[0]+I[0],K[1]+I[1]]}}else{D=K}G=G||J.constrainTo||H||J.container||J.el.parent();E=J.getConstrainVector(G,D,C);F=K||J.getPosition(L);if(E){F[0]+=E[0];F[1]+=E[1]}return F},getConstrainVector:function(D,H,A){var E=this.getRegion(),B=[0,0],F=(this.shadow&&this.constrainShadow&&!this.shadowDisabled)?this.shadow.getShadowSize():undefined,C=false,I,G=this.constraintInsets;if(!(D instanceof Ext.util.Region)){D=Ext.get(D.el||D);I=D.getViewSize();D=D.getViewRegion();D.right=D.left+I.width;D.bottom=D.top+I.height}if(G){G=Ext.isObject(G)?G:Ext.Element.parseBox(G);D.adjust(G.top,G.right,G.bottom,G.length)}if(H){E.translateBy(H[0]-E.x,H[1]-E.y)}if(A){E.right=E.left+A[0];E.bottom=E.top+A[1]}if(F){D.adjust(F[0],-F[1],-F[2],F[3])}if(E.right>D.right){C=true;B[0]=(D.right-E.right)}if(E.left+B[0]<D.left){C=true;B[0]=(D.left-E.left)}if(E.bottom>D.bottom){C=true;B[1]=(D.bottom-E.bottom)}if(E.top+B[1]<D.top){C=true;B[1]=(D.top-E.top)}return C?B:false},getOffsetsTo:function(A){var C=this.getXY(),B=Ext.fly(A.el||A).getXY();return[C[0]-B[0],C[1]-B[1]]},getRegion:function(){var A=this.getBox();return new Ext.util.Region(A.top,A.right,A.bottom,A.left)},getViewRegion:function(){var J=this,F=J.el,C=F.dom.nodeName==="BODY",G,I,H,E,D,B,A;if(C){I=F.getScroll();D=I.left;E=I.top;B=Ext.Element.getViewportWidth();A=Ext.Element.getViewportHeight()}else{G=J.getBorderPadding();H=J.getXY();D=H[0]+G.beforeX;E=H[1]+G.beforeY;B=J.getWidth(true);A=J.getHeight(true)}return new Ext.util.Region(E,D+B,E+A,D)},move:function(A,G,C){var H=this,D=H.getXY(),I=D[0],J=D[1],F=[I-G,J],B=[I+G,J],E=[I,J-G],K=[I,J+G],L={l:F,left:F,r:B,right:B,t:E,top:E,up:E,b:K,bottom:K,down:K};A=A.toLowerCase();H.setXY([L[A][0],L[A][1]],C)},setBox:function(A){var B=this,C,D;if(A.isRegion){A={x:A.left,y:A.top,width:A.right-A.left,height:A.bottom-A.top}}B.constrainBox(A);C=A.x;D=A.y;B.setSize(A.width,A.height);B.setXY([C,D]);B.afterSetPosition(C,D);return B},constrainBox:function(A){var B=this,C;if(B.constrain||B.constrainHeader){C=B.calculateConstrainedPosition(null,[(A.x||A.left),(A.y||A.top)],false,[A.width,A.height]);if(C){A.x=C[0];A.y=C[1]}}},translatePoints:function(B,C){var A=this.translateXY(B,C);return{left:A.x,top:A.y}},translateXY:function(G,H){var F=this,A=F.el,B=A.getStyle(F._positionTopLeft),I=B.position==="relative",E=parseFloat(B.left),D=parseFloat(B.top),C=F.getXY();if(Ext.isArray(G)){H=G[1];G=G[0]}if(isNaN(E)){E=I?0:A.dom.offsetLeft}if(isNaN(D)){D=I?0:A.dom.offsetTop}E=(typeof G==="number")?G-C[0]+E:undefined;D=(typeof H==="number")?H-C[1]+D:undefined;return{x:E,y:D}}});
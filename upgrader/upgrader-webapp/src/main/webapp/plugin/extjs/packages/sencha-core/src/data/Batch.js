Ext.define("Ext.data.Batch",{mixins:{observable:"Ext.mixin.Observable"},config:{pauseOnException:false},current:-1,total:0,running:false,complete:false,exception:false,constructor:function(A){var B=this;B.mixins.observable.constructor.call(B,A);B.operations=[];B.exceptions=[]},add:function(D){var B=this,A,C;if(Ext.isArray(D)){for(A=0,C=D.length;A<C;++A){B.add(D[A])}}else{B.total++;D.setBatch(B);B.operations.push(D)}return B},sort:function(){this.operations.sort(this.sortFn)},sortFn:function(F,E){var D=F.order-E.order;if(D){return D}var A=F.entityType,C=E.entityType,B;if(!A||!C){return 0}if(!(B=A.rank)){A.schema.rankEntities();B=A.rank}return(B-C.rank)*F.foreignKeyDirection},start:function(B){var A=this;if(!A.operations.length||A.running){return A}A.exceptions.length=0;A.exception=false;A.running=true;return A.runOperation(Ext.isDefined(B)?B:A.current+1)},retry:function(){return this.start(this.current)},runNextOperation:function(){var A=this;if(A.running){A.runOperation(A.current+1)}return A},pause:function(){this.running=false;return this},getOperations:function(){return this.operations},getExceptions:function(){return this.exceptions},getCurrent:function(){var A=null,B=this.current;if(!(B===-1||this.complete)){A=this.operations[B]}return A},getTotal:function(){return this.total},isRunning:function(){return this.running},isComplete:function(){return this.complete},hasException:function(){return this.exception},runOperation:function(C){var B=this,D=B.operations,A=D[C];if(A===undefined){B.running=false;B.complete=true;B.fireEvent("complete",B,D[D.length-1])}else{B.current=C;A.setInternalCallback(B.onOperationComplete);A.setInternalScope(B);A.execute()}return B},onOperationComplete:function(C){var B=this,A=C.hasException();if(A){B.exception=true;B.exceptions.push(C);B.fireEvent("exception",B,C)}if(A&&B.getPauseOnException()){B.pause()}else{B.fireEvent("operationcomplete",B,C);B.runNextOperation()}}});
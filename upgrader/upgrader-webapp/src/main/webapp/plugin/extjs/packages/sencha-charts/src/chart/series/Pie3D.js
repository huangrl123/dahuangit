Ext.define("Ext.chart.series.Pie3D",{requires:["Ext.chart.series.sprite.Pie3DPart"],extend:"Ext.chart.series.Polar",type:"pie3d",seriesType:"pie3d",alias:"series.pie3d",config:{rect:[0,0,0,0],thickness:35,distortion:0.5,field:null,lengthField:false,donut:false,rotation:0},setField:function(A){return this.setXField(A)},getField:function(){return this.getXField()},applyRotation:function(A){var B=Math.PI*2;return(A%B+B)%B},updateRotation:function(B){var C=this.getSprites(),A,D;for(A=0,D=C.length;A<D;A++){C[A].setAttributes({baseRotation:B})}},updateColors:function(A){this.setSubStyle({baseColor:A})},doUpdateStyles:function(){var B=this.getSprites(),A=0,D=0,C=B&&B.length;for(;A<C;A+=5,D++){B[A].setAttributes(this.getStyleByIndex(D));B[A+1].setAttributes(this.getStyleByIndex(D));B[A+2].setAttributes(this.getStyleByIndex(D));B[A+3].setAttributes(this.getStyleByIndex(D));B[A+4].setAttributes(this.getStyleByIndex(D))}},processData:function(){var A=this,F=A.getChart(),O=F&&F.getAnimation(),L=A.getStore(),N=L.getData().items,G=N.length,J=A.getField(),H,I=0,C,D=[],K,M=this.getSprites(),B;for(K=0;K<G;K++){H=N[K].get(J);I+=H;D[K]=I}if(I===0){return}C=2*Math.PI/I;for(K=0;K<G;K++){D[K]*=C}for(K=0;K<M.length;K++){M[K].fx.setConfig(O)}for(K=0,B=0;K<G;K++){var E={opacity:1,startAngle:B,endAngle:D[K]};M[K*5].setAttributes(E);M[K*5+1].setAttributes(E);M[K*5+2].setAttributes(E);M[K*5+3].setAttributes(E);M[K*5+4].setAttributes(E);B=D[K]}},getSprites:function(){var F=this,T=this.getChart(),M=F.getSurface(),H=F.getStore();if(!H){return[]}var R=H.getData().items,A=R.length,Q=T&&T.getAnimation(),K=T.getMainRect()||[0,0,1,1],I=F.getRotation(),V=F.getCenter(),B=F.getOffsetX(),C=F.getOffsetY(),E=Math.min((K[3]-F.getThickness()*2)/F.getDistortion(),K[2])/2,P={centerX:V[0]+B,centerY:V[1]+C-F.getThickness()/2,endRho:E,startRho:E*F.getDonut()/100,thickness:F.getThickness(),distortion:F.getDistortion()},O,L=Math.PI*2,U,S,N,G,J,D;for(D=0;D<A;D++){O=Ext.apply({},this.getStyleByIndex(D),P);U=F.sprites[D*5];if(!U){U=M.add({type:"pie3dPart",part:"top",startAngle:L,endAngle:L});S=M.add({type:"pie3dPart",part:"start",startAngle:L,endAngle:L});N=M.add({type:"pie3dPart",part:"end",startAngle:L,endAngle:L});G=M.add({type:"pie3dPart",part:"inner",startAngle:L,endAngle:L,thickness:0});J=M.add({type:"pie3dPart",part:"outer",startAngle:L,endAngle:L,thickness:0});U.fx.setDurationOn("baseRotation",0);S.fx.setDurationOn("baseRotation",0);N.fx.setDurationOn("baseRotation",0);G.fx.setDurationOn("baseRotation",0);J.fx.setDurationOn("baseRotation",0);U.setAttributes(O);S.setAttributes(O);N.setAttributes(O);G.setAttributes(O);J.setAttributes(O);F.sprites.push(U,S,N,G,J)}else{S=F.sprites[D*5+1];N=F.sprites[D*5+2];G=F.sprites[D*5+3];J=F.sprites[D*5+4];if(Q){U.fx.setConfig(Q);S.fx.setConfig(Q);N.fx.setConfig(Q);G.fx.setConfig(Q);J.fx.setConfig(Q)}U.setAttributes(O);S.setAttributes(O);N.setAttributes(O);G.setAttributes(O);J.setAttributes(O)}}for(D*=5;D<F.sprites.length;D++){F.sprites[D].fx.setConfig(Q);F.sprites[D].setAttributes({opacity:0,startAngle:L,endAngle:L,baseRotation:I})}return F.sprites}});
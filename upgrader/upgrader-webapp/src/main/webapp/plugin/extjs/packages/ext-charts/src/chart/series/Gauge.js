Ext.define("Ext.chart.series.Gauge",{extend:"Ext.chart.series.Series",type:"gauge",alias:"series.gauge",rad:Math.PI/180,highlightDuration:150,angleField:false,needle:false,donut:false,showInLegend:false,style:{},constructor:function(A){this.callParent(arguments);var G=this,C=G.chart,D=C.surface,H=C.store,B=C.shadow,E,F,I;Ext.apply(G,A,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":1,stroke:"rgb(200, 200, 200)",translate:{x:1.2,y:2}},{"stroke-width":4,"stroke-opacity":1,stroke:"rgb(150, 150, 150)",translate:{x:0.9,y:1.5}},{"stroke-width":2,"stroke-opacity":1,stroke:"rgb(100, 100, 100)",translate:{x:0.6,y:1}}]});G.group=D.getGroup(G.seriesId);if(B){for(E=0,F=G.shadowAttributes.length;E<F;E++){G.shadowGroups.push(D.getGroup(G.seriesId+"-shadows"+E))}}D.customAttributes.segment=function(J){return G.getSegment(J)}},initialize:function(){var C=this,B=C.chart.getChartStore(),E=B.data.items,A=C.label,D=E.length;C.yField=[];if(A&&A.field&&D>0){C.yField.push(E[0].get(A.field))}},getSegment:function(H){var G=this,F=G.rad,S=Math.cos,U=Math.sin,P=Math.abs,V=G.centerX,W=G.centerY,T=0,X=0,K=0,Q=0,C=0,Y=0,L=0,R=0,Z=0.01,A=H.endRho-H.startRho,J=H.startAngle,N=H.endAngle,E=(J+N)/2*F,O=H.margin||0,B=P(N-J)>180,I=Math.min(J,N)*F,M=Math.max(J,N)*F,D=false;V+=O*S(E);W+=O*U(E);T=V+H.startRho*S(I);C=W+H.startRho*U(I);X=V+H.endRho*S(I);Y=W+H.endRho*U(I);K=V+H.startRho*S(M);L=W+H.startRho*U(M);Q=V+H.endRho*S(M);R=W+H.endRho*U(M);if(P(T-K)<=Z&&P(C-L)<=Z){D=true}if(D){return{path:[["M",T,C],["L",X,Y],["A",H.endRho,H.endRho,0,+B,1,Q,R],["Z"]]}}else{return{path:[["M",T,C],["L",X,Y],["A",H.endRho,H.endRho,0,+B,1,Q,R],["L",K,L],["A",H.startRho,H.startRho,0,+B,0,T,C],["Z"]]}}},calcMiddle:function(O){var J=this,G=J.rad,A=O.slice,K=J.centerX,L=J.centerY,H=A.startAngle,B=A.endAngle,I=Math.max(("rho" in A)?A.rho:J.radius,J.label.minMargin),F=+J.donut,C=Math.min(H,B)*G,M=Math.max(H,B)*G,N=-(C+(M-C)/2),D=K+(O.endRho+O.startRho)/2*Math.cos(N),E=L-(O.endRho+O.startRho)/2*Math.sin(N);O.middle={x:D,y:E}},drawSeries:function(){var O=this,N=O.chart,e=N.getChartStore(),E=O.group,h=O.chart.animate,d=O.chart.axes.get(0),C=d&&d.minimum||O.minimum||0,U=d&&d.maximum||O.maximum||0,u=O.angleField||O.field||O.xField,w=N.surface,Y=N.chartBBox,o=O.rad,D=+O.donut,a={},W=[],L=O.seriesStyle,l=O.seriesLabelStyle,t=O.colorArrayStyle,S=t&&t.length||0,m=Math.cos,J=Math.sin,b=-180,Z=O.reverse,I,Q,R,V,v,B,c,q,g,F,s,r,H,f,n,M,k,T,G,K,X,A,P;Ext.apply(L,O.style||{});O.setBBox();K=O.bbox;if(O.colorSet){t=O.colorSet;S=t.length}if(!e||!e.getCount()||O.seriesIsHidden){O.hide();O.items=[];return}Q=O.centerX=Y.x+(Y.width/2);R=O.centerY=Y.y+Y.height;O.radius=Math.min(Q-Y.x,R-Y.y);O.slices=v=[];O.items=W=[];if(!O.value){F=e.getAt(0);O.value=F.get(u)}c=Z?U-O.value:O.value;if(O.needle){A={series:O,value:c,startAngle:b,endAngle:0,rho:O.radius};X=b*(1-(c-C)/(U-C));v.push(A)}else{X=b*(1-(c-C)/(U-C));A={series:O,value:c,startAngle:b,endAngle:X,rho:O.radius};P={series:O,value:U-c,startAngle:X,endAngle:0,rho:O.radius};if(Z){v.push(P,A)}else{v.push(A,P)}}for(s=0,g=v.length;s<g;s++){V=v[s];B=E.getAt(s);I=Ext.apply({segment:{startAngle:V.startAngle,endAngle:V.endAngle,margin:0,rho:V.rho,startRho:V.rho*+D/100,endRho:V.rho}},Ext.apply(L,t&&{fill:t[s%S]}||{}));q=Ext.apply({},I.segment,{slice:V,series:O,storeItem:F,index:s});W[s]=q;if(!B){G=Ext.apply({type:"path",group:E},Ext.apply(L,t&&{fill:t[s%S]}||{}));B=w.add(Ext.apply(G,I))}V.sprite=V.sprite||[];q.sprite=B;V.sprite.push(B);if(h){I=O.renderer(B,F,I,s,e);B._to=I;O.onAnimate(B,{to:I})}else{I=O.renderer(B,F,Ext.apply(I,{hidden:false}),s,e);B.setAttributes(I,true)}}if(O.needle){X=X*Math.PI/180;if(!O.needleSprite){O.needleSprite=O.chart.surface.add({type:"path",path:["M",Q+(O.radius*+D/100)*m(X),R+-Math.abs((O.radius*+D/100)*J(X)),"L",Q+O.radius*m(X),R+-Math.abs(O.radius*J(X))],"stroke-width":4,"stroke":"#222"})}else{if(h){O.onAnimate(O.needleSprite,{to:{path:["M",Q+(O.radius*+D/100)*m(X),R+-Math.abs((O.radius*+D/100)*J(X)),"L",Q+O.radius*m(X),R+-Math.abs(O.radius*J(X))]}})}else{O.needleSprite.setAttributes({type:"path",path:["M",Q+(O.radius*+D/100)*m(X),R+-Math.abs((O.radius*+D/100)*J(X)),"L",Q+O.radius*m(X),R+-Math.abs(O.radius*J(X))]})}}O.needleSprite.setAttributes({hidden:false},true)}delete O.value},setValue:function(A){this.value=A;this.drawSeries()},onCreateLabel:function(D,C,A,B){},onPlaceLabel:function(A,F,E,B,D,C,G){},onPlaceCallout:function(){},onAnimate:function(A,B){A.show();return this.callParent(arguments)},isItemInPoint:function(L,M,N,I){var K=this,F=K.centerX,E=K.centerY,C=Math.abs,H=C(L-F),J=C(M-E),A=N.startAngle,B=N.endAngle,G=Math.sqrt(H*H+J*J),D=Math.atan2(M-E,L-F)/K.rad;return(I===0)&&(D>=A&&D<B&&G>=N.startRho&&G<=N.endRho)},getLegendColor:function(A){var B=this.colorSet||this.colorArrayStyle;return B[A%B.length]}});
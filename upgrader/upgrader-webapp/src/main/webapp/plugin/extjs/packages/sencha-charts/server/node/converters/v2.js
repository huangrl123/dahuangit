var validator=require("../validator.js");var DEFAULT_FORMAT="png";var FORMATS={gif:"image/gif",jpeg:"image/jpeg",pdf:"application/pdf",png:"image/png"};var VALID_POST_DATA={version:"string",data:"string",format:"string",filename:/^[^ \\/:*?""<>|]+([ ]+[^ \\/:*?""<>|]+)*$/g,width:"string",height:"string",scale:"string",pdf:"string",jpeg:"string"};var VALID_PDF_OPTIONS={width:"string",height:"string",border:"string",format:"string",orientation:"string"};var VALID_JPEG_OPTIONS={quality:"string"};function convert(B){B=validator.verifyConfig(B,VALID_POST_DATA);if(B.format in FORMATS){B.contentType=FORMATS[B.format]}else{B.format=DEFAULT_FORMAT;B.contentType=FORMATS[DEFAULT_FORMAT]}if(B.pdf){try{B.pdf=validator.verifyConfig(JSON.parse(B.pdf),VALID_PDF_OPTIONS)}catch(A){console.error("Parsing 'pdf' config failed.",A)}}if(B.jpeg){try{}catch(A){console.error("Parsing 'jpeg' config failed.",A)}B.jpeg=validator.verifyConfig(JSON.parse(B.jpeg),VALID_JPEG_OPTIONS)}B.width=B.width||0;B.height=B.height||0;B.scale=B.scale||1;return B}module.exports={convert:convert};